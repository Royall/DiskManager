/*! jQuery Validation Plugin - v1.15.0 - 2/24/2016
 * http://jqueryvalidation.org/
 * Copyright (c) 2016 Jörn Zaefferer; Licensed MIT */

/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * myPagination Jquery Pagination Plug-in Library v6.0
 * 
 * http://linapex.blog.163.com/
 *
 * Date: 2013/3/24 21:20
 */

/*
 * JQuery zTree core v3.5.22
 * http://zTree.me/
 *
 * Copyright (c) 2010 Hunter.z
 *
 * Licensed same as jquery - MIT License
 * http://www.opensource.org/licenses/mit-license.php
 *
 * email: hunter.z@263.net
 * Date: 2016-03-01
 */

/** @preserve
	(c) 2012 by Cédric Mesnil. All rights reserved.

	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/

!function(e){"function"==typeof define&&define.amd?define("validate",["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){e.extend(e.fn,{validate:function(t){if(!this.length)return void (t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var n=e.data(this[0],"validator");return n?n:(this.attr("novalidate","novalidate"),n=new e.validator(t,this[0]),e.data(this[0],"validator",n),n.settings.onsubmit&&(this.on("click.validate",":submit",function(t){n.settings.submitHandler&&(n.submitButton=t.target),e(this).hasClass("cancel")&&(n.cancelSubmit=!0),void 0!==e(this).attr("formnovalidate")&&(n.cancelSubmit=!0)}),this.on("submit.validate",function(t){function r(){var r,i;return n.settings.submitHandler?(n.submitButton&&(r=e("<input type='hidden'/>").attr("name",n.submitButton.name).val(e(n.submitButton).val()).appendTo(n.currentForm)),i=n.settings.submitHandler.call(n,n.currentForm,t),n.submitButton&&r.remove(),void 0!==i?i:!1):!0}return n.settings.debug&&t.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,r()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):r():(n.focusInvalid(),!1)})),n)},valid:function(){var t,n,r;return e(this[0]).is("form")?t=this.validate().form():(r=[],t=!0,n=e(this[0].form).validate(),this.each(function(){t=n.element(this)&&t,t||(r=r.concat(n.errorList))}),n.errorList=r),t},rules:function(t,n){if(this.length){var r,i,s,o,u,f,l=this[0];if(t)switch(r=e.data(l.form,"validator").settings,i=r.rules,s=e.validator.staticRules(l),t){case"add":e.extend(s,e.validator.normalizeRule(n)),delete s.messages,i[l.name]=s,n.messages&&(r.messages[l.name]=e.extend(r.messages[l.name],n.messages));break;case"remove":return n?(f={},e.each(n.split(/\s/),function(t,n){f[n]=s[n],delete s[n],"required"===n&&e(l).removeAttr("aria-required")}),f):(delete i[l.name],s)}return o=e.validator.normalizeRules(e.extend({},e.validator.classRules(l),e.validator.attributeRules(l),e.validator.dataRules(l),e.validator.staticRules(l)),l),o.required&&(u=o.required,delete o.required,o=e.extend({required:u},o),e(l).attr("aria-required","true")),o.remote&&(u=o.remote,delete o.remote,o=e.extend(o,{remote:u})),o}}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){var n=e(t).val();return null!==n&&!!e.trim(""+n)},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,n){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=n,this.init()},e.validator.format=function(t,n){return 1===arguments.length?function(){var n=e.makeArray(arguments);return n.unshift(t),e.validator.format.apply(this,n)}:void 0===n?t:(arguments.length>2&&n.constructor!==Array&&(n=e.makeArray(arguments).slice(1)),n.constructor!==Array&&(n=[n]),e.each(n,function(e,n){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return n})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(t,n){var r=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===n.which&&""===this.elementValue(t)||-1!==e.inArray(n.keyCode,r)||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,n,r){"radio"===t.type?this.findByName(t.name).addClass(n).removeClass(r):e(t).addClass(n).removeClass(r)},unhighlight:function(t,n,r){"radio"===t.type?this.findByName(t.name).removeClass(n).addClass(r):e(t).removeClass(n).addClass(r)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}."),step:e.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var n=e.data(this.form,"validator"),r="on"+t.type.replace(/^validate/,""),i=n.settings;i[r]&&!e(this).is(i.ignore)&&i[r].call(n,this,t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var n,r=this.groups={};e.each(this.settings.groups,function(t,n){"string"==typeof n&&(n=n.split(/\s/)),e.each(n,function(e,n){r[n]=t})}),n=this.settings.rules,e.each(n,function(t,r){n[t]=e.validator.normalizeRule(r)}),e(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable]",t).on("click.validate","select, option, [type='radio'], [type='checkbox']",t),this.settings.invalidHandler&&e(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler),e(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var n,r,i=this.clean(t),s=this.validationTargetFor(i),o=this,u=!0;return void 0===s?delete this.invalid[i.name]:(this.prepareElement(s),this.currentElements=e(s),r=this.groups[s.name],r&&e.each(this.groups,function(e,t){t===r&&e!==s.name&&(i=o.validationTargetFor(o.clean(o.findByName(e))),i&&i.name in o.invalid&&(o.currentElements.push(i),u=u&&o.check(i)))}),n=this.check(s)!==!1,u=u&&n,n?this.invalid[s.name]=!1:this.invalid[s.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e(t).attr("aria-invalid",!n)),u},showErrors:function(t){if(t){var n=this;e.extend(this.errorMap,t),this.errorList=e.map(this.errorMap,function(e,t){return{message:e,element:n.findByName(t)[0]}}),this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,n=0;for(t in e)e[t]&&n++;return n},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,n={};return e(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var r=this.name||e(this).attr("name");return!r&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0]),r in n||!t.objectLength(e(this).rules())?!1:(n[r]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([])},reset:function(){this.resetInternals(),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var n,r,i=e(t),s=t.type;return"radio"===s||"checkbox"===s?this.findByName(t.name).filter(":checked").val():"number"===s&&"undefined"!=typeof t.validity?t.validity.badInput?"NaN":i.val():(n=t.hasAttribute("contenteditable")?i.text():i.val(),"file"===s?"C:\\fakepath\\"===n.substr(0,12)?n.substr(12):(r=n.lastIndexOf("/"),r>=0?n.substr(r+1):(r=n.lastIndexOf("\\"),r>=0?n.substr(r+1):n)):"string"==typeof n?n.replace(/\r/g,""):n)},check:function(t){t=this.validationTargetFor(this.clean(t));var n,r,i,s=e(t).rules(),o=e.map(s,function(e,t){return t}).length,u=!1,f=this.elementValue(t);if("function"==typeof s.normalizer){if(f=s.normalizer.call(t,f),"string"!=typeof f)throw new TypeError("The normalizer should return a string value.");delete s.normalizer}for(r in s){i={method:r,parameters:s[r]};try{if(n=e.validator.methods[r].call(this,f,t,i.parameters),"dependency-mismatch"===n&&1===o){u=!0;continue}if(u=!1,"pending"===n)return void (this.toHide=this.toHide.not(this.errorsFor(t)));if(!n)return this.formatAndAdd(t,i),!1}catch(l){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+i.method+"' method.",l),l instanceof TypeError&&(l.message+=".  Exception occurred when checking element "+t.id+", check the '"+i.method+"' method."),l}}if(!u)return this.objectLength(s)&&this.successList.push(t),!0},customDataMessage:function(t,n){return e(t).data("msg"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor===String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,n){var r=this.findDefined(this.customMessage(t.name,n.method),this.customDataMessage(t,n.method),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[n.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),i=/\$?\{(\d+)\}/g;return"function"==typeof r?r=r.call(this,n.parameters,t):i.test(r)&&(r=e.validator.format(r.replace(i,"{$1}"),n.parameters)),r},formatAndAdd:function(e,t){var n=this.defaultMessage(e,t);this.errorList.push({message:n,element:e,method:t.method}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,n;for(e=0;this.errorList[e];e++)n=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,n.element,this.settings.errorClass,this.settings.validClass),this.showLabel(n.element,n.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,n){var r,i,s,o,u=this.errorsFor(t),f=this.idOrName(t),l=e(t).attr("aria-describedby");u.length?(u.removeClass(this.settings.validClass).addClass(this.settings.errorClass),u.html(n)):(u=e("<"+this.settings.errorElement+">").attr("id",f+"-error").addClass(this.settings.errorClass).html(n||""),r=u,this.settings.wrapper&&(r=u.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(r):this.settings.errorPlacement?this.settings.errorPlacement(r,e(t)):r.insertAfter(t),u.is("label")?u.attr("for",f):0===u.parents("label[for='"+this.escapeCssMeta(f)+"']").length&&(s=u.attr("id"),l?l.match(new RegExp("\\b"+this.escapeCssMeta(s)+"\\b"))||(l+=" "+s):l=s,e(t).attr("aria-describedby",l),i=this.groups[t.name],i&&(o=this,e.each(o.groups,function(t,n){n===i&&e("[name='"+o.escapeCssMeta(t)+"']",o.currentForm).attr("aria-describedby",u.attr("id"))})))),!n&&this.settings.success&&(u.text(""),"string"==typeof this.settings.success?u.addClass(this.settings.success):this.settings.success(u,t)),this.toShow=this.toShow.add(u)},errorsFor:function(t){var n=this.escapeCssMeta(this.idOrName(t)),r=e(t).attr("aria-describedby"),i="label[for='"+n+"'], label[for='"+n+"'] *";return r&&(i=i+", #"+this.escapeCssMeta(r).replace(/\s+/g,", #")),this.errors().filter(i)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return e("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e){return e},string:function(t,n){return!!e(t,n.form).length},"function":function(e,t){return e(t)}},optional:function(t){var n=this.elementValue(t);return!e.validator.methods.required.call(this,n,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,e(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e(t).removeClass(this.settings.pendingClass),n&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!n&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,n){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:n})})},destroy:function(){this.resetForm(),e(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,n){t.constructor===String?this.classRuleSettings[t]=n:e.extend(this.classRuleSettings,t)},classRules:function(t){var n={},r=e(t).attr("class");return r&&e.each(r.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(n,e.validator.classRuleSettings[this])}),n},normalizeAttributeRule:function(e,t,n,r){/min|max|step/.test(n)&&(null===t||/number|range|text/.test(t))&&(r=Number(r),isNaN(r)&&(r=void 0)),r||0===r?e[n]=r:t===n&&"range"!==t&&(e[n]=!0)},attributeRules:function(t){var n,r,i={},s=e(t),o=t.getAttribute("type");for(n in e.validator.methods)"required"===n?(r=t.getAttribute(n),""===r&&(r=!0),r=!!r):r=s.attr(n),this.normalizeAttributeRule(i,o,n,r);return i.maxlength&&/-1|2147483647|524288/.test(i.maxlength)&&delete i.maxlength,i},dataRules:function(t){var n,r,i={},s=e(t),o=t.getAttribute("type");for(n in e.validator.methods)r=s.data("rule"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase()),this.normalizeAttributeRule(i,o,n,r);return i},staticRules:function(t){var n={},r=e.data(t.form,"validator");return r.settings.rules&&(n=e.validator.normalizeRule(r.settings.rules[t.name])||{}),n},normalizeRules:function(t,n){return e.each(t,function(r,i){if(i===!1)return void delete t[r];if(i.param||i.depends){var s=!0;switch(typeof i.depends){case"string":s=!!e(i.depends,n.form).length;break;case"function":s=i.depends.call(n,n)}s?t[r]=void 0!==i.param?i.param:!0:(e.data(n.form,"validator").resetElements(e(n)),delete t[r])}}),e.each(t,function(r,i){t[r]=e.isFunction(i)&&"normalizer"!==r?i(n):i}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var n;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(n=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(n[0]),Number(n[1])]))}),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var n={};e.each(t.split(/\s/),function(){n[this]=!0}),t=n}return t},addMethod:function(t,n,r){e.validator.methods[t]=n,e.validator.messages[t]=void 0!==r?r:e.validator.messages[t],n.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,n,r){if(!this.depend(r,n))return"dependency-mismatch";if("select"===n.nodeName.toLowerCase()){var i=e(n).val();return i&&i.length>0}return this.checkable(n)?this.getLength(t,n)>0:t.length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test((new Date(e)).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||i>=r},maxlength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||r>=i},rangelength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||i>=r[0]&&i<=r[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||n>=e},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},step:function(t,n,r){var i=e(n).attr("type"),s="Step attribute on input type "+i+" is not supported.",o=["text","number","range"],u=new RegExp("\\b"+i+"\\b"),f=i&&!u.test(o.join());if(f)throw new Error(s);return this.optional(n)||t%r===0},equalTo:function(t,n,r){var i=e(r);return this.settings.onfocusout&&i.not(".validate-equalTo-blur").length&&i.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){e(n).valid()}),t===i.val()},remote:function(t,n,r,i){if(this.optional(n))return"dependency-mismatch";i="string"==typeof i&&i||"remote";var s,o,u,f=this.previousValue(n,i);return this.settings.messages[n.name]||(this.settings.messages[n.name]={}),f.originalMessage=f.originalMessage||this.settings.messages[n.name][i],this.settings.messages[n.name][i]=f.message,r="string"==typeof r&&{url:r}||r,u=e.param(e.extend({data:t},r.data)),f.old===u?f.valid:(f.old=u,s=this,this.startRequest(n),o={},o[n.name]=t,e.ajax(e.extend(!0,{mode:"abort",port:"validate"+n.name,dataType:"json",data:o,context:s.currentForm,success:function(e){var r,o,u,a=e===!0||"true"===e;s.settings.messages[n.name][i]=f.originalMessage,a?(u=s.formSubmitted,s.resetInternals(),s.toHide=s.errorsFor(n),s.formSubmitted=u,s.successList.push(n),s.invalid[n.name]=!1,s.showErrors()):(r={},o=e||s.defaultMessage(n,{method:i,parameters:t}),r[n.name]=f.message=o,s.invalid[n.name]=!0,s.showErrors(r)),f.valid=a,s.stopRequest(n,a)}},r)),"pending")}}});var t,n={};e.ajaxPrefilter?e.ajaxPrefilter(function(e,t,r){var i=e.port;"abort"===e.mode&&(n[i]&&n[i].abort(),n[i]=r)}):(t=e.ajax,e.ajax=function(r){var i=("mode"in r?r:e.ajaxSettings).mode,s=("port"in r?r:e.ajaxSettings).port;return"abort"===i?(n[s]&&n[s].abort(),n[s]=t.apply(this,arguments),n[s]):t.apply(this,arguments)});var r=function(e){var t=e.match(/[^\x00-\xff]/ig);return e.length+(t==null?0:t.length)};$.validator.addMethod("domain",function(e,t){var n=/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/;return n.test(e)},"请输入正确的域名"),$.validator.addMethod("companyName",function(e,t){var n=r(e),i=/^[\u4e00-\u9fff0-9a-z\.\s,_]*$/i,s=/^\s+$/;return n>0&&n<=50&&!s.test(e)&&i.test(e)?!0:!1},"请输入正确的企业名称"),$.validator.addMethod("deptName",function(e,t){var n=r(e),i=/^[\u4e00-\u9fff0-9a-z\s]*$/i,s=/^\s+$/;return n>0&&n<=50&&!s.test(e)&&i.test(e)?!0:!1},"请输入正确的部门名称"),$.validator.addMethod("account",function(e,t){var n=/^[a-z0-9]([0-9a-z\.\-_]{1,19})$/i;return n.test(e)},"请输入正确的用户名"),$.validator.addMethod("fullName",function(e,t){var n=r(e),i=/^[a-zA-z0-9\s\u4e00-\u9fa5]+$/;return e?n<=10&&i.test(e)?!0:!1:!0},"请输入正确的姓名"),$.validator.addMethod("mobilePhone",function(e,t){if(!e)return!0;var n=/^(\+86|86)?(1[3|4|5|7|8][0-9]{9})$/;return n.test(e)},"请输入正确的手机号码"),$.validator.addMethod("companyPswd",function(e,t){var n=/^(?![A-Z]+$)(?![a-z]+$)(?!\d+$)(?![\W_]+$)\S+$/;return n.test(e)},"请输入正确密码"),$.validator.addMethod("remark",function(e,t){if(!e)return!0;var n=r(e);return n<=100?!0:!1},"请输入100字符以内的备注"),$.validator.addMethod("reDeptName",function(e,t){var n=$(t).data("type"),r=$(t).val(),i=$(t).data("deptname"),s,o;return n=="add"?UserManage.deptModel?s=UserManage.deptModel.deptId:s=0:s=UserManage.deptModel.parentId||0,o=_.find(UserManage.deptObj[s],function(e){return n=="edit"?e.name==r&&i!=r:e.name==r}),!o},"部门名称重复")}),define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.14",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.lastIndexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i[0]==="﻿"&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!modules/../../template/userManager.html",[],function(){return'<div>\r\n\r\n    <!--添加用户-->\r\n    <script type="text/x-handlebars-template" id="creatAccount-tpl">\r\n        <div id="creatAccount" class="creatAccount">\r\n            <form id="accountForm">\r\n                <ul>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.userManager.userName%></span>\r\n                        <div class="cACon">\r\n                            <input type="text" name="userId" placeholder="<%= Lang.userManager.typeUserName%>" class="inputAdd userId">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><%= Lang.userManager.name%></span>\r\n                        <div class="cACon">\r\n                            <input type="text" name="name" placeholder="<%= Lang.userManager.typeName%>" class="inputAdd name">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.userManager.userSpace %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" value="" name="storageNum" class="inputAdd storageNum" style="width:133px;" placeholder="<%= Lang.setting.typeSpace %>">\r\n                            <div style="display: inline-block;">\r\n                                <select class="unit-select storageUnit" id="unitSelect">\r\n                                    <option value="MB">MB</option>\r\n                                    <option value="GB">GB</option>\r\n                                    <!--<option value="T">TB</option>-->\r\n                                </select>\r\n                            </div>\r\n                            <p class="col_grey mt_5"><%= Lang.userManager.lessThan %>（<%= size %>）</p>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><%= Lang.userManager.email %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" placeholder="<%= Lang.userManager.typeEmail %>" name="email" class="inputAdd email">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><%= Lang.userManager.mobile %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" placeholder="<%= Lang.userManager.typeMobile %>" name="mobile" class="inputAdd mobile">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.setting.password %></span>\r\n                        <div class="cACon">\r\n                            <input type="password"  autocomplete="off" placeholder="<%= Lang.setting.typePwd %>" name="password" id="password" class="inputAdd password">\r\n                            <p class="pswd-lv">\r\n                                <span class="passwrodLevel"><i class="psl1"></i><i class="psl2"></i><i class="psl3"></i><em>弱</em></span>\r\n                            </p>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.setting.confirmPwd %></span>\r\n                        <div class="cACon">\r\n                            <input type="password"  autocomplete="off" placeholder="<%= Lang.setting.typePwd %>" name="password2" class="inputAdd password2">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub">&nbsp;</span>\r\n                        <div class="cACon">\r\n                            <label><input type="checkbox" class="dik vm passFlag"><em class="ml_5"><%= Lang.userManager.modifyPsw %></em></label>\r\n                        </div>\r\n                    </li>\r\n\r\n                </ul>\r\n            </form>\r\n        </div>\r\n    </script>\r\n    <!--添加用户-->\r\n\r\n\r\n    <!--批量导入-->\r\n    <script type="text/x-handlebars-template" id="importLead-tpl">\r\n        <div id="importLead" class="importLead">\r\n            <div class="importbox">\r\n                <h4><span>01</span><em><%= Lang.userManager.downFileTpl %></em></h4>\r\n                <div class="importPart">\r\n                    <p>\r\n                        <span><i class="i-Fcsv"></i><%= Lang.userManager.fileType %></span><a href="resource/template/useradd-model.xls" target="_blank" class="btn28 btn_green1 ml_10"><i class="i-downG mr_5"></i><em><%= Lang.userManager.downTpl %></em></a>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="importbox">\r\n                <h4><span>02</span><em><%= Lang.userManager.editTpl %></em></h4>\r\n                <div class="importPart">\r\n                    <p><img src="resource/images/TempImg1.jpg" width="571" height="92" alt=""></p>\r\n                </div>\r\n            </div>\r\n            <div class="importbox">\r\n                <h4><span>03</span><em><%= Lang.userManager.selectFile %></em></h4>\r\n                <div class="importPart" style="position:relative;">\r\n                    <iframe name="file-upload-iframe" id="file-upload-iframe" style="display:none"></iframe>\r\n\r\n                    <form name="file-form" id="file-form" method="post" action="" enctype="multipart/form-data" target="file-upload-iframe">\r\n                        <input type="file" id="file" name="file" class="file" style="position:absolute;width:100px;height:30px;opacity:0;filter:alpha(opacity=0);">\r\n                    </form>\r\n\r\n                    <p>\r\n                        <a href="javascript:;" class="btn28 btn_green2" id="btn-file"><i class="i-downW mr_5"></i><%= Lang.userManager.selectTplFile2 %></a>\r\n                        <span class="file-result" style="padding-left:10px"></span>\r\n                        <span class="upload-result" style="padding-left:10px"></span>\r\n                        <!--<span><i class="i-succesM mr_5"></i><b>上传成功！</b></span><a href="javascript:;" class="btn28 btn_green1 ml_10"><i class="i-UpG mr_5"></i><em>重新上传</em></a>-->\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </script>\r\n    <!--批量导入-->\r\n\r\n\r\n    <!--创建部门-->\r\n    <script type="text/x-handlebars-template" id="creatDept-tpl">\r\n        <div class="creatAccount">\r\n            <form id="deptAccountForm">\r\n                <ul>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.userManager.deptName %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" data-deptname="<%-name%>" data-type="<%-type%>" name="name" placeholder="<%= Lang.userManager.typeDeptName %>" class="inputAdd name" value="<%-name%>">\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.userManager.deptSpace %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" name="storageNum" value="<%=storageObj.num%>" class="inputAdd storageNum" style="width:133px;" placeholder="<%= Lang.setting.typeSpace %>">\r\n                            <div style="display: inline-block;">\r\n                                <select class="unit-select storageUnit">\r\n                                    <option value="MB">MB</option>\r\n                                    <option value="GB">GB</option>\r\n                                    <!--<option value="T">TB</option>-->\r\n                                </select>\r\n                            </div>\r\n                            <p class="col_grey mt_5"><%= Lang.userManager.lessThan %>（<%=size%>）</p>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><em class="col_red">*</em>  <%= Lang.userManager.deptUserLimit %></span>\r\n                        <div class="cACon">\r\n                            <input type="text" name="userLimit" value="<%=userLimit%>" placeholder="<%= Lang.userManager.typeDeptUserLimit %>" class="inputAdd userLimit" style="width:110px;"> <%= Lang.setting.userUnit %>\r\n                        </div>\r\n                    </li>\r\n                    <li>\r\n                        <span class="cAsub"><%= Lang.userManager.remark %></span>\r\n                        <div class="cACon">\r\n                            <textarea class="inputRemark remark" name="remark"><%-remark%></textarea>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </form>\r\n        </div>\r\n    </script>\r\n    <!--创建部门-->\r\n\r\n\r\n    <!--账户设置-->\r\n    <script type="text/x-handlebars-template" id="accountSetting-tpl">\r\n        <div id="accountSetting" class="popContainer" style="padding:0;">\r\n            <form id="accountSettingForm">\r\n                <div class="popUserSetL">\r\n                    <ul>\r\n                        <li class="act"><a href="javascript:;"><%= Lang.userManager.accountSetting %></a></li>\r\n                        <li><a href="javascript:;"><%= Lang.userManager.userPsw %></a></li>\r\n                        <li><a href="javascript:;"><%= Lang.userManager.userSpace %></a></li>\r\n                    </ul>\r\n                </div>\r\n                <div class="popUserSetR">\r\n                    <div class="popUserSetRCon clearfix">\r\n                        <ul class="con-ul">\r\n                            <li><span class="pUSRlt"><%= Lang.userManager.userName %></span>\r\n                                <div class="pUSRrt"><%=userId%></div>\r\n                            </li>\r\n                            <li><span class="pUSRlt"><%= Lang.userManager.name %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input name="name" type="text" class="inputAdd name" placeholder="<%= Lang.userManager.typeName %>" value="<%=name%>">\r\n                                </div>\r\n                            </li>\r\n                            <li><span class="pUSRlt"><%= Lang.userManager.email %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input name="email" type="text" class="inputAdd email" placeholder="<%= Lang.userManager.typeEmail %>" value="<%= email %>">\r\n                                </div>\r\n                            </li>\r\n                            <li><span class="pUSRlt"><%= Lang.userManager.mobile %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input name="mobile" type="text" class="inputAdd mobile" placeholder="<%= Lang.userManager.typeMobile %>" value="<%= mobile %>">\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                        <ul class="con-ul" style="display: none">\r\n                            <li><span class="pUSRlt"><em class="col_red">*</em>  <%= Lang.setting.password %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input name="password" type="password" autocomplete="off" id="as-password" class="inputAdd password" placeholder="<%= Lang.setting.typePwd %>">\r\n                                </div>\r\n                            </li>\r\n                            <li style="line-height:16px; padding:0"><span class="pUSRlt">&nbsp;</span>\r\n                                <div class="pUSRrt">\r\n                                    <p class="pswd-lv">\r\n                                        <span class="passwrodLevel"><i class="psl1"></i><i class="psl2"></i><i class="psl3"></i><em>弱</em></span>\r\n                                    </p>\r\n                                </div>\r\n                            </li>\r\n                            <li><span class="pUSRlt"><em class="col_red">*</em>  <%= Lang.setting.confirmPwd %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input name="password2" type="password" autocomplete="off" class="inputAdd password2" placeholder="请输入确认密码">\r\n                                </div>\r\n                            </li>\r\n                            <li><span class="pUSRlt">&nbsp;</span>\r\n                                <div class="pUSRrt">\r\n                                    <label><input type="checkbox" class="dik vm passFlag" <%=passFlag==1?\'checked="checked"\':\'\'%>/>\r\n                                        <em class="ml_5"><%= Lang.userManager.modifyPsw %></em></label></div>\r\n                            </li>\r\n                        </ul>\r\n                        <ul class="con-ul" style="display: none">\r\n                            <li>\r\n                                <div class="pUSRrt ml_25"><%= Lang.userManager.usedSpace %><%=usedStorageObj%>，<%= Lang.userManager.all %><%=storageObj%>\r\n                                </div>\r\n                            </li>\r\n                            <li>\r\n                                <span class="pUSRlt"><em class="col_red">*</em>  <%= Lang.userManager.userSpace %></span>\r\n                                <div class="pUSRrt">\r\n                                    <input type="text" name="storageNum" style="width:100px;" class="inputAdd storageNum" placeholder="<%= Lang.setting.typeSpace %>" value="<%=storageNum%>">\r\n                                    <div style="display: inline-block;">\r\n                                        <select class="unit-select storageUnit" id="unitSelect">\r\n                                            <option value="MB">MB</option>\r\n                                            <option value="GB">GB</option>\r\n                                            <!--<option value="T">TB</option>-->\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    </script>\r\n    <!--账户设置-->\r\n\r\n</div>\r\n'}),global.language=global.language||"zh_CN",define("controls/Common",["jquery","underscore","i18n/"+global.language],function(e,t,n){return{Module:{nowModule:{},callModule:function(e){var n=Array.prototype.slice.call(arguments,0);n.shift();var r=this.nowModule.destroy,i=e.init;i&&t.isFunction(i)&&(r&&t.isFunction(r)&&r.apply(this.nowModule),this.nowModule=e,i.apply(e,n))}},APIObj:{url:"admin.do",fnName:{},getUrlByFnName:function(e){if(e&&this.fnName[e])return[this.url,"?func=",this.fnName[e]].join("");console.log(n.common.invalidFn)}},formatFloat:function(e,t){var n=e.toFixed(t);return parseInt(n,10)==n?parseInt(n,10):n},formatStorageUnit:function(e,t,n){var r=1024,i=1048576,s=1073741824,o=1099511627776,u,a;if(n){switch(n){case"B":u=this.formatFloat(e,1);break;case"K":case"KB":u=this.formatFloat(e/r,1);break;case"M":case"MB":u=this.formatFloat(e/i,1);break;case"G":case"GB":u=this.formatFloat(e/s,1);break;case"T":case"TB":u=this.formatFloat(e/o,1);break;default:}a=n}else e>=o?(u=this.formatFloat(e/o,1),a="TB"):e>=s?(u=this.formatFloat(e/s,1),a="GB"):e>=i?(u=this.formatFloat(e/i,1),a="MB"):e>=r?(u=this.formatFloat(e/r,1),a="KB"):(u=this.formatFloat(e,1),a="B");return t?{num:u,unit:a}:u==0?0:u+a},stringFormat:function(){if(arguments.length==0)return null;var e=arguments[0];for(var t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1)+"\\}","gm");e=e.replace(n,arguments[t])}return e},convertToB:function(e,t){var n;switch(t){case"K":case"KB":n=1024;break;case"M":case"MB":n=1048576;break;case"G":case"GB":n=1073741824;break;case"T":case"TB":n=1099511627776;break;default:n=1}return e*n},formatOutDate:function(e){var t,r;return e>=12?(t=parseInt(e/12,10),r=e%12,[t,n.setting.year,r?r+n.setting.month:""].join("")):e+n.setting.month},getOutDate:function(e){return e==-1?n.setting.forever:this.formatOutDate(e)},getStatus:function(e){var t="";switch(e){case 0:t=n.setting.normal;break;case 1:t=n.setting.locked;break;case 2:t=n.setting.canceled;break;default:t=n.setting.normal}return t},getTemplate:function(t,n){return e(t).find(n).html()},tpl2Html:function(e,r){var i=t.template(e);return i(t.extend({},{Lang:n},r||{}))},parseURL:function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){var e={},n=t.search.replace(/^\?/,"").split("&"),r=n.length,i=0,s;for(;i<r;i++){if(!n[i])continue;s=n[i].split("="),e[s[0]]=s[1]}return e}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},getRootUrl:function(){var e=this.parseURL(window.location.href);return[e.protocol,"://",e.host+"/"].join("")},getFileExt:function(e){if(e!=""){var t="."+e.replace(/.+\./,"");return t}},getLv:function(e){var t=1,r=n.common.weak,i=/[a-zA-z]/,s=/[0-9]/,o=/(?=[\x21-\x7e]+)[^A-Za-z0-9]/;if(i.test(e)&&s.test(e)&&o.test(e))t=3,r=n.common.strong;else if(i.test(e)&&s.test(e)||i.test(e)&&o.test(e)||s.test(e)&&o.test(e))t=2,r=n.common.normal;return{pswdLv:t,pswdLvText:r}},checkPswdLv:function(t,n){var r=this;e(t).off("keyup.lv").on("keyup.lv",function(){var t=e(this),i=t.val(),s=e(n);if(i==""){s.hide();return}s.show();var o=r.getLv(i);s.find("span").attr("class","passwrodLevel Plevel_"+o.pswdLv),s.find("em").text(o.pswdLvText)})},addStyle:function(t,n){var r="temp-style-"+t,i=e("#"+r);i.length&&i.remove();var s=['<style id="',r,'" type="text/css" rel="stylesheet">',n,"</style>"].join("");e(s).appendTo("head")}}}),define("controls/List",["jquery","underscore"],function(e,t){var n=function(e){this.option=e,this.data=this.option.data,this.option.operate&&(this.operateList=this.option.operate.list),this.Fn={};var n=this;return this.operateList&&this.operateList.length&&t.each(this.operateList,function(e){n.Fn[e.action]=e.onClick}),t.each(this.option.columns,function(e){e.action&&(n.Fn[e.action]=e.onClick)}),this.init(),this.html=[],this};return n.prototype={init:function(){this.render(),this.initEvents(),this.option.hasCheckBtn&&this.initCheck()},getTitleHtml:function(){var e=this,n=["<tr>"];return this.option.hasCheckBtn&&n.push(['<th width="25" style="padding-left:20px;"><input class="checkAll" type="checkbox"></th>'].join("")),t.each(this.option.columns,function(e){n.push(['<th scope="col"',e.titleStyle?' style="'+e.titleStyle+'"':"",e.titleAttr,">",e.columnName,"</th>"].join(""))}),e.option.operate&&e.option.operate.list&&e.option.operate.list.length&&n.push(['<th scope="col"',e.option.operate.titleStyle?' style="'+e.option.operate.titleStyle+'"':"",e.option.operate.titleAttr,">",e.option.operate.columnName,"</th>"].join("")),n.push("</tr>"),n.join("")},getListHtml:function(){var e=this,n=[];if(!e.data.length){var r=e.option.columns.length+(e.option.hasCheckBtn?1:0)+(e.option.operate?1:0);return'<tr class="no-data"><td colspan="'+r+'" align="center"><div class="tipsNoDate"><h5><i class="i-noDate"></i></h5><h4>暂无数据</h4></div></td></tr>'}return t.each(e.data,function(r){var i;e.option.rowClass&&typeof e.option.rowClass=="function"&&(i=e.option.rowClass(r));var s=["<tr",i?' class="'+i+'"':"",' data-key="',r[e.option.key],'">'];e.option.hasCheckBtn&&s.push(['<td style="padding-left:20px;"><input type="checkbox" class="list-checkbox" value="',r[e.option.key],'"></td>'].join("")),t.each(e.option.columns,function(e){var t=r[e.columnId],n=e.callback(t)||t||"";s.push(['<td data-columnId="',e.columnId,'">',n,"</td>"].join(""))}),e.option.operate&&e.option.operate.list&&e.option.operate.list.length&&(s.push("<td>"),t.each(e.option.operate.list,function(e){s.push(['<a href="javascript:;" class="',e.className,'" data-action="',e.action,'">',e.name,"</a>"].join(""))}),s.push("</td>")),s.push("</tr>"),n.push(s.join(""))}),n.join("")},render:function(){var t=this.getTitleHtml(),n=this.getListHtml(),r=['<div class="tableBox"><table width="100%" class="tableList"><tbody>',t,n,"</tbody></table></div>"];e(this.option.container).html(r.join(""))},initEvents:function(){var n=this;e(this.option.container).off("click.list").on("click.list",function(r){var i=e(r.target),s=i.parents("td").length?i.parents("td"):i,o=i.parents("tr"),u=o.data("key"),a=i.data("action");if(a){var f=t.find(n.data,function(e){return e[n.option.key]==u});n.Fn[a]&&typeof n.Fn[a]=="function"&&n.Fn[a](f,s,o)}})},getSelected:function(){var n=this,r=[];return e(this.option.container).find(".list-checkbox:checked").each(function(){var i=e(this).val(),s=t.find(n.data,function(e){return e[n.option.key]==i});r.push(s)}),r},initCheck:function(){var t=this;this.$container=e(this.option.container),this.$listCheckbox=this.$container.find(".list-checkbox"),this.$checkAll=e(this.option.container).find(".checkAll"),this.$checkAll.off("change.list").on("change.list",function(){var n=e(this).prop("checked");t.$listCheckbox.prop("checked",n)}),this.$listCheckbox.off("change.list").on("change.list",function(){var e=t.$container.find(".list-checkbox:checked").length;t.$checkAll.prop("checked",t.data.length==e)})},destroyEvents:function(){this.$checkAll&&this.$checkAll.off("change.list"),this.$listCheckbox&&this.$listCheckbox.off("change.list")},setData:function(e){this.destroyEvents(),this.data=e,this.init()}},n}),function(e,t){e.sobox={maskIndex:0,showMask:function(n){var r=this;if(n){var i=e(".so-openmask");i.length?r.maskIndex++:(i=e('<div class="so-openmask"></div>'),e("body").append(i),r.maskIndex=1);var s=typeof t.body.style.maxHeight=="undefined"?t:window,o=e(s).height()-18;i.height(n?o+20:0),e(window).resize(function(){var t=e(s).height()-18;i.height(n?t+20:0)}),i.css("z-index",1e3+r.maskIndex*10)}else i=null;return i},show:function(t,n,r){var i=this,s=e(t.obj),o=i.showMask(n);return i.setPos(t),t.onlyOne&&e("body").data("soonlyone",!0),s.css("z-index",1002+i.maskIndex*10).fadeIn(),s.find(".s-close").bind("click",function(){i.hide(s)}),r&&r(),o},hide:function(t,n,r){var i=this,s=e(".so-openmask");e(t).fadeOut("fast",function(){r&&r()}),n&&(i.maskIndex--,s.css("z-index",1e3+i.maskIndex*10),i.maskIndex==0&&s.remove()),e(t).find(".s-close").unbind("click")},drag:function(n,r){function o(e){e==null&&(e=window.event),i.css({left:e.clientX-posX+"px",top:e.clientY-posY+"px"})}var i=e(n),s=e(r);s.mousedown(function(n){n||(n=window.event),posX=n.clientX-parseInt(i.css("left")),posY=n.clientY-parseInt(i.css("top")),e(t).bind("mousemove.drag",function(e){o(e)})}),e(t).mouseup(function(n){n.target==s.get(0)&&e(t).unbind("mousemove.drag")})},setPos:function(n){var r=this,n=e.extend({mode:"center",obj:null,pos:[0,0],offset:[0,0]},n),i=e(n.obj),s=Math.floor(i.height()/2),o=Math.floor(i.width()/2),u=e(window).scrollTop(),a=e(window).height(),f=n.pos[0],l=n.pos[1],c=n.offset[0],h=n.offset[1];i.css({position:"fixed"});if(typeof t.body.style.maxHeight=="undefined"){var p=i.find("select");e("select").not(p).hide()}switch(n.mode){case"win":i.css({left:f+c,top:l+h}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+l+h});break;case"doc":i.css({position:"absolute",left:f+c,top:l+h});break;case"tc":i.css({left:"50%",top:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h});break;case"bc":i.css({left:"50%",bottom:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h+a});break;default:i.css({top:"50%",left:"50%",marginTop:-s-10+h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+a/2})}},pop:function(t){function f(a){t=e.extend(t,a||{}),t.showTitle&&i.append(s),t.outCloseBtn&&o.addClass("s-sopop-out-close"),i.append(o).append(u),t.height&&t.type!="iframe"&&i.css("height",t.height+"px"),i.css({visibility:t.visibility?"visible":"hidden"}),t.type=="content"&&u.html(t.content);if(t.type=="target"){var f=e(t.target).show();u.append(f)}if(t.type=="iframe"){var c=e('<iframe id="'+t.iframeID+'" name="'+t.iframeID+'" src="'+t.iframe+'" width="100%" height="'+t.height+'" frameborder="0" scrolling="auto"></iframe>');u.html(c)}t.type=="ajax"&&u.load(t.ajax.url,t.ajax.data,function(){n.setPos({mode:t.posType,obj:i,pos:t.pos,offset:t.offset}),t.ajax.callback&&t.ajax.callback()});if(t.btn.length>0){var h=e('<p class="p-so-popBtn"></p>');e.each(t.btn,function(){var t=e.extend({cls:null,text:"确定",link:"#",removePop:!0,callback:function(e){}},this),n=e('<a class="a-sopop-btn" href="'+t.link+'"><span class="s-sopop-btn">'+t.text+"</span></a>");t.cls!==null&&n.addClass(t.cls),n.bind("click",function(){return t.callback&&t.callback(l)&&l(),t.removePop&&l(),t.link==="#"?!1:!0}),h.append(n)}),i.append(h)}e("body").append(i),t.showTitle&&t.drag&&(s.addClass("h2-sopop-move"),n.drag(i,s)),t.beforePop(i,s,o,u),r=n.show({mode:t.posType,obj:i,pos:t.pos,offset:t.offset,onlyOne:t.onlyOne},t.showMask,t.onPop(i)),o.bind("click",function(){l()}),r&&t.maskClick&&r.bind("click",function(){l()})}function l(r){t=e.extend(t,r||{}),n.hide(i,t.showMask),e("body").removeData("soonlyone"),t.target!=null&&e(t.target).appendTo("body").hide(),i.remove(),t.closePop()}var n=this,t=e.extend({type:"content",target:null,content:null,iframe:null,iframeID:"sopop-iframe",ajax:{url:null,data:null,callback:function(){}},posType:"center",pos:[0,0],offset:[0,0],cls:null,width:400,height:null,defaultShow:!0,visibility:!0,title:"提示",showTitle:!0,outCloseBtn:!1,showMask:!0,onlyOne:!1,drag:!0,maskClick:!0,btn:[],beforePop:function(){},onPop:function(){},closePop:function(){}},t||{}),r,i=e('<div class="so-popbox '+(t.cls?t.cls:"")+'" style="width:'+t.width+'px;display:none;"></div>'),s=e('<h2 class="h2-sopop"><span class="s-sopop-title">'+t.title+"</span></h2>"),o=e('<span class="s-sopop-close">[关闭]</span>'),u=e('<div class="so-popbox-cont"></div>'),a=e("body").data("soonlyone");return t.defaultShow&&!a&&f(),{wrap:i,mask:r,opt:t,removePop:l,showPop:f}},alert:function(e,t,n){var r=this;r.pop({cls:"so-popAlert",title:e,width:360,content:t,btn:[{text:"确定"}],closePop:n})},confirm:function(e,t,n,r){var i=this;i.pop({cls:"so-popConfirm",title:e,width:360,content:t,btn:[{text:"确定",callback:function(){n&&n()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){r&&r()}}]})},tip:function(t){var n=this,r=null,t=e.extend({cls:"so-popTip",showTitle:!1,posType:"tc",showMask:!1,width:250,stayTime:5e3,offset:[0,5],closePop:function(){r&&clearTimeout(r)}},t||{}),i=n.pop(t);return t.stayTime>0&&(r=setTimeout(function(){i.removePop()},t.stayTime)),i},loading:function(t){var n=this,t=e.extend({type:"content",cls:"so-loading",showTitle:!1,maskClick:!1,width:100,height:36,content:"",stayTime:0,showMask:!1},t||{}),r=n.pop(t);return t.stayTime>0&&setTimeout(function(){r.removePop()},t.stayTime),{open:r.showPop,close:r.removePop}}},e.fn.extend({soIframePop:function(t){var n=e.extend({type:"iframe",targetTag:"href",splitString:"#soIframe?",width:800,height:480,showTitle:!1},t||{}),r=[];return this.each(function(){var t=e(this),i=t.attr(n.targetTag).split(n.splitString),s=i[0];par=i[1]?i[1].split("&"):"";var u={};e.each(par,function(){var e=this.split("=");u[e[0]]=e[1]}),n=e.extend(n,u||{}),n.showTitle=n.showTitle=="true"?1:+n.showTitle,n.iframe=s,n.defaultShow=!1;var a=e.sobox.pop(n);r.push(a),t.click(function(){return a.showPop(),e(this).data("iframePop",a),!1})}),r},soSidePop:function(t){var n=e(this),r=t.event||"click",i=null;return n.bind(r,function(n){var r=e(this).offset(),s=t.por=="mouse"?[n.pageX,n.pageY]:[r.left,r.top],o=e.extend({showMask:!1,posType:"doc",por:"mouse",pos:s,offset:[10,10],onlyOne:!0,returnFalse:!0},t||{});i=e.sobox.pop(o);if(o.returnFalse)return!1}),t.leaveHide==1&&n.bind("mouseout",function(e){i&&i.removePop()}),n},soOverTip:function(t){var n=e(this),r=e.extend({cls:"so-overTip",showMask:!1,posType:"doc",offset:[10,10],showTitle:!1,onlyOne:!0},t||{}),i=null;return n.mouseenter(function(t){r.pos=[t.pageX,t.pageY],i=e.sobox.pop(r)}).mouseleave(function(){i.removePop()}),n},clickPop:function(t){var t=e.extend({optAll:null},t||{}),n=e(this);n.click(function(){var n=e(this).attr("rel"),r=this,s=e(this).attr("popType")||"target";if(n){var u=t.optAll,a=n.split("."),f=a.length;for(i=0;i<f;i++)u=u[a[i]];var l=n.replace(".","_");optT=e.extend({title:e(this).text(),type:s,target:e("#"+l),iframe:e(this).attr("href")},u),optT.beforePop=function(e,t,n,i){u.beforePop&&u.beforePop.call(r,e,t,n,i)},t.optAll.$pop=e.sobox.pop(optT)}})}})}(jQuery,document),define("sobox",["jquery"],function(){}),define("controls/Dialog",["jquery","underscore","sobox"],function(e,t,n){return{pop:function(n){return n=t.extend({},{width:"auto",btn:[{text:n.okText||"确定",removePop:n.okRemovePop==undefined?!0:n.okRemovePop,callback:n.ok},{text:n.cancelText||"取消",cls:"a-sopop-cancel",removePop:!0,callback:n.cancel}]},n),e.sobox.pop(n)},alert:function(){var t,n,r=function(){};if(arguments.length)switch(arguments.length){case 1:t="提示",n=arguments[0];break;case 2:t=arguments[0],n=arguments[1];break;case 3:t=arguments[0],n=arguments[1],r=arguments[2];break;default:}return e.sobox.alert(t,n,r)},confirm:function(t,n,r,i){var s=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips_qa"></i></td>','<td><em class="tipsTxt">',n,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.pop({title:t,content:s,btn:[{text:"确定",callback:function(){r&&r()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){i&&i()}}]})},tips:function(t,n){return e.sobox.tip({cls:"so-popTip",posType:"ct",content:t,width:"auto",height:38,offset:[0,-75],stayTime:n*1e3||4e3})},warn:function(t,n,r){var i=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips"></i></td>','<td><em class="tipsTxt">',t,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.alert("提示",i,r)},loading:function(t){return e.sobox.loading({cls:"so-loading",stayTime:t*1e3||0,width:100,height:100})}}}),typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;typeof JSON.stringify!="function"&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),define("controls/Ajax",["jquery","underscore","controls/Dialog","json2"],function(e,t,n,r){var i={requestId:0,loadingObj:{},defaultOpts:{type:"POST",data:{},dataType:"json",success:function(){},error:function(){i.loadingObj.close&&i.loadingObj.close(),n.tips("Error Request !")},contentType:"text/plain; charset=UTF-8"},request:function(r,i,s){this.requestId++;var o=this;if(!r.url)return;this.url=r.url,s||(o.loadingObj.close&&o.loadingObj.close(),o.loadingObj=n.loading()),r.data&&r.data.parse&&delete r.data.parse,r.data&&r.data.success&&delete r.data.success,r.data&&r.data.error&&delete r.data.error,r.fail=r.fail||function(e){n.tips("Error:"+e.code)},e.ajax(t.extend({},this.defaultOpts,r,{data:JSON.stringify(r.data),success:function(e){s||o.loadingObj.close();if(!e)return;i?r.success(e):e&&e.code&&e.code=="S_OK"&&e.hasOwnProperty("var")?r.success(e["var"]):r.fail({code:e.code,errorCode:e.errorCode,summary:e.summary})},error:function(e){s||o.loadingObj.close();if(e.status==200||e.status==0){window.location.reload();return}r.fail(e)}}))}};return i}),function($){function init(param,obj){function getParam(){var e="page="+opts.currPage;return opts.ajax.param&&(e+="&"+opts.ajax.param),e}function getPanelTipInfo(){var e="";if(opts.panel.tipInfo_on){var t=document.createElement("span");t=$(t);var n=t.text(opts.panel.tipInfo).text();if(-1!=n.indexOf("{input}")){var r="<input type='text' value='"+opts.currPage+"' >";n=n.replace("{input}",r),n=n.replace("{sumPage}",opts.pageCount),t.html(n),r=t.children(":text:first"),r.css(opts.panel.tipInfo_css),e=t.html()}else if(-1!=n.indexOf("{select}")){for(var i=document.createElement("select"),s=1;parseInt(opts.pageCount)>=s;s++){var o=new Option(s,s);i.options.add(o)}t.html("");var u=n.substr(0,n.indexOf("{select}")),a=n.substr(n.indexOf("{select}")+"{select}".length).replace("{sumPage}",opts.pageCount);t.append(u),t.append(i),t.append(a),e=t.html()}}return e}function onRequest(){debug(opts.id),debug("ajax请求参数列表:"),debug(getParam()),opts.ajax.on?(opts.ajax.ajaxStart(),$.ajax({url:opts.ajax.url,type:opts.ajax.type,data:getParam(),contentType:"application/x-www-form-urlencoded;utf-8",async:!0,cache:!1,timeout:6e4,error:function(){alert("访问服务器超时，请重试，谢谢！")},success:function(e){opts.ajax.ajaxStop(),responseHandle(e),createPageBar()}})):createPageBar()}function responseHandle(data){var pageCountId=opts.ajax.pageCountId,resultPageCount=1;switch(opts.ajax.dataType){case"json":try{data=eval("("+data+")")}catch(err){}finally{resultPageCount=eval("data."+pageCountId)}break;case"xml":try{resultPageCount=$(data).find(pageCountId).text()}catch(e){debug("xml返回数据解析错误，使用默认的pageCount=1"),resultPageCount=1}break;default:try{resultPageCount=$(data).find(":hidden[id='"+pageCountId+"']").val()}catch(e){debug("html返回数据解析错误，使用默认的pageCount=1"),resultPageCount=1}}debug(opts.id),debug("返回总页数:"+resultPageCount),opts.pageCount=resultPageCount,opts.ajax.callback(data)}function createPageBar(){var e=opts.panel.links;opts.currPage=opts.currPage>opts.pageCount?opts.pageCount:opts.currPage;var t=opts.currPage,n=parseInt(opts.pageCount),r=parseInt(opts.pageNumber/2),i=opts.pageNumber,s="";opts.panel.first_on&&(s="<a class='"+(1==t?"disabled":"")+"' href='"+e+"' paged='1'>"+opts.panel.first+"</a>"),opts.panel.prev_on&&(s+=1==t?'<span class="disabled" paged="'+opts.panel.prev+'">'+opts.panel.prev+" </span>":"<a href='"+e+"' paged='"+(t-1)+"'>"+opts.panel.prev+" </a>");var o=lastPage=1;for(o=t-r>0?o=t-r:1,o+i>n?(lastPage=n+1,o=lastPage-i):lastPage=o+i,0>=o&&(o=1),o;lastPage>o;o++)s+=o==t?'<span class="current" paged="'+o+'">'+o+"</span>":"<a href='"+e+"' paged='"+o+"'>"+o+"</a>";opts.panel.next_on&&(s+=t==n?'<span class="disabled" paged="'+opts.panel.next+'">'+opts.panel.next+" </span>":"<a href='"+e+"' paged='"+(t+1)+"'>"+opts.panel.next+" </a>"),opts.panel.last_on&&(s+="<a class='"+(n==t?"disabled":"")+"' href='"+e+"' paged='"+n+"'>"+opts.panel.last+"</a>"),s+=getPanelTipInfo(),debug(opts.id),debug("最终生成菜单："),debug(s),obj.html(s),obj.children("select").val(opts.currPage),obj.children("select").change(function(){var e=parseInt($(this).children("option:selected").val());opts.currPage=e,onRequest()}),obj.children(":text").keyup(function(){var e=$(this),t=$.trim($(this).val());if(0!=t.length){var n=/^\+?[0-9][0-9]*$/;n.exec(t)||e.val(1)}}),obj.children(":text").keypress(function(e){var t=e.which;if(13==t){var n=$.trim($(this).val());obj.children("a").unbind("click"),obj.children("a").each(function(){$(this).click(function(){return!1})}),opts.currPage=n,onRequest()}}),obj.children("a").each(function(){var e=$(this);e.click(function(){if(e.hasClass("disabled"))return;var t=parseInt(e.attr("paged"));return t=t>0?t:1,e.children("a").unbind("click"),e.children("a").each(function(){$(this).click(function(){return!1})}),opts.currPage=t,opts.ajax.onClick(t),onRequest(),$(this).focus(),!1})})}function debug(e){opts.debug&&$.fn.debug(e)}var defaults={currPage:1,pageCount:10,pageNumber:5,cssStyle:"badoo",debug:!1,ajax:{on:!1,type:"POST",pageCountId:"pageCount",url:"jsonTest.php",dataType:"json",param:!1,onClick:function(){return!1},ajaxStart:function(){return!1},ajaxStop:function(){return!1},callback:function(){return!1}},panel:{first:"首页",last:"尾页",next:"下一页",prev:"上一页",first_on:!0,last_on:!0,next_on:!0,prev_on:!0,links:"javascript:;",tipInfo_on:!1,tipInfo:"<span>&nbsp;&nbsp;跳{currText}/{sumPage}页</span>",tipInfo_css:{width:"22px"},tipSelect_on:!1,tipSelect:"跳转到{select} 共{sumPage}页"}},opts=$.extend(!0,defaults,param);opts.id=obj.attr("id"),obj.addClass(opts.cssStyle),onRequest();var method={};return method.id=opts.id,method.getPage=function(){return opts.currPage},method.onReload=function(){debug("reload()"),onRequest()},method.onLoad=function(e){e&&e instanceof Object&&(debug(e),opts.currPage=1,opts.ajax.param=e.param,onRequest())},method.jumpPage=function(e){debug("jumpPage("+e+")"),e=1>e?1:e,e=e>opts.pageCount?opts.pageCount:e,opts.currPage=e,onRequest()},method}$.fn.myPagination=function(e){return init(e,$(this))},$.fn.debug=function(e){window.console&&window.console.log&&console.log(e)}}(jQuery),define("myPagination",["jquery"],function(){}),define("controls/Pager",["jquery","myPagination"],function(e,t){var n=function(e){this.option=e,this.el=e.el,this.pageNo=e.pageNo,this.pageSize=e.pageSize,this.total=e.total,this.onclick=e.onclick,this.cssStyle="manu",this.init()};return n.prototype={getPageCount:function(){return Math.ceil(this.total/this.pageSize)},init:function(){var t=this;e(this.el).myPagination({currPage:t.pageNo,pageCount:t.getPageCount(),pageNumber:10,cssStyle:t.cssStyle,ajax:{on:!1,onClick:t.onclick}})}},n}),define("text!controls/../../template/deptUserBox.html",[],function(){return'<div id="deptUserBox" class="addGroupBox clearfix">\r\n    <div class="addGroupLt">\r\n        <p><%=Lang.userManager.allUser%></p>\r\n        <div class="addGSearch">\r\n            <input type="text" class="addGInput" placeholder="<%= Lang.userManager.searchTips%>" value=""><a href="javascript:;" id="boxBtn-search"><i class="i-search2"></i></a>\r\n        </div>\r\n        <div class="addGList">\r\n            <div class="orgTreeScroll" style="overflow:auto; height:330px;">\r\n                <div class="deptUser-list ztree ">\r\n                    <ul id="deptUser-list">\r\n                        <li>\r\n                            <div class="deptLoad" style="padding-left: 10px; padding-top: 10px"><%=Lang.common.loading %>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div class="search-list" style="display:none">\r\n                    <div class="search-result"><%=Lang.userManager.searchResult%>:</div>\r\n                    <ul class="select-tx-ul-search"></ul>\r\n                    <a href="javascript:;" class="btn-search-more"><%=Lang.userManager.loadMore%></a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="addGroupMd"><i class="i-arrRight"></i></div>\r\n    <div class="addGroupRt">\r\n        <p><a href="javascript:;" class="fr" id="clear"><%=Lang.userManager.clearAll%></a><%=Lang.userManager.user%></p>\r\n        <div class="addGListRs">\r\n            <ul></ul>\r\n        </div>\r\n    </div>\r\n</div>'}),function($){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],customParam:[],deptParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);t||(t={},data.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);t||(t={},data.setCache(e,t)),t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,n=consts.event;t.bind(n.NODECREATED,function(t,n,r){tools.apply(e.callback.onNodeCreated,[t,n,r])}),t.bind(n.CLICK,function(t,n,r,i,s){tools.apply(e.callback.onClick,[n,r,i,s])}),t.bind(n.EXPAND,function(t,n,r){tools.apply(e.callback.onExpand,[t,n,r])}),t.bind(n.COLLAPSE,function(t,n,r){tools.apply(e.callback.onCollapse,[t,n,r])}),t.bind(n.ASYNC_SUCCESS,function(t,n,r,i){tools.apply(e.callback.onAsyncSuccess,[t,n,r,i])}),t.bind(n.ASYNC_ERROR,function(t,n,r,i,s,o){tools.apply(e.callback.onAsyncError,[t,n,r,i,s,o])}),t.bind(n.REMOVE,function(t,n,r){tools.apply(e.callback.onRemove,[t,n,r])}),t.bind(n.SELECTED,function(t,n,r){tools.apply(e.callback.onSelected,[n,r])}),t.bind(n.UNSELECTED,function(t,n,r){tools.apply(e.callback.onUnSelected,[n,r])})},_unbindEvent=function(e){var t=e.treeObj,n=consts.event;t.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR).unbind(n.REMOVE).unbind(n.SELECTED).unbind(n.UNSELECTED)},_eventProxy=function(e){var t=e.target,n=data.getSetting(e.data.treeId),r="",i=null,s="",o="",u=null,a=null,f=null;tools.eqs(e.type,"mousedown")?o="mousedown":tools.eqs(e.type,"mouseup")?o="mouseup":tools.eqs(e.type,"contextmenu")?o="contextmenu":tools.eqs(e.type,"click")?tools.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+consts.id.SWITCH)!==null?(r=tools.getNodeMainDom(t).id,s="switchNode"):(f=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),f&&(r=tools.getNodeMainDom(f).id,s="clickNode")):tools.eqs(e.type,"dblclick")&&(o="dblclick",f=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),f&&(r=tools.getNodeMainDom(f).id,s="switchNode")),o.length>0&&r.length==0&&(f=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),f&&(r=tools.getNodeMainDom(f).id));if(r.length>0){i=data.getNodeCache(n,r);switch(s){case"switchNode":i.isParent?tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(n.view.dblClickExpand,[n.treeId,i],n.view.dblClickExpand)?u=handler.onSwitchNode:s="":s="";break;case"clickNode":u=handler.onClickNode}}switch(o){case"mousedown":a=handler.onZTreeMousedown;break;case"mouseup":a=handler.onZTreeMouseup;break;case"dblclick":a=handler.onZTreeDblclick;break;case"contextmenu":a=handler.onZTreeContextmenu}var l={stop:!1,node:i,nodeEventType:s,nodeEventCallback:u,treeEventType:o,treeEventCallback:a};return l},_initNode=function(e,t,n,r,i,s,o){if(!n)return;var u=data.getRoot(e),a=e.data.key.children;n.level=t,n.tId=e.treeId+"_"+ ++u.zId,n.parentTId=r?r.tId:null,n.open=typeof n.open=="string"?tools.eqs(n.open,"true"):!!n.open,n[a]&&n[a].length>0?(n.isParent=!0,n.zAsync=!0):(n.isParent=typeof n.isParent=="string"?tools.eqs(n.isParent,"true"):!!n.isParent,n.open=n.isParent&&!e.async.enable?n.open:!1,n.zAsync=!n.isParent),n.isFirstNode=i,n.isLastNode=s,n.getParentNode=function(){return data.getNodeCache(e,n.parentTId)},n.getPreNode=function(){return data.getPreNode(e,n)},n.getNextNode=function(){return data.getNextNode(e,n)},n.getIndex=function(){return data.getNodeIndex(e,n)},n.getPath=function(){return data.getNodePath(e,n)},n.isAjaxing=!1,data.fixPIdKeyValue(e,n)},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e,t){t?_init.proxys.splice(0,0,e):_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,n,r){var i=e.data.key.children,s;t[i]?n>=t[i].length&&(n=-1):(t[i]=[],n=-1),t[i].length>0&&n===0?(t[i][0].isFirstNode=!1,view.setNodeLineIcos(e,t[i][0])):t[i].length>0&&n<0&&(t[i][t[i].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[i][t[i].length-1])),t.isParent=!0,n<0?t[i]=t[i].concat(r):(s=[n,0].concat(r),t[i].splice.apply(t[i],s))},addSelectedNode:function(e,t){var n=data.getRoot(e);data.isSelectedNode(e,t)||n.curSelectedList.push(t)},addCreatedNode:function(e,t){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom){var n=data.getRoot(e);n.createdNodes.push(t)}},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,n){for(var r=0,i=_init.afterA.length;r<i;r++)_init.afterA[r].apply(this,arguments)},getBeforeA:function(e,t,n){for(var r=0,i=_init.beforeA.length;r<i;r++)_init.beforeA[r].apply(this,arguments)},getInnerAfterA:function(e,t,n){for(var r=0,i=_init.innerAfterA.length;r<i;r++)_init.innerAfterA[r].apply(this,arguments)},getInnerBeforeA:function(e,t,n){for(var r=0,i=_init.innerBeforeA.length;r<i;r++)_init.innerBeforeA[r].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNodeIndex:function(e,t){if(!t)return null;var n=e.data.key.children,r=t.parentTId?t.getParentNode():data.getRoot(e);for(var i=0,s=r[n].length-1;i<=s;i++)if(r[n][i]===t)return i;return-1},getNextNode:function(e,t){if(!t)return null;var n=e.data.key.children,r=t.parentTId?t.getParentNode():data.getRoot(e);for(var i=0,s=r[n].length-1;i<=s;i++)if(r[n][i]===t)return i==s?null:r[n][i+1];return null},getNodeByParam:function(e,t,n,r){if(!t||!n)return null;var i=e.data.key.children;for(var s=0,o=t.length;s<o;s++){if(t[s][n]==r)return t[s];var u=data.getNodeByParam(e,t[s][i],n,r);if(u)return u}return null},getNodeCache:function(e,t){if(!t)return null;var n=caches[e.treeId].nodes[data.getNodeCacheId(t)];return n?n:null},getNodeName:function(e,t){var n=e.data.key.name;return""+t[n]},getNodePath:function(e,t){if(!t)return null;var n;return t.parentTId?n=t.getParentNode().getPath():n=[],n&&n.push(t),n},getNodeTitle:function(e,t){var n=e.data.key.title===""?e.data.key.name:e.data.key.title;return""+t[n]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,n,r){if(!t||!n)return[];var i=e.data.key.children,s=[];for(var o=0,u=t.length;o<u;o++)t[o][n]==r&&s.push(t[o]),s=s.concat(data.getNodesByParam(e,t[o][i],n,r));return s},getNodesByParamFuzzy:function(e,t,n,r){if(!t||!n)return[];var i=e.data.key.children,s=[];r=r.toLowerCase();for(var o=0,u=t.length;o<u;o++)typeof t[o][n]=="string"&&t[o][n].toLowerCase().indexOf(r)>-1&&s.push(t[o]),s=s.concat(data.getNodesByParamFuzzy(e,t[o][i],n,r));return s},getNodesByFilter:function(e,t,n,r,i){if(!t)return r?null:[];var s=e.data.key.children,o=r?null:[];for(var u=0,a=t.length;u<a;u++){if(tools.apply(n,[t[u],i],!1)){if(r)return t[u];o.push(t[u])}var f=data.getNodesByFilter(e,t[u][s],n,r,i);if(r&&!!f)return f;o=r?f:o.concat(f)}return o},getPreNode:function(e,t){if(!t)return null;var n=e.data.key.children,r=t.parentTId?t.getParentNode():data.getRoot(e);for(var i=0,s=r[n].length;i<s;i++)if(r[n][i]===t)return i==0?null:r[n][i-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getRoots:function(){return roots},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,n=_init.caches.length;t<n;t++)_init.caches[t].apply(this,arguments)},initNode:function(e,t,n,r,i,s){for(var o=0,u=_init.nodes.length;o<u;o++)_init.nodes[o].apply(this,arguments)},initRoot:function(e){for(var t=0,n=_init.roots.length;t<n;t++)_init.roots[t].apply(this,arguments)},isSelectedNode:function(e,t){var n=data.getRoot(e);for(var r=0,i=n.curSelectedList.length;r<i;r++)if(t===n.curSelectedList[r])return!0;return!1},removeNodeCache:function(e,t){var n=e.data.key.children;if(t[n])for(var r=0,i=t[n].length;r<i;r++)arguments.callee(e,t[n][r]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){var n=data.getRoot(e);for(var r=0,i=n.curSelectedList.length;r<i;r++)if(t===n.curSelectedList[r]||!data.getNodeCache(e,n.curSelectedList[r].tId))n.curSelectedList.splice(r,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,t]),r--,i--},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var n=0,r=_init.zTreeTools.length;n<r;n++)_init.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var n=e.data.key.children,r=[];if(tools.isArray(t))for(var i=0,s=t.length;i<s;i++)r.push(t[i]),t[i][n]&&(r=r.concat(data.transformToArrayFormat(e,t[i][n])));else r.push(t),t[n]&&(r=r.concat(data.transformToArrayFormat(e,t[n])));return r},transformTozTreeFormat:function(e,t){var n,r,i=e.data.simpleData.idKey,s=e.data.simpleData.pIdKey,o=e.data.key.children;if(!i||i==""||!t)return[];if(tools.isArray(t)){var u=[],a=[];for(n=0,r=t.length;n<r;n++)a[t[n][i]]=t[n];for(n=0,r=t.length;n<r;n++)a[t[n][s]]&&t[n][i]!=t[n][s]?(a[t[n][s]][o]||(a[t[n][s]][o]=[]),a[t[n][s]][o].push(t[n])):u.push(t[n]);return u}return[t]}},event={bindEvent:function(e){for(var t=0,n=_init.bind.length;t<n;t++)_init.bind[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,n=_init.unbind.length;t<n;t++)_init.unbind[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},n=e.treeObj;e.view.txtSelectedEnable||n.bind("selectstart",handler.onSelectStart).css({"-moz-user-select":"-moz-none"}),n.bind("click",t,event.proxy),n.bind("dblclick",t,event.proxy),n.bind("mouseover",t,event.proxy),n.bind("mouseout",t,event.proxy),n.bind("mousedown",t,event.proxy),n.bind("mouseup",t,event.proxy),n.bind("contextmenu",t,event.proxy)},unbindTree:function(e){var t=e.treeObj;t.unbind("selectstart",handler.onSelectStart).unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){var t=[];for(var n=0,r=_init.proxys.length;n<r;n++){var i=_init.proxys[n].apply(this,arguments);t.push(i);if(i.stop)break}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;var n=event.doProxy(e),r=!0,i=!1;for(var s=0,o=n.length;s<o;s++){var u=n[s];u.nodeEventCallback&&(i=!0,r=u.nodeEventCallback.apply(u,[e,u.node])&&r),u.treeEventCallback&&(i=!0,r=u.treeEventCallback.apply(u,[e,u.node])&&r)}return r}},handler={onSwitchNode:function(e,t){var n=data.getSetting(e.data.treeId);if(t.open){if(tools.apply(n.callback.beforeCollapse,[n.treeId,t],true)==0)return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}else{if(tools.apply(n.callback.beforeExpand,[n.treeId,t],true)==0)return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}return!0},onClickNode:function(e,t){var n=data.getSetting(e.data.treeId),r=n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&data.isSelectedNode(n,t)?0:n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&n.view.selectedMulti?2:1;return tools.apply(n.callback.beforeClick,[n.treeId,t,r],true)==0?!0:(r===0?view.cancelPreSelectedNode(n,t):view.selectNode(n,t,r===2),n.treeObj.trigger(consts.event.CLICK,[e,n.treeId,t,r]),!0)},onZTreeMousedown:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseDown,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseDown,[e,n.treeId,t]),!0},onZTreeMouseup:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseUp,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseUp,[e,n.treeId,t]),!0},onZTreeDblclick:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeDblClick,[n.treeId,t],!0)&&tools.apply(n.callback.onDblClick,[e,n.treeId,t]),!0},onZTreeContextmenu:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeRightClick,[n.treeId,t],!0)&&tools.apply(n.callback.onRightClick,[e,n.treeId,t]),typeof n.callback.onRightClick!="function"},onSelectStart:function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return t==="input"||t==="textarea"}},tools={apply:function(e,t,n){return typeof e=="function"?e.apply(zt,t?t:[]):n},canAsync:function(e,t){var n=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[n]&&t[n].length>0)},clone:function(e){if(e===null)return null;var t=tools.isArray(e)?[]:{};for(var n in e)t[n]=e[n]instanceof Date?new Date(e[n].getTime()):typeof e[n]=="object"?arguments.callee(e[n]):e[n];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return Object.prototype.toString.apply(e)==="[object Array]"},$:function(e,t,n){return!!t&&typeof t!="string"&&(n=t,t=""),typeof e=="string"?$(e,n?n.treeObj.get(0).ownerDocument:null):$("#"+e.tId+t,n?n.treeObj:null)},getMDom:function(e,t,n){if(!t)return null;while(t&&t.id!==e.treeId){for(var r=0,i=n.length;t.tagName&&r<i;r++)if(tools.eqs(t.tagName,n[r].tagName)&&t.getAttribute(n[r].attrName)!==null)return t;t=t.parentNode}return null},getNodeMainDom:function(e){return $(e).parent("li").get(0)||$(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return $(e).closest("#"+t).length>0},uCanDo:function(e,t){return!0}},view={addNodes:function(e,t,n,r,i){if(e.data.keep.leaf&&t&&!t.isParent)return;tools.isArray(r)||(r=[r]),e.data.simpleData.enable&&(r=data.transformTozTreeFormat(e,r));if(t){var s=$$(t,consts.id.SWITCH,e),o=$$(t,consts.id.ICON,e),u=$$(t,consts.id.UL,e);t.open||(view.replaceSwitchClass(t,s,consts.folder.CLOSE),view.replaceIcoClass(t,o,consts.folder.CLOSE),t.open=!1,u.css({display:"none"})),data.addNodesData(e,t,n,r),view.createNodes(e,t.level+1,r,t,n),i||view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),n,r),view.createNodes(e,0,r,null,n)},appendNodes:function(e,t,n,r,i,s,o){if(!n)return[];var u=[],a=e.data.key.children,f=r?r:data.getRoot(e),l=f[a],c,h;if(!l||i>=l.length)i=-1;for(var p=0,d=n.length;p<d;p++){var v=n[p];s&&(c=(i===0||l.length==n.length)&&p==0,h=i<0&&p==n.length-1,data.initNode(e,t,v,r,c,h,o),data.addNodeCache(e,v));var m=[];v[a]&&v[a].length>0&&(m=view.appendNodes(e,t+1,v[a],v,-1,s,o&&v.open)),o&&(view.makeDOMNodeMainBefore(u,e,v),view.makeDOMNodeLine(u,e,v),data.getBeforeA(e,v,u),view.makeDOMNodeNameBefore(u,e,v),data.getInnerBeforeA(e,v,u),view.makeDOMNodeIcon(u,e,v),data.getInnerAfterA(e,v,u),view.makeDOMNodeNameAfter(u,e,v),data.getAfterA(e,v,u),v.isParent&&v.open&&view.makeUlHtml(e,v,u,m.join("")),view.makeDOMNodeMainAfter(u,e,v),data.addCreatedNode(e,v))}return u},appendParentULDom:function(e,t){var n=[],r=$$(t,e);!r.get(0)&&!!t.parentTId&&(view.appendParentULDom(e,t.getParentNode()),r=$$(t,e));var i=$$(t,consts.id.UL,e);i.get(0)&&i.remove();var s=e.data.key.children,o=view.appendNodes(e,t.level+1,t[s],t,-1,!1,!0);view.makeUlHtml(e,t,n,o.join("")),r.append(n.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(tools.apply(setting.callback.beforeAsync,[setting.treeId,node],true)==0)return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&i<l;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}for(i=0,l=setting.async.deptParam.length;node&&i<l;i++){var pKey=setting.async.deptParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),spKey=="deptId"?tmpParam.deptIds=[node[pKey]]:tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;i<l;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return _.isEmpty(tmpParam)?!1:($.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:JSON.stringify(tmpParam),dataType:setting.async.dataType,success:function(msg){if(_tmpV!=data.getRoot(setting)._ver)return;var newNodes=[];try{!msg||msg.length==0?newNodes=[]:typeof msg=="string"?newNodes=eval("("+msg+")"):newNodes=msg}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&newNodes!==""?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,-1,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,-1,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)},error:function(e,t,n){if(_tmpV!=data.getRoot(setting)._ver)return;node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,n])}}),!0)},cancelPreSelectedNode:function(e,t,n){var r=data.getRoot(e).curSelectedList,i,s;for(i=r.length-1;i>=0;i--){s=r[i];if(t===s||!t&&(!n||n!==s)){$$(s,consts.id.A,e).removeClass(consts.node.CURSELECTED);if(t){data.removeSelectedNode(e,t);break}r.splice(i,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,s])}}},createNodeCallback:function(e){if(!!e.callback.onNodeCreated||!!e.view.addDiyDom){var t=data.getRoot(e);while(t.createdNodes.length>0){var n=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,n]),!e.callback.onNodeCreated||e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,n])}}},createNodes:function(e,t,n,r,i){if(!n||n.length==0)return;var s=data.getRoot(e),o=e.data.key.children,u=!r||r.open||!!$$(r[o][0],e).get(0);s.createdNodes=[];var a=view.appendNodes(e,t,n,r,i,!0,u),f,l;if(!r)f=e.treeObj;else{var c=$$(r,consts.id.UL,e);c.get(0)&&(f=c)}f&&(i>=0&&(l=f.children()[i]),i>=0&&l?$(l).before(a.join("")):f.append(a.join(""))),view.createNodeCallback(e)},destroy:function(e){if(!e)return;data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty(),delete settings[e.treeId]},expandCollapseNode:function(e,t,n,r,i){var s=data.getRoot(e),o=e.data.key.children;if(!t){tools.apply(i,[]);return}if(s.expandTriggerFlag){var u=i;i=function(){u&&u(),t.open?e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},s.expandTriggerFlag=!1}!t.open&&t.isParent&&(!$$(t,consts.id.UL,e).get(0)||t[o]&&t[o].length>0&&!$$(t[o][0],e).get(0))&&(view.appendParentULDom(e,t),view.createNodeCallback(e));if(t.open==n){tools.apply(i,[]);return}var a=$$(t,consts.id.UL,e),f=$$(t,consts.id.SWITCH,e),l=$$(t,consts.id.ICON,e);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&l.attr("style",view.makeNodeIcoStyle(e,t)),t.open?(view.replaceSwitchClass(t,f,consts.folder.OPEN),view.replaceIcoClass(t,l,consts.folder.OPEN),r==0||e.view.expandSpeed==""?(a.show(),tools.apply(i,[])):t[o]&&t[o].length>0?a.slideDown(e.view.expandSpeed,i):(a.show(),tools.apply(i,[]))):(view.replaceSwitchClass(t,f,consts.folder.CLOSE),view.replaceIcoClass(t,l,consts.folder.CLOSE),r==0||e.view.expandSpeed==""||!(t[o]&&t[o].length>0)?(a.hide(),tools.apply(i,[])):a.slideUp(e.view.expandSpeed,i))):tools.apply(i,[])},expandCollapseParentNode:function(e,t,n,r,i){if(!t)return;if(!t.parentTId){view.expandCollapseNode(e,t,n,r,i);return}view.expandCollapseNode(e,t,n,r),t.parentTId&&view.expandCollapseParentNode(e,t.getParentNode(),n,r,i)},expandCollapseSonNode:function(e,t,n,r,i){var s=data.getRoot(e),o=e.data.key.children,u=t?t[o]:s[o],a=t?!1:r,f=data.getRoot(e).expandTriggerFlag;data.getRoot(e).expandTriggerFlag=!1;if(u)for(var l=0,c=u.length;l<c;l++)u[l]&&view.expandCollapseSonNode(e,u[l],n,a);data.getRoot(e).expandTriggerFlag=f,view.expandCollapseNode(e,t,n,r,i)},isSelectedNode:function(e,t){if(!t)return!1;var n=data.getRoot(e).curSelectedList,r;for(r=n.length-1;r>=0;r--)if(t===n[r])return!0;return!1},makeDOMNodeIcon:function(e,t,n){var r=data.getNodeName(t,n),i=t.view.nameIsHTML?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",n.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,n),"' style='",view.makeNodeIcoStyle(t,n),"'></span><span id='",n.tId,consts.id.SPAN,"' class='",consts.className.NAME,"'>",i,"</span>")},makeDOMNodeLine:function(e,t,n){e.push("<span id='",n.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,n),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,n){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,n){e.push("<li id='",n.tId,"' class='",consts.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,n){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,n){var r=data.getNodeTitle(t,n),i=view.makeNodeUrl(t,n),s=view.makeNodeFontCss(t,n),o=[];for(var u in s)o.push(u,":",s[u],";");e.push("<a id='",n.tId,consts.id.A,"' class='",consts.className.LEVEL,n.level,"' treeNode",consts.id.A,' onclick="',n.click||"",'" ',i!=null&&i.length>0?"href='"+i+"'":""," target='",view.makeNodeTarget(n),"' style='",o.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&r&&e.push("title='",r.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var n=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return n&&typeof n!="function"?n:{}},makeNodeIcoClass:function(e,t){var n=["ico"];return t.isAjaxing||(n[0]=(t.iconSkin?t.iconSkin+"_":"")+n[0],t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU)),consts.className.BUTTON+" "+n.join("_")},makeNodeIcoStyle:function(e,t){var n=[];if(!t.isAjaxing){var r=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t[e.data.key.icon];r&&n.push("background:url(",r,") 0 0 no-repeat;"),(e.view.showIcon==0||!tools.apply(e.view.showIcon,[e.treeId,t],!0))&&n.push("width:0px;height:0px;")}return n.join("")},makeNodeLineClass:function(e,t){var n=[];return e.view.showLine?t.level==0&&t.isFirstNode&&t.isLastNode?n.push(consts.line.ROOT):t.level==0&&t.isFirstNode?n.push(consts.line.ROOTS):t.isLastNode?n.push(consts.line.BOTTOM):n.push(consts.line.CENTER):n.push(consts.line.NOLINE),t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+n.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var n=e.data.key.url;return t[n]?t[n]:null},makeUlHtml:function(e,t,n,r){n.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),n.push(r),n.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(!t)return;var n=e.data.key.children,r=t[n];if(!r)return;for(var i=0,s=r.length;i<s;i++)data.removeNodeCache(e,r[i]);data.removeSelectedNode(e),delete t[n];if(!e.data.keep.parent){t.isParent=!1,t.open=!1;var o=$$(t,consts.id.SWITCH,e),u=$$(t,consts.id.ICON,e);view.replaceSwitchClass(t,o,consts.folder.DOCU),view.replaceIcoClass(t,u,consts.folder.DOCU),$$(t,consts.id.UL,e).remove()}else $$(t,consts.id.UL,e).empty()},setFirstNode:function(e,t){var n=e.data.key.children,r=t[n].length;r>0&&(t[n][0].isFirstNode=!0)},setLastNode:function(e,t){var n=e.data.key.children,r=t[n].length;r>0&&(t[n][r-1].isLastNode=!0)},removeNode:function(e,t){var n=data.getRoot(e),r=e.data.key.children,i=t.parentTId?t.getParentNode():n;t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null};if(!data.getNodeCache(e,t.tId))return;$$(t,e).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var s=0,o=i[r].length;s<o;s++)if(i[r][s].tId==t.tId){i[r].splice(s,1);break}view.setFirstNode(e,i),view.setLastNode(e,i);var u,a,f,l=i[r].length;if(!e.data.keep.parent&&l==0)i.isParent=!1,i.open=!1,u=$$(i,consts.id.UL,e),a=$$(i,consts.id.SWITCH,e),f=$$(i,consts.id.ICON,e),view.replaceSwitchClass(i,a,consts.folder.DOCU),view.replaceIcoClass(i,f,consts.folder.DOCU),u.css("display","none");else if(e.view.showLine&&l>0){var c=i[r][l-1];u=$$(c,consts.id.UL,e),a=$$(c,consts.id.SWITCH,e),f=$$(c,consts.id.ICON,e);if(i==n)if(i[r].length==1)view.replaceSwitchClass(c,a,consts.line.ROOT);else{var h=$$(i[r][0],consts.id.SWITCH,e);view.replaceSwitchClass(i[r][0],h,consts.line.ROOTS),view.replaceSwitchClass(c,a,consts.line.BOTTOM)}else view.replaceSwitchClass(c,a,consts.line.BOTTOM);u.removeClass(consts.line.LINE)}},replaceIcoClass:function(e,t,n){if(!t||e.isAjaxing)return;var r=t.attr("class");if(r==undefined)return;var i=r.split("_");switch(n){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:i[i.length-1]=n}t.attr("class",i.join("_"))},replaceSwitchClass:function(e,t,n){if(!t)return;var r=t.attr("class");if(r==undefined)return;var i=r.split("_");switch(n){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:i[0]=view.makeNodeLineClassEx(e)+n;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:i[1]=n}t.attr("class",i.join("_")),n!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")},selectNode:function(e,t,n){n||view.cancelPreSelectedNode(e,null,t),$$(t,consts.id.A,e).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t),e.treeObj.trigger(consts.event.SELECTED,[e.treeId,t])},setNodeFontCss:function(e,t){var n=$$(t,consts.id.A,e),r=view.makeNodeFontCss(e,t);r&&n.css(r)},setNodeLineIcos:function(e,t){if(!t)return;var n=$$(t,consts.id.SWITCH,e),r=$$(t,consts.id.UL,e),i=$$(t,consts.id.ICON,e),s=view.makeUlLineClass(e,t);s.length==0?r.removeClass(consts.line.LINE):r.addClass(s),n.attr("class",view.makeNodeLineClass(e,t)),t.isParent?n.removeAttr("disabled"):n.attr("disabled","disabled"),i.removeAttr("style"),i.attr("style",view.makeNodeIcoStyle(e,t)),i.attr("class",view.makeNodeIcoClass(e,t))},setNodeName:function(e,t){var n=data.getNodeTitle(e,t),r=$$(t,consts.id.SPAN,e);r.empty(),e.view.nameIsHTML?r.html(data.getNodeName(e,t)):r.text(data.getNodeName(e,t));if(tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)){var i=$$(t,consts.id.A,e);i.attr("title",n?n:"")}},setNodeTarget:function(e,t){var n=$$(t,consts.id.A,e);n.attr("target",view.makeNodeTarget(t))},setNodeUrl:function(e,t){var n=$$(t,consts.id.A,e),r=view.makeNodeUrl(e,t);r==null||r.length==0?n.removeAttr("href"):n.attr("href",r)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t)){view.expandCollapseNode(e,t,!t.open);return}}else t&&view.expandCollapseNode(e,t,!t.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t?t:null},destroy:function(e){if(!!e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,n){var r=tools.clone(_setting);$.extend(!0,r,t),r.treeId=e.attr("id"),r.treeObj=e,r.treeObj.empty(),settings[r.treeId]=r,typeof document.body.style.maxHeight=="undefined"&&(r.view.expandSpeed=""),data.initRoot(r);var i=data.getRoot(r),s=r.data.key.children;n=n?tools.clone(tools.isArray(n)?n:[n]):[],r.data.simpleData.enable?i[s]=data.transformTozTreeFormat(r,n):i[s]=n,data.initCache(r),event.unbindTree(r),event.bindTree(r),event.unbindEvent(r),event.bindEvent(r);var o={setting:r,addNodes:function(e,t,n,i){function u(){view.addNodes(r,e,t,o,i==1)}e||(e=null);if(e&&!e.isParent&&r.data.keep.leaf)return null;var s=parseInt(t,10);isNaN(s)?(i=!!n,n=t,t=-1):t=s;if(!n)return null;var o=tools.clone(tools.isArray(n)?n:[n]);return tools.canAsync(r,e)?view.asyncNode(r,e,i,u):u(),o},cancelSelectedNode:function(e){view.cancelPreSelectedNode(r,e)},destroy:function(){view.destroy(r)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(r,null,e,!0),e},expandNode:function(e,t,n,i,s){function o(){var t=$$(e,r).get(0);if(t&&i!==!1)if(t.scrollIntoView)t.scrollIntoView(!1);else try{t.focus().blur()}catch(n){}}return!e||!e.isParent?null:(t!==!0&&t!==!1&&(t=!e.open),s=!!s,s&&t&&tools.apply(r.callback.beforeExpand,[r.treeId,e],true)==0?null:s&&!t&&tools.apply(r.callback.beforeCollapse,[r.treeId,e],true)==0?null:(t&&e.parentTId&&view.expandCollapseParentNode(r,e.getParentNode(),t,!1),t===e.open&&!n?null:(data.getRoot(r).expandTriggerFlag=s,!tools.canAsync(r,e)&&n?view.expandCollapseSonNode(r,e,t,!0,o):(e.open=!t,view.switchNode(this.setting,e),o()),t)))},getNodes:function(){return data.getNodes(r)},getNodeByParam:function(e,t,n){return e?data.getNodeByParam(r,n?n[r.data.key.children]:data.getNodes(r),e,t):null},getNodeByTId:function(e){return data.getNodeCache(r,e)},getNodesByParam:function(e,t,n){return e?data.getNodesByParam(r,n?n[r.data.key.children]:data.getNodes(r),e,t):null},getNodesByParamFuzzy:function(e,t,n){return e?data.getNodesByParamFuzzy(r,n?n[r.data.key.children]:data.getNodes(r),e,t):null},getNodesByFilter:function(e,t,n,i){return t=!!t,!e||typeof e!="function"?t?null:[]:data.getNodesByFilter(r,n?n[r.data.key.children]:data.getNodes(r),e,t,i)},getNodeIndex:function(e){if(!e)return null;var t=r.data.key.children,n=e.parentTId?e.getParentNode():data.getRoot(r);for(var i=0,s=n[t].length;i<s;i++)if(n[t][i]==e)return i;return-1},getSelectedNodes:function(){var e=[],t=data.getRoot(r).curSelectedList;for(var n=0,i=t.length;n<i;n++)e.push(t[n]);return e},isSelectedNode:function(e){return data.isSelectedNode(r,e)},reAsyncChildNodes:function(e,t,n){if(!this.setting.async.enable)return;var i=!e;i&&(e=data.getRoot(r));if(t=="refresh"){var s=this.setting.data.key.children;for(var o=0,u=e[s]?e[s].length:0;o<u;o++)data.removeNodeCache(r,e[s][o]);data.removeSelectedNode(r),e[s]=[];if(i)this.setting.treeObj.empty();else{var a=$$(e,consts.id.UL,r);a.empty()}}view.asyncNode(this.setting,i?null:e,!!n)},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(r),t=e[r.data.key.children];data.initRoot(r),e[r.data.key.children]=t,data.initCache(r),view.createNodes(r,0,e[r.data.key.children],null,-1)},removeChildNodes:function(e){if(!e)return null;var t=r.data.key.children,n=e[t];return view.removeChildNodes(r,e),n?n:null},removeNode:function(e,t){if(!e)return;t=!!t;if(t&&tools.apply(r.callback.beforeRemove,[r.treeId,e],true)==0)return;view.removeNode(r,e),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[r.treeId,e])},selectNode:function(e,t){function i(){var t=$$(e,r).get(0);if(t)if(t.scrollIntoView)t.scrollIntoView(!1);else try{t.focus().blur()}catch(n){}}if(!e)return;if(tools.uCanDo(r)){t=r.view.selectedMulti&&t;if(e.parentTId)view.expandCollapseParentNode(r,e.getParentNode(),!0,!1,i);else try{$$(e,r).focus().blur()}catch(n){}view.selectNode(r,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(r,e)},transformToArray:function(e){return data.transformToArrayFormat(r,e)},updateNode:function(e,t){if(!e)return;var n=$$(e,r);n.get(0)&&tools.uCanDo(r)&&(view.setNodeName(r,e),view.setNodeTarget(r,e),view.setNodeUrl(r,e),view.setNodeLineIcos(r,e),view.setNodeFontCss(r,e))}};return i.treeTools=o,data.setZTreeTools(r,o),i[s]&&i[s].length>0?view.createNodes(r,0,i[s],null,-1):r.async.enable&&r.async.url&&r.async.url!==""&&view.asyncNode(r),o}};var zt=$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),define("zTree",["jquery"],function(){}),define("controls/DeptUserBox",["jquery","underscore","controls/Common","controls/Ajax","controls/Dialog","text!../../template/deptUserBox.html","i18n/"+global.language,"zTree"],function(e,t,n,r,i,s,o,u){var a=function(e){return this.opts=e,this.el=e.el,this.dataAPI=t.extend({},n.APIObj,{fnName:{searchUser:"user:searchUser",getDeptUsers:"user:getDeptUsers"}}),this.html=s,this.selected=[],this.selectedObj={},this.searchData=[],this.model={pageNo:1,deptPageSize:100,pageSize:10,deptId:0,deptIds:[0],searchPageNo:1},this.pageModel={},this.init(),this};return a.prototype={init:function(){this.render(),this.getTopDpt(this.opts.corpId),this.initEvents()},initEvents:function(){var t=this;e("#deptUserBox").off("click").on("click","#clear",function(){t.clear()}).on("click",".i-deletB",function(){t.deleteSelected(e(this))}).on("keyup",".addGInput",function(n){var r=e(this).val();r==""?(e(".deptUser-list").show(),e(".search-list").hide()):n.keyCode==13&&(t.model.searchPageNo=1,t.search())}).on("click","#boxBtn-search",function(){t.model.searchPageNo=1,t.search()}).on("click",".search-list ul li",function(){var n=e(this).data("index"),r=t.searchData[n];t.addSelected(r)}).on("click",".btn-more",function(){var n=e(this).data("corpid"),r=[e(this).data("deptid")];t.getUser({corpId:n,deptIds:r,pageNo:t.pageModel[r]+1}),e(this).text(o.common.loading)}).on("click",".btn-search-more",function(){t.model.searchPageNo+=1,t.search(),e(this).text(o.common.loading)})},render:function(){e(this.el).html(t.template(this.html)({Lang:o}))},addSelected:function(t){if(this.selectedObj[t.uid])return;this.selected.push(t),this.selectedObj[t.uid]=!0;var n=['<li data-uid="',t.uid,'" title="',t.name,t.email?" ("+t.email+")":"",'"><span>',t.name,'</span><a href="javascript:;"><i class="i-deletB"></i></a></li>'].join("");e(".addGListRs ul").append(n)},deleteSelected:function(e){var t=e.parents("li").index(),n=this.selected.splice(t,1)[0];this.selectedObj[n.uid]&&delete this.selectedObj[n.uid],e.parents("li").remove()},clear:function(){this.selectedObj={},this.selected=[],e(".addGListRs ul").html("")},getSelected:function(){return this.selected},search:function(){var t=e(".addGInput").val();if(t=="")return;var n=this,s={url:n.dataAPI.getUrlByFnName("searchUser")+"&page="+n.model.searchPageNo+"&pagesize="+n.model.pageSize+"&matchrule=like",data:{corpId:n.opts.corpId,userId:t,email:t},success:function(t){n.model.searchPageNo=t.pageNo;var r=Math.ceil(t.total/n.model.pageSize),i=e(".btn-search-more");t.pageNo>=r?i.hide():i.text(o.common.loadMore).show();var s=t.users;n.renderList(s)},error:function(){i.tips(o.common.searchFail)}};r.request(s)},renderList:function(n){var r=this;this.model.searchPageNo==1?this.searchData=n:this.searchData=this.searchData.concat(n);var i=e(".search-result");n.length==0?i.text(o.userManager.noResult):i.text(o.userManager.searchResult+"："),e(".search-list").show(),e(".deptUser-list").hide();var s=e(".search-list ul");this.model.searchPageNo==1&&s.html("");var u=[];t.each(n,function(e,t){u.push(["<li ",t==0?"":"",'data-index="',(r.model.searchPageNo-1)*r.model.pageSize+t,'"><div class="list-name" title="',e.name,'">',e.userId,'</div><div class="list-email">',e.email,"</div></li>"].join(""))}),s.append(u)},getTopDpt:function(t){var n=this,i={url:n.dataAPI.getUrlByFnName("getDeptUsers")+"&page=1&pagesize="+n.model.deptPageSize+"&type=subgrp",data:{corpId:t,deptIds:["0"]},success:function(e){var t=e.depts;n.initTree(t)},error:function(t){e(".deptLoad").html(o.common.loadFail)}};r.request(i)},getUser:function(t){var n=this;n.model.corpId=t.corpId,n.model.deptIds=t.deptIds;var i={url:n.dataAPI.getUrlByFnName("getDeptUsers")+"&page="+t.pageNo+"&pagesize="+n.model.pageSize+"&type="+(t.alluser?"alluser":"user"),data:t,success:function(r){var i=r.users;if(r.users.length==0)return;var s=Math.ceil(r.total/n.model.pageSize);n.pageModel[t.deptIds]=r.pageNo;var u=e.fn.zTree.getZTreeObj("deptUser-list"),a=u.getNodesByParam("deptId",t.deptIds[0],null),f=a[0];u.addNodes(f,i),r.pageNo==1&&t.treeNode&&e("#"+t.treeNode.tId).append('<a class="btn-more btn-more-'+t.deptIds[0]+'" data-deptid="'+t.deptIds[0]+'" data-corpid="'+t.corpId+'" href="javascript:;">'+o.common.loadMore+"</a>");var l=e(".btn-more-"+t.deptIds[0]);l.text(o.common.loadMore),r.pageNo>=s&&l.hide()},error:function(){}};r.request(i)},initTree:function(n){function s(t,n){var r=e("#"+n.tId);n.uid&&r.addClass("isUser");var i=15,s=e("#"+n.tId+"_switch"),o=e("#"+n.tId+"_ico");s.remove(),o.before(s);var u="<span style='display: inline-block;width:"+i*n.level+"px'></span>";s.before(u)}var r=this,i={view:{showLine:!1,showIcon:!1,selectedMulti:!1,dblClickExpand:!1,addDiyDom:s},data:{simpleData:{enable:!0,idKey:"deptId",pIdKey:"parentId",rootPid:0}},async:{type:"POST",enable:!0,url:r.dataAPI.getUrlByFnName("getDeptUsers")+"&type=subgrp",contentType:"text/plain; charset=UTF-8",deptParam:["corpId","deptId"],dataFilter:function(e,n,r){if(r&&r.code=="S_OK"&&r["var"])return t.map(r["var"].depts,function(e){return e.isParent=!e.leaf}),r["var"].depts}},callback:{onClick:function(e,t,n,i){var s=n.corpId,o=n.deptId;if(n.uid)r.addSelected(n);else if(n.leaf){if(r.pageModel[o]>=1)return;r.getUser({treeNode:n,corpId:s,deptIds:[o],pageNo:1})}else this.getZTreeObj(t).expandNode(n)}}};t.map(n,function(e){return e.isParent=!e.leaf}),e.fn.zTree.init(e("#deptUser-list"),i,n)}},a}),!function(){if(!window.CustomEvent&&document.createEventObject)return void (window.CustomEvent=function(e,t){if(!arguments.length)throw new Error("Not enough arguments");var n={type:e,bubbles:!1,cancelable:!1,detail:null},r=document.createEventObject();for(var i in n)r[i]=n[i];for(var i in t)r[i]=t[i];return r});try{new CustomEvent("test")}catch(e){var t=function(e,t){if(!arguments.length)throw new Error("Not enough arguments");var n={bubbles:!1,cancelable:!1,detail:null};for(var r in t)n[r]=t[r];var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),i};t.prototype=(window.CustomEvent||window.Event).prototype,window.CustomEvent=t}}(),function(){if(!document.addEventListener&&window.Element&&window.Event){var e="__events",t="__immediateStopped";Event.prototype.NONE=Event.NONE=0,Event.prototype.CAPTURING_PHASE=Event.CAPTURING_PHASE=1,Event.prototype.AT_TARGET=Event.AT_TARGET=2,Event.prototype.BUBBLING_PHASE=Event.BUBBLING_PHASE=3,Event.prototype.preventDefault=function(){this.cancelable!==!1&&(this.returnValue=!1)},Event.prototype.stopPropagation=function(){this.cancelBubble=!0},Event.prototype.stopImmediatePropagation=function(){this[t]=this.cancelBubble=!0};for(var n=function(e,t){return e.timeStamp=+(new Date),e.target||(e.target=e.srcElement||t),e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop,e.relatedTarget="mouseover"==e.type?e.fromElement:"mouseout"==e.type?e.toElement:null,e},r=function(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(i.useCapture==n&&i.listener==t)return r}return-1},i=function(e,t,n){e.currentTarget=n,"function"==typeof t?t.call(n,e):t.handleEvent(e)},s=function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t},o=function(n,r,s){n.eventPhase=s;for(var o=0;o<r.length;o++){for(var u=r[o],a=[],f=(u[e]||{})[n.type]||[],l=0;l<f.length;l++){var c=f[l];c.useCapture&&s==Event.BUBBLING_PHASE||(c.useCapture||s!=Event.CAPTURING_PHASE)&&a.push(c.listener)}for(l=0;l<a.length;)try{for(;l<a.length;){var h=a[l++];if(i(n,h,u),n[t])return!0}}catch(p){setTimeout(function(){throw p},0)}if(n.cancelBubble)return!0}return!1},u=function(e){n(e,this);var t=s(e.target);return t.length&&o(e,t,Event.CAPTURING_PHASE)?e.returnValue:o(e,[e.target],Event.AT_TARGET)?e.returnValue:t.length&&e.bubbles!==!1&&(t.reverse(),o(e,t,Event.BUBBLING_PHASE))?e.returnValue:(e.stopPropagation(),e.returnValue)},a={addEventListener:function(t,n,i){var s=this,o=(this[e]||{})[t]||[],a=o.length;if(!(r(o,n,i)>-1)){if(e in this)var f=this[e];else{var f={_handler:function(){u.apply(s,arguments)}};this[e]=f}t in f||(f[t]=[]),f[t].push({listener:n,useCapture:i}),a||this.attachEvent("on"+t,f._handler)}},removeEventListener:function(t,n,i){var s=(this[e]||{})[t]||[],o=r(s,n,i);-1!=o&&(s.splice(o,1),s.length||this.detachEvent("on"+t,this[e]._handler))},dispatchEvent:function(e){return e.returnValue=!0,u.call(this,e)}},f=[Element,window.constructor,document.constructor];f.length;){var l=f.pop();for(var c in a)l.prototype[c]=a[c]}}}(),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,r;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),s=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=0;s>r;){var o;r in i&&(o=i[r],e.call(n,o,r,i)),r++}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return-1;var s=+t||0;if(Math.abs(s)===1/0&&(s=0),s>=i)return-1;for(n=Math.max(s>=0?s:i-Math.abs(s),0);i>n;){if(n in r&&r[n]===e)return n;n++}return-1}),function(e){var t;if("object"==typeof exports){try{t=require("jquery")}catch(n){}module.exports=e(window,document,t)}else window.Dropkick=e(window,document,window.jQuery)}(function(e,t,n,r){var i,s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),o=e.parent!==e.self&&location.host===parent.location.host,u=-1!==navigator.appVersion.indexOf("MSIE"),a=function(n,r){var i,s;if(this===e)return new a(n,r);for("string"==typeof n&&"#"===n[0]&&(n=t.getElementById(n.substr(1))),i=0;i<a.uid;i++)if(s=a.cache[i],s instanceof a&&s.data.select===n)return c.extend(s.data.settings,r),s;return n?"SELECT"===n.nodeName?this.init(n,r):void 0:(console.error("You must pass a select to DropKick"),!1)},f=function(){},l={initialize:f,change:f,open:f,close:f,search:"strict",bubble:!0},c={hasClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return e&&n.test(e.className)},addClass:function(e,t){e&&!c.hasClass(e,t)&&(e.className+=" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e&&(e.className=e.className.replace(n," "))},toggleClass:function(e,t){var n=c.hasClass(e,t)?"remove":"add";c[n+"Class"](e,t)},extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)e[n]=t[n]}),e},offset:function(n){var r=n.getBoundingClientRect()||{top:0,left:0},i=t.documentElement,s=u?i.scrollTop:e.pageYOffset,o=u?i.scrollLeft:e.pageXOffset;return{top:r.top+s-i.clientTop,left:r.left+o-i.clientLeft}},position:function(e,t){for(var n={top:0,left:0};e&&e!==t;)n.top+=e.offsetTop,n.left+=e.offsetLeft,e=e.parentNode;return n},closest:function(e,t){for(;e;){if(e===t)return e;e=e.parentNode}return!1},create:function(e,n){var r,i=t.createElement(e);n||(n={});for(r in n)n.hasOwnProperty(r)&&("innerHTML"===r?i.innerHTML=n[r]:i.setAttribute(r,n[r]));return i},deferred:function(t){return function(){var n=arguments,r=this;e.setTimeout(function(){t.apply(r,n)},1)}}};return a.cache={},a.uid=0,a.prototype={add:function(e,n){var r,i,s;"string"==typeof e&&(r=e,e=t.createElement("option"),e.text=r),"OPTION"===e.nodeName&&(i=c.create("li",{"class":"dk-option","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:"dk"+this.data.cacheID+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(i,e.className),this.length+=1,e.disabled&&(c.addClass(i,"dk-option-disabled"),i.setAttribute("aria-disabled","true")),this.data.select.add(e,n),"number"==typeof n&&(n=this.item(n)),this.options.indexOf(n)>-1?n.parentNode.insertBefore(i,n):this.data.elem.lastChild.appendChild(i),i.addEventListener("mouseover",this),s=this.options.indexOf(n),this.options.splice(s,0,i),e.selected&&this.select(s))},item:function(e){return e=0>e?this.options.length+e:e,this.options[e]||null},remove:function(e){var t=this.item(e);t.parentNode.removeChild(t),this.options.splice(e,1),this.data.select.remove(e),this.select(this.data.select.selectedIndex),this.length-=1},init:function(e,n){var r,u=a.build(e,"dk"+a.uid);if(this.data={},this.data.select=e,this.data.elem=u.elem,this.data.settings=c.extend({},l,n),this.disabled=e.disabled,this.form=e.form,this.length=e.length,this.multiple=e.multiple,this.options=u.options.slice(0),this.selectedIndex=e.selectedIndex,this.selectedOptions=u.selected.slice(0),this.value=e.value,this.data.cacheID=a.uid,a.cache[this.data.cacheID]=this,this.data.settings.initialize.call(this),a.uid+=1,this._changeListener||(e.addEventListener("change",this),this._changeListener=!0),!s||this.data.settings.mobile){if(e.parentNode.insertBefore(this.data.elem,e),e.setAttribute("data-dkCacheId",this.data.cacheID),this.data.elem.addEventListener("click",this),this.data.elem.addEventListener("keydown",this),this.data.elem.addEventListener("keypress",this),this.form&&this.form.addEventListener("reset",this),!this.multiple)for(r=0;r<this.options.length;r++)this.options[r].addEventListener("mouseover",this);i||(t.addEventListener("click",a.onDocClick),o&&parent.document.addEventListener("click",a.onDocClick),i=!0)}return this},close:function(){var e,t=this.data.elem;if(!this.isOpen||this.multiple)return!1;for(e=0;e<this.options.length;e++)c.removeClass(this.options[e],"dk-option-highlight");t.lastChild.setAttribute("aria-expanded","false"),c.removeClass(t.lastChild,"dk-select-options-highlight"),c.removeClass(t,"dk-select-open-(up|down)"),this.isOpen=!1,this.data.settings.close.call(this)},open:c.deferred(function(){var n,r,i,s,o,a,f=this.data.elem,l=f.lastChild;return o=u?c.offset(f).top-t.documentElement.scrollTop:c.offset(f).top-e.scrollY,a=e.innerHeight-(o+f.offsetHeight),this.isOpen||this.multiple?!1:(l.style.display="block",n=l.offsetHeight,l.style.display="",r=o>n,i=a>n,s=r&&!i?"-up":"-down",this.isOpen=!0,c.addClass(f,"dk-select-open"+s),l.setAttribute("aria-expanded","true"),this._scrollTo(this.options.length-1),this._scrollTo(this.selectedIndex),void this.data.settings.open.call(this))}),disable:function(e,t){var n="dk-option-disabled";(0===arguments.length||"boolean"==typeof e)&&(t=e===r?!0:!1,e=this.data.elem,n="dk-select-disabled",this.disabled=t),t===r&&(t=!0),"number"==typeof e&&(e=this.item(e)),c[t?"addClass":"removeClass"](e,n)},select:function(e,t){var n,r,i,s,o=this.data.select;if("number"==typeof e&&(e=this.item(e)),"string"==typeof e)for(n=0;n<this.length;n++)this.options[n].getAttribute("data-value")===e&&(e=this.options[n]);return!e||"string"==typeof e||!t&&c.hasClass(e,"dk-option-disabled")?!1:c.hasClass(e,"dk-option")?(r=this.options.indexOf(e),i=o.options[r],this.multiple?(c.toggleClass(e,"dk-option-selected"),i.selected=!i.selected,c.hasClass(e,"dk-option-selected")?(e.setAttribute("aria-selected","true"),this.selectedOptions.push(e)):(e.setAttribute("aria-selected","false"),r=this.selectedOptions.indexOf(e),this.selectedOptions.splice(r,1))):(s=this.data.elem.firstChild,this.selectedOptions.length&&(c.removeClass(this.selectedOptions[0],"dk-option-selected"),this.selectedOptions[0].setAttribute("aria-selected","false")),c.addClass(e,"dk-option-selected"),e.setAttribute("aria-selected","true"),s.setAttribute("aria-activedescendant",e.id),s.className="dk-selected "+i.className,s.innerHTML=i.text,this.selectedOptions[0]=e,i.selected=!0),this.selectedIndex=o.selectedIndex,this.value=o.value,t||this.data.select.dispatchEvent(new CustomEvent("change",{bubbles:this.data.settings.bubble})),e):void 0},selectOne:function(e,t){return this.reset(!0),this._scrollTo(e),this.select(e,t)},search:function(e,t){var n,r,i,s,o,u,a,f,l=this.data.select.options,c=[];if(!e)return this.options;for(t=t?t.toLowerCase():"strict",t="fuzzy"===t?2:"partial"===t?1:0,f=new RegExp((t?"":"^")+e,"i"),n=0;n<l.length;n++)if(i=l[n].text.toLowerCase(),2==t){for(r=e.toLowerCase().split(""),s=o=u=a=0;o<i.length;)i[o]===r[s]?(u+=1+u,s++):u=0,a+=u,o++;s===r.length&&c.push({e:this.options[n],s:a,i:n})}else f.test(i)&&c.push(this.options[n]);return 2===t&&(c=c.sort(function(e,t){return t.s-e.s||e.i-t.i}).reduce(function(e,t){return e[e.length]=t.e,e},[])),c},focus:function(){this.disabled||(this.multiple?this.data.elem:this.data.elem.children[0]).focus()},reset:function(e){var t,n=this.data.select;for(this.selectedOptions.length=0,t=0;t<n.options.length;t++)n.options[t].selected=!1,c.removeClass(this.options[t],"dk-option-selected"),this.options[t].setAttribute("aria-selected","false"),!e&&n.options[t].defaultSelected&&this.select(t,!0);this.selectedOptions.length||this.multiple||this.select(0,!0)},refresh:function(){this.dispose().init(this.data.select,this.data.settings)},dispose:function(){return delete a.cache[this.data.cacheID],this.data.elem.parentNode.removeChild(this.data.elem),this.data.select.removeAttribute("data-dkCacheId"),this},handleEvent:function(e){if(!this.disabled)switch(e.type){case"click":this._delegate(e);break;case"keydown":this._keyHandler(e);break;case"keypress":this._searchOptions(e);break;case"mouseover":this._highlight(e);break;case"reset":this.reset();break;case"change":this.data.settings.change.call(this)}},_delegate:function(t){var n,r,i,s,o=t.target;if(c.hasClass(o,"dk-option-disabled"))return!1;if(this.multiple){if(c.hasClass(o,"dk-option"))if(n=e.getSelection(),"Range"===n.type&&n.collapseToStart(),t.shiftKey)if(i=this.options.indexOf(this.selectedOptions[0]),s=this.options.indexOf(this.selectedOptions[this.selectedOptions.length-1]),r=this.options.indexOf(o),r>i&&s>r&&(r=i),r>s&&s>i&&(s=i),this.reset(!0),s>r)for(;s+1>r;)this.select(r++);else for(;r>s-1;)this.select(r--);else t.ctrlKey||t.metaKey?this.select(o):(this.reset(!0),this.select(o))}else this[this.isOpen?"close":"open"](),c.hasClass(o,"dk-option")&&this.select(o)},_highlight:function(e){var t,n=e.target;if(!this.multiple){for(t=0;t<this.options.length;t++)c.removeClass(this.options[t],"dk-option-highlight");c.addClass(this.data.elem.lastChild,"dk-select-options-highlight"),c.addClass(n,"dk-option-highlight")}},_keyHandler:function(e){var t,n,r=this.selectedOptions,i=this.options,s=1,o={tab:9,enter:13,esc:27,space:32,up:38,down:40};switch(e.keyCode){case o.up:s=-1;case o.down:if(e.preventDefault(),t=r[r.length-1],c.hasClass(this.data.elem.lastChild,"dk-select-options-highlight"))for(c.removeClass(this.data.elem.lastChild,"dk-select-options-highlight"),n=0;n<i.length;n++)c.hasClass(i[n],"dk-option-highlight")&&(c.removeClass(i[n],"dk-option-highlight"),t=i[n]);s=i.indexOf(t)+s,s>i.length-1?s=i.length-1:0>s&&(s=0),this.data.select.options[s].disabled||(this.reset(!0),this.select(s),this._scrollTo(s));break;case o.space:if(!this.isOpen){e.preventDefault(),this.open();break};case o.tab:case o.enter:for(s=0;s<i.length;s++)c.hasClass(i[s],"dk-option-highlight")&&this.select(s);case o.esc:this.isOpen&&(e.preventDefault(),this.close())}},_searchOptions:function(e){var t,n=this,i=String.fromCharCode(e.keyCode||e.which),s=function(){n.data.searchTimeout&&clearTimeout(n.data.searchTimeout),n.data.searchTimeout=setTimeout(function(){n.data.searchString=""},1e3)};this.data.searchString===r&&(this.data.searchString=""),s(),this.data.searchString+=i,t=this.search(this.data.searchString,this.data.settings.search),t.length&&(c.hasClass(t[0],"dk-option-disabled")||this.selectOne(t[0]))},_scrollTo:function(e){var t,n,r,i=this.data.elem.lastChild;return-1===e||"number"!=typeof e&&!e||!this.isOpen&&!this.multiple?!1:("number"==typeof e&&(e=this.item(e)),t=c.position(e,i).top,n=t-i.scrollTop,r=n+e.offsetHeight,void (r>i.offsetHeight?(t+=e.offsetHeight,i.scrollTop=t-i.offsetHeight):0>n&&(i.scrollTop=t)))}},a.build=function(e,t){var n,r,i,s=[],o={elem:null,options:[],selected:[]},u=function(e){var n,r,i,s,a=[];switch(e.nodeName){case"OPTION":n=c.create("li",{"class":"dk-option ","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:t+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(n,e.className),e.disabled&&(c.addClass(n,"dk-option-disabled"),n.setAttribute("aria-disabled","true")),e.selected&&(c.addClass(n,"dk-option-selected"),n.setAttribute("aria-selected","true"),o.selected.push(n)),o.options.push(this.appendChild(n));break;case"OPTGROUP":for(r=c.create("li",{"class":"dk-optgroup"}),e.label&&r.appendChild(c.create("div",{"class":"dk-optgroup-label",innerHTML:e.label})),i=c.create("ul",{"class":"dk-optgroup-options"}),s=e.children.length;s--;a.unshift(e.children[s]));a.forEach(u,i),this.appendChild(r).appendChild(i)}};for(o.elem=c.create("div",{"class":"dk-select"+(e.multiple?"-multi":"")}),r=c.create("ul",{"class":"dk-select-options",id:t+"-listbox",role:"listbox"}),e.disabled&&c.addClass(o.elem,"dk-select-disabled"),o.elem.id=t+(e.id?"-"+e.id:""),c.addClass(o.elem,e.className),e.multiple?(o.elem.setAttribute("tabindex",e.getAttribute("tabindex")||"0"),r.setAttribute("aria-multiselectable","true")):(n=e.options[e.selectedIndex],o.elem.appendChild(c.create("div",{"class":"dk-selected "+n.className,tabindex:e.tabindex||0,innerHTML:n?n.text:"&nbsp;",id:t+"-combobox","aria-live":"assertive","aria-owns":r.id,role:"combobox"})),r.setAttribute("aria-expanded","false")),i=e.children.length;i--;s.unshift(e.children[i]));return s.forEach(u,o.elem.appendChild(r)),o},a.onDocClick=function(e){var t,n;if(1!==e.target.nodeType)return!1;null!==(t=e.target.getAttribute("data-dkcacheid"))&&a.cache[t].focus();for(n in a.cache)c.closest(e.target,a.cache[n].data.elem)||n===t||a.cache[n].disabled||a.cache[n].close()},n!==r&&(n.fn.dropkick=function(){var e=Array.prototype.slice.call(arguments);return n(this).each(function(){e[0]&&"object"!=typeof e[0]?"string"==typeof e[0]&&a.prototype[e[0]].apply(new a(this),e.slice(1)):new a(this,e[0]||{})})}),a}),define("dropkick",["jquery"],function(){}),function(e,t){typeof exports=="object"?module.exports=exports=t():typeof define=="function"&&define.amd?define("CryptoJS",[],t):e.CryptoJS=t()}(this,function(){var e=e||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=e.length*4},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;this.clamp();if(r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=o<<24-(r+s)%4*8}else for(var s=0;s<i;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){var n=[],r=function(t){var t=t,n=987654321,r=4294967295;return function(){n=36969*(n&65535)+(n>>16)&r,t=18e3*(t&65535)+(t>>16)&r;var i=(n<<16)+t&r;return i/=4294967296,i+=.5,i*(e.random()>.5?1:-1)}};for(var i=0,o;i<t;i+=4){var u=r((o||e.random())*4294967296);o=u()*987654071,n.push(u()*4294967296|0)}return new s.init(n,t)}}),o=n.enc={},u=o.Hex={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},a=o.Latin1={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-r%4*8;return new s.init(n,t)}},f=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,u=o*4,a=i/u;t?a=e.ceil(a):a=e.max((a|0)-this._minBufferSize,0);var f=a*o,l=e.min(f*4,i);if(f){for(var c=0;c<f;c+=o)this._doProcessBlock(r,c);var h=r.splice(0,f);n.sigBytes-=l}return new s.init(h,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),c=r.Hasher=l.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return(new e.init(n)).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return(new h.HMAC.init(e,n)).finalize(t)}}}),h=n.algo={};return n}(Math);return function(){var t=e,n=t.lib,r=n.WordArray,i=t.enc,s=i.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();var i=[];for(var s=0;s<n;s+=3){var o=t[s>>>2]>>>24-s%4*8&255,u=t[s+1>>>2]>>>24-(s+1)%4*8&255,a=t[s+2>>>2]>>>24-(s+2)%4*8&255,f=o<<16|u<<8|a;for(var l=0;l<4&&s+l*.75<n;l++)i.push(r.charAt(f>>>6*(3-l)&63))}var c=r.charAt(64);if(c)while(i.length%4)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=n.charAt(64);if(i){var s=e.indexOf(i);s!=-1&&(t=s)}var o=[],u=0;for(var a=0;a<t;a++)if(a%4){var f=n.indexOf(e.charAt(a-1))<<a%4*2,l=n.indexOf(e.charAt(a))>>>6-a%4*2,c=f|l;o[u>>>2]|=c<<24-u%4*8,u++}return r.create(o,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function f(e,t,n,r,i,s,o){var u=e+(t&n|~t&r)+i+o;return(u<<s|u>>>32-s)+t}function l(e,t,n,r,i,s,o){var u=e+(t&r|n&~r)+i+o;return(u<<s|u>>>32-s)+t}function c(e,t,n,r,i,s,o){var u=e+(t^n^r)+i+o;return(u<<s|u>>>32-s)+t}function h(e,t,n,r,i,s,o){var u=e+(n^(t|~r))+i+o;return(u<<s|u>>>32-s)+t}var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.algo,u=[];(function(){for(var e=0;e<64;e++)u[e]=t.abs(t.sin(e+1))*4294967296|0})();var a=o.MD5=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var s=this._hash.words,o=e[t+0],a=e[t+1],p=e[t+2],d=e[t+3],v=e[t+4],m=e[t+5],g=e[t+6],y=e[t+7],b=e[t+8],w=e[t+9],E=e[t+10],S=e[t+11],x=e[t+12],N=e[t+13],C=e[t+14],k=e[t+15],L=s[0],A=s[1],O=s[2],M=s[3];L=f(L,A,O,M,o,7,u[0]),M=f(M,L,A,O,a,12,u[1]),O=f(O,M,L,A,p,17,u[2]),A=f(A,O,M,L,d,22,u[3]),L=f(L,A,O,M,v,7,u[4]),M=f(M,L,A,O,m,12,u[5]),O=f(O,M,L,A,g,17,u[6]),A=f(A,O,M,L,y,22,u[7]),L=f(L,A,O,M,b,7,u[8]),M=f(M,L,A,O,w,12,u[9]),O=f(O,M,L,A,E,17,u[10]),A=f(A,O,M,L,S,22,u[11]),L=f(L,A,O,M,x,7,u[12]),M=f(M,L,A,O,N,12,u[13]),O=f(O,M,L,A,C,17,u[14]),A=f(A,O,M,L,k,22,u[15]),L=l(L,A,O,M,a,5,u[16]),M=l(M,L,A,O,g,9,u[17]),O=l(O,M,L,A,S,14,u[18]),A=l(A,O,M,L,o,20,u[19]),L=l(L,A,O,M,m,5,u[20]),M=l(M,L,A,O,E,9,u[21]),O=l(O,M,L,A,k,14,u[22]),A=l(A,O,M,L,v,20,u[23]),L=l(L,A,O,M,w,5,u[24]),M=l(M,L,A,O,C,9,u[25]),O=l(O,M,L,A,d,14,u[26]),A=l(A,O,M,L,b,20,u[27]),L=l(L,A,O,M,N,5,u[28]),M=l(M,L,A,O,p,9,u[29]),O=l(O,M,L,A,y,14,u[30]),A=l(A,O,M,L,x,20,u[31]),L=c(L,A,O,M,m,4,u[32]),M=c(M,L,A,O,b,11,u[33]),O=c(O,M,L,A,S,16,u[34]),A=c(A,O,M,L,C,23,u[35]),L=c(L,A,O,M,a,4,u[36]),M=c(M,L,A,O,v,11,u[37]),O=c(O,M,L,A,y,16,u[38]),A=c(A,O,M,L,E,23,u[39]),L=c(L,A,O,M,N,4,u[40]),M=c(M,L,A,O,o,11,u[41]),O=c(O,M,L,A,d,16,u[42]),A=c(A,O,M,L,g,23,u[43]),L=c(L,A,O,M,w,4,u[44]),M=c(M,L,A,O,x,11,u[45]),O=c(O,M,L,A,k,16,u[46]),A=c(A,O,M,L,p,23,u[47]),L=h(L,A,O,M,o,6,u[48]),M=h(M,L,A,O,y,10,u[49]),O=h(O,M,L,A,C,15,u[50]),A=h(A,O,M,L,m,21,u[51]),L=h(L,A,O,M,x,6,u[52]),M=h(M,L,A,O,d,10,u[53]),O=h(O,M,L,A,E,15,u[54]),A=h(A,O,M,L,a,21,u[55]),L=h(L,A,O,M,b,6,u[56]),M=h(M,L,A,O,k,10,u[57]),O=h(O,M,L,A,g,15,u[58]),A=h(A,O,M,L,N,21,u[59]),L=h(L,A,O,M,v,6,u[60]),M=h(M,L,A,O,S,10,u[61]),O=h(O,M,L,A,p,15,u[62]),A=h(A,O,M,L,w,21,u[63]),s[0]=s[0]+L|0,s[1]=s[1]+A|0,s[2]=s[2]+O|0,s[3]=s[3]+M|0},_doFinalize:function(){var e=this._data,n=e.words,r=this._nDataBytes*8,i=e.sigBytes*8;n[i>>>5]|=128<<24-i%32;var s=t.floor(r/4294967296),o=r;n[(i+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,n[(i+64>>>9<<4)+14]=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,e.sigBytes=(n.length+1)*4,this._process();var u=this._hash,a=u.words;for(var f=0;f<4;f++){var l=a[f];a[f]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}return u},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.MD5=s._createHelper(a),n.HmacMD5=s._createHmacHelper(a)}(Math),function(){var t=e,n=t.lib,r=n.WordArray,i=n.Hasher,s=t.algo,o=[],u=s.SHA1=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],s=n[2],u=n[3],a=n[4];for(var f=0;f<80;f++){if(f<16)o[f]=e[t+f]|0;else{var l=o[f-3]^o[f-8]^o[f-14]^o[f-16];o[f]=l<<1|l>>>31}var c=(r<<5|r>>>27)+a+o[f];f<20?c+=(i&s|~i&u)+1518500249:f<40?c+=(i^s^u)+1859775393:f<60?c+=(i&s|i&u|s&u)-1894007588:c+=(i^s^u)-899497514,a=u,u=s,s=i<<30|i>>>2,i=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+u|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=this._nDataBytes*8,r=e.sigBytes*8;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=t.length*4,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=i._createHelper(u),t.HmacSHA1=i._createHmacHelper(u)}(),function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.algo,u=[],a=[];(function(){function e(e){var n=t.sqrt(e);for(var r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return(e-(e|0))*4294967296|0}var r=2,i=0;while(i<64)e(r)&&(i<8&&(u[i]=n(t.pow(r,.5))),a[i]=n(t.pow(r,1/3)),i++),r++})();var f=[],l=o.SHA256=s.extend({_doReset:function(){this._hash=new i.init(u.slice(0))},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],l=n[5],c=n[6],h=n[7];for(var p=0;p<64;p++){if(p<16)f[p]=e[t+p]|0;else{var d=f[p-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,m=f[p-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;f[p]=v+f[p-7]+g+f[p-16]}var y=u&l^~u&c,b=r&i^r&s^i&s,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),E=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),S=h+E+y+a[p]+f[p],x=w+b;h=c,c=l,l=u,u=o+S|0,o=s,s=i,i=r,r=S+x|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+u|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,r=this._nDataBytes*8,i=e.sigBytes*8;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=t.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,e.sigBytes=n.length*4,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=s._createHelper(l),n.HmacSHA256=s._createHmacHelper(l)}(Math),function(){function o(e){return e<<8&4278255360|e>>>8&16711935}var t=e,n=t.lib,r=n.WordArray,i=t.enc,s=i.Utf16=i.Utf16BE={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i+=2){var s=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var i=0;i<t;i++)n[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return r.create(n,t*2)}};i.Utf16LE={stringify:function(e){var t=e.words,n=e.sigBytes,r=[];for(var i=0;i<n;i+=2){var s=o(t[i>>>2]>>>16-i%4*8&65535);r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){var t=e.length,n=[];for(var i=0;i<t;i++)n[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return r.create(n,t*2)}}}(),function(){if(typeof ArrayBuffer!="function")return;var t=e,n=t.lib,r=n.WordArray,i=r.init,s=r.init=function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));if(e instanceof Int8Array||typeof Uint8ClampedArray!="undefined"&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(e instanceof Uint8Array){var t=e.byteLength,n=[];for(var r=0;r<t;r++)n[r>>>2]|=e[r]<<24-r%4*8;i.call(this,n,t)}else i.apply(this,arguments)};s.prototype=r}(),function(t){function d(e,t,n){return e^t^n}function v(e,t,n){return e&t|~e&n}function m(e,t,n){return(e|~t)^n}function g(e,t,n){return e&n|t&~n}function y(e,t,n){return e^(t|~n)}function b(e,t){return e<<t|e>>>32-t}var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.algo,u=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),a=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),c=i.create([0,1518500249,1859775393,2400959708,2840853838]),h=i.create([1352829926,1548603684,1836072691,2053994217,0]),p=o.RIPEMD160=s.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var s=this._hash.words,o=c.words,p=h.words,w=u.words,E=a.words,S=f.words,x=l.words,T,N,C,k,L,A,O,M,_,D;A=T=s[0],O=N=s[1],M=C=s[2],_=k=s[3],D=L=s[4];var P;for(var n=0;n<80;n+=1)P=T+e[t+w[n]]|0,n<16?P+=d(N,C,k)+o[0]:n<32?P+=v(N,C,k)+o[1]:n<48?P+=m(N,C,k)+o[2]:n<64?P+=g(N,C,k)+o[3]:P+=y(N,C,k)+o[4],P|=0,P=b(P,S[n]),P=P+L|0,T=L,L=k,k=b(C,10),C=N,N=P,P=A+e[t+E[n]]|0,n<16?P+=y(O,M,_)+p[0]:n<32?P+=g(O,M,_)+p[1]:n<48?P+=m(O,M,_)+p[2]:n<64?P+=v(O,M,_)+p[3]:P+=d(O,M,_)+p[4],P|=0,P=b(P,x[n]),P=P+D|0,A=D,D=_,_=b(M,10),M=O,O=P;P=s[1]+C+_|0,s[1]=s[2]+k+D|0,s[2]=s[3]+L+A|0,s[3]=s[4]+T+O|0,s[4]=s[0]+N+M|0,s[0]=P},_doFinalize:function(){var e=this._data,t=e.words,n=this._nDataBytes*8,r=e.sigBytes*8;t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,e.sigBytes=(t.length+1)*4,this._process();var i=this._hash,s=i.words;for(var o=0;o<5;o++){var u=s[o];s[o]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360}return i},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.RIPEMD160=s._createHelper(p),n.HmacRIPEMD160=s._createHmacHelper(p)}(Math),function(){var t=e,n=t.lib,r=n.Base,i=t.enc,s=i.Utf8,o=t.algo,u=o.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,typeof t=="string"&&(t=s.parse(t));var n=e.blockSize,r=n*4;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();var i=this._oKey=t.clone(),o=this._iKey=t.clone(),u=i.words,a=o.words;for(var f=0;f<n;f++)u[f]^=1549556828,a[f]^=909522486;i.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);t.reset();var r=t.finalize(this._oKey.clone().concat(n));return r}})}(),function(){var t=e,n=t.lib,r=n.Base,i=n.WordArray,s=t.algo,o=s.SHA1,u=s.HMAC,a=s.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,r=u.create(n.hasher,e),s=i.create(),o=i.create([1]),a=s.words,f=o.words,l=n.keySize,c=n.iterations;while(a.length<l){var h=r.update(t).finalize(o);r.reset();var p=h.words,d=p.length,v=h;for(var m=1;m<c;m++){v=r.finalize(v),r.reset();var g=v.words;for(var y=0;y<d;y++)p[y]^=g[y]}s.concat(h),f[0]++}return s.sigBytes=l*4,s}});t.PBKDF2=function(e,t,n){return a.create(n).compute(e,t)}}(),function(){var t=e,n=t.lib,r=n.Base,i=n.WordArray,s=t.algo,o=s.MD5,u=s.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:o,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,r=n.hasher.create(),s=i.create(),o=s.words,u=n.keySize,a=n.iterations;while(o.length<u){f&&r.update(f);var f=r.update(e).finalize(t);r.reset();for(var l=1;l<a;l++)f=r.finalize(f),r.reset();s.concat(f)}return s.sigBytes=u*4,s}});t.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)}}(),function(){var t=e,n=t.lib,r=n.WordArray,i=t.algo,s=i.SHA256,o=i.SHA224=s.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=4,e}});t.SHA224=s._createHelper(o),t.HmacSHA224=s._createHmacHelper(o)}(),function(t){var n=e,r=n.lib,i=r.Base,s=r.WordArray,o=n.x64={},u=o.Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),a=o.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=e.length*8},toX32:function(){var e=this.words,t=e.length,n=[];for(var r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return s.create(n,this.sigBytes)},clone:function(){var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length;for(var r=0;r<n;r++)t[r]=t[r].clone();return e}})}(),function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,o=n.x64,u=o.Word,a=n.algo,f=[],l=[],c=[];(function(){var e=1,t=0;for(var n=0;n<24;n++){f[e+5*t]=(n+1)*(n+2)/2%64;var r=t%5,i=(2*e+3*t)%5;e=r,t=i}for(var e=0;e<5;e++)for(var t=0;t<5;t++)l[e+5*t]=t+(2*e+3*t)%5*5;var s=1;for(var o=0;o<24;o++){var a=0,h=0;for(var p=0;p<7;p++){if(s&1){var d=(1<<p)-1;d<32?h^=1<<d:a^=1<<d-32}s&128?s=s<<1^113:s<<=1}c[o]=u.create(a,h)}})();var h=[];(function(){for(var e=0;e<25;e++)h[e]=u.create()})();var p=a.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){var e=this._state=[];for(var t=0;t<25;t++)e[t]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){var n=this._state,r=this.blockSize/2;for(var i=0;i<r;i++){var s=e[t+2*i],o=e[t+2*i+1];s=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,o=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360;var u=n[i];u.high^=o,u.low^=s}for(var a=0;a<24;a++){for(var p=0;p<5;p++){var d=0,v=0;for(var m=0;m<5;m++){var u=n[p+5*m];d^=u.high,v^=u.low}var g=h[p];g.high=d,g.low=v}for(var p=0;p<5;p++){var y=h[(p+4)%5],b=h[(p+1)%5],w=b.high,E=b.low,d=y.high^(w<<1|E>>>31),v=y.low^(E<<1|w>>>31);for(var m=0;m<5;m++){var u=n[p+5*m];u.high^=d,u.low^=v}}for(var S=1;S<25;S++){var u=n[S],x=u.high,N=u.low,C=f[S];if(C<32)var d=x<<C|N>>>32-C,v=N<<C|x>>>32-C;else var d=N<<C-32|x>>>64-C,v=x<<C-32|N>>>64-C;var k=h[l[S]];k.high=d,k.low=v}var L=h[0],A=n[0];L.high=A.high,L.low=A.low;for(var p=0;p<5;p++)for(var m=0;m<5;m++){var S=p+5*m,u=n[S],O=h[S],M=h[(p+1)%5+5*m],_=h[(p+2)%5+5*m];u.high=O.high^~M.high&_.high,u.low=O.low^~M.low&_.low}var u=n[0],D=c[a];u.high^=D.high,u.low^=D.low}},_doFinalize:function(){var e=this._data,n=e.words,r=this._nDataBytes*8,s=e.sigBytes*8,o=this.blockSize*32;n[s>>>5]|=1<<24-s%32,n[(t.ceil((s+1)/o)*o>>>5)-1]|=128,e.sigBytes=n.length*4,this._process();var u=this._state,a=this.cfg.outputLength/8,f=a/8,l=[];for(var c=0;c<f;c++){var h=u[c],p=h.high,d=h.low;p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,d=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,l.push(d),l.push(p)}return new i.init(l,a)},clone:function(){var e=s.clone.call(this),t=e._state=this._state.slice(0);for(var n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=s._createHelper(p),n.HmacSHA3=s._createHmacHelper(p)}(Math),function(){function a(){return s.create.apply(s,arguments)}var t=e,n=t.lib,r=n.Hasher,i=t.x64,s=i.Word,o=i.WordArray,u=t.algo,f=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],l=[];(function(){for(var e=0;e<80;e++)l[e]=a()})();var c=u.SHA512=r.extend({_doReset:function(){this._hash=new o.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(e,t){var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],a=n[5],c=n[6],h=n[7],p=r.high,d=r.low,v=i.high,m=i.low,g=s.high,y=s.low,b=o.high,w=o.low,E=u.high,S=u.low,x=a.high,T=a.low,N=c.high,C=c.low,k=h.high,L=h.low,A=p,O=d,M=v,_=m,D=g,P=y,H=b,B=w,j=E,F=S,I=x,q=T,R=N,U=C,z=k,X=L;for(var V=0;V<80;V++){var $=l[V];if(V<16)var J=$.high=e[t+V*2]|0,Q=$.low=e[t+V*2+1]|0;else{var G=l[V-15],Y=G.high,Z=G.low,et=(Y>>>1|Z<<31)^(Y>>>8|Z<<24)^Y>>>7,tt=(Z>>>1|Y<<31)^(Z>>>8|Y<<24)^(Z>>>7|Y<<25),nt=l[V-2],rt=nt.high,it=nt.low,st=(rt>>>19|it<<13)^(rt<<3|it>>>29)^rt>>>6,ot=(it>>>19|rt<<13)^(it<<3|rt>>>29)^(it>>>6|rt<<26),ut=l[V-7],at=ut.high,ft=ut.low,lt=l[V-16],ct=lt.high,ht=lt.low,Q=tt+ft,J=et+at+(Q>>>0<tt>>>0?1:0),Q=Q+ot,J=J+st+(Q>>>0<ot>>>0?1:0),Q=Q+ht,J=J+ct+(Q>>>0<ht>>>0?1:0);$.high=J,$.low=Q}var pt=j&I^~j&R,dt=F&q^~F&U,vt=A&M^A&D^M&D,mt=O&_^O&P^_&P,gt=(A>>>28|O<<4)^(A<<30|O>>>2)^(A<<25|O>>>7),yt=(O>>>28|A<<4)^(O<<30|A>>>2)^(O<<25|A>>>7),bt=(j>>>14|F<<18)^(j>>>18|F<<14)^(j<<23|F>>>9),wt=(F>>>14|j<<18)^(F>>>18|j<<14)^(F<<23|j>>>9),Et=f[V],St=Et.high,xt=Et.low,Tt=X+wt,Nt=z+bt+(Tt>>>0<X>>>0?1:0),Tt=Tt+dt,Nt=Nt+pt+(Tt>>>0<dt>>>0?1:0),Tt=Tt+xt,Nt=Nt+St+(Tt>>>0<xt>>>0?1:0),Tt=Tt+Q,Nt=Nt+J+(Tt>>>0<Q>>>0?1:0),Ct=yt+mt,kt=gt+vt+(Ct>>>0<yt>>>0?1:0);z=R,X=U,R=I,U=q,I=j,q=F,F=B+Tt|0,j=H+Nt+(F>>>0<B>>>0?1:0)|0,H=D,B=P,D=M,P=_,M=A,_=O,O=Tt+Ct|0,A=Nt+kt+(O>>>0<Tt>>>0?1:0)|0}d=r.low=d+O,r.high=p+A+(d>>>0<O>>>0?1:0),m=i.low=m+_,i.high=v+M+(m>>>0<_>>>0?1:0),y=s.low=y+P,s.high=g+D+(y>>>0<P>>>0?1:0),w=o.low=w+B,o.high=b+H+(w>>>0<B>>>0?1:0),S=u.low=S+F,u.high=E+j+(S>>>0<F>>>0?1:0),T=a.low=T+q,a.high=x+I+(T>>>0<q>>>0?1:0),C=c.low=C+U,c.high=N+R+(C>>>0<U>>>0?1:0),L=h.low=L+X,h.high=k+z+(L>>>0<X>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=this._nDataBytes*8,r=e.sigBytes*8;t[r>>>5]|=128<<24-r%32,t[(r+128>>>10<<5)+30]=Math.floor(n/4294967296),t[(r+128>>>10<<5)+31]=n,e.sigBytes=t.length*4,this._process();var i=this._hash.toX32();return i},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=r._createHelper(c),t.HmacSHA512=r._createHmacHelper(c)}(),function(){var t=e,n=t.x64,r=n.Word,i=n.WordArray,s=t.algo,o=s.SHA512,u=s.SHA384=o.extend({_doReset:function(){this._hash=new i.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=16,e}});t.SHA384=o._createHelper(u),t.HmacSHA384=o._createHmacHelper(u)}(),e.lib.Cipher||function(t){var n=e,r=n.lib,i=r.Base,s=r.WordArray,o=r.BufferedBlockAlgorithm,u=n.enc,a=u.Utf8,f=u.Base64,l=n.algo,c=l.EvpKDF,h=r.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return typeof e=="string"?C:x}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()}),p=r.StreamCipher=h.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),d=n.mode={},v=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=d.CBC=function(){function n(e,n,r){var i=this._iv;if(i){var s=i;this._iv=t}else var s=this._prevBlock;for(var o=0;o<r;o++)e[n+o]^=s[o]}var e=v.extend();return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,s=e.slice(t,t+i);r.decryptBlock(e,t),n.call(this,e,t,i),this._prevBlock=s}}),e}(),g=n.pad={},y=g.Pkcs7={pad:function(e,t){var n=t*4,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,o=[];for(var u=0;u<r;u+=4)o.push(i);var a=s.create(o,r);e.concat(a)},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},b=r.BlockCipher=h.extend({cfg:h.cfg.extend({mode:m,padding:y}),reset:function(){h.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{var r=n.createDecryptor;this._minBufferSize=1}this._mode=r.call(n,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),w=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),E=n.format={},S=E.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=s.create([1398893684,1701076831]).concat(n).concat(t);else var r=t;return r.toString(f)},parse:function(e){var t=f.parse(e),n=t.words;if(n[0]==1398893684&&n[1]==1701076831){var r=s.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return w.create({ciphertext:t,salt:r})}},x=r.SerializableCipher=i.extend({cfg:i.extend({format:S}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),s=i.finalize(t),o=i.cfg;return w.create({ciphertext:s,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=e.createDecryptor(n,r).finalize(t.ciphertext);return i},_parse:function(e,t){return typeof e=="string"?t.parse(e,this):e}}),T=n.kdf={},N=T.OpenSSL={execute:function(e,t,n,r){r||(r=s.random(8));var i=c.create({keySize:t+n}).compute(e,r),o=s.create(i.words.slice(t),n*4);return i.sigBytes=t*4,w.create({key:i,iv:o,salt:r})}},C=r.PasswordBasedCipher=x.extend({cfg:x.cfg.extend({kdf:N}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=r.kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var s=x.encrypt.call(this,e,t,i.key,r);return s.mixIn(i),s},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);r.iv=i.iv;var s=x.decrypt.call(this,e,t,i.key,r);return s}})}(),e.mode.CFB=function(){function n(e,t,n,r){var i=this._iv;if(i){var s=i.slice(0);this._iv=undefined}else var s=this._prevBlock;r.encryptBlock(s,0);for(var o=0;o<n;o++)e[t+o]^=s[o]}var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;n.call(this,e,t,i,r),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,s=e.slice(t,t+i);n.call(this,e,t,i,r),this._prevBlock=s}}),t}(),e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=t*4,i=r-n%r,s=n+i-1;e.clamp(),e.words[s>>>2]|=i<<24-s%4*8,e.sigBytes+=i},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},e.pad.Iso10126={pad:function(t,n){var r=n*4,i=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=t}},e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,s=this._keystream;i&&(s=this._keystream=i.slice(0),this._iv=undefined),n.encryptBlock(s,0);for(var o=0;o<r;o++)e[t+o]^=s[o]}});return t.Decryptor=n,t}(),e.pad.NoPadding={pad:function(){},unpad:function(){}},function(t){var n=e,r=n.lib,i=r.CipherParams,s=n.enc,o=s.Hex,u=n.format,a=u.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return i.create({ciphertext:t})}}}(),function(){var t=e,n=t.lib,r=n.BlockCipher,i=t.algo,s=[],o=[],u=[],a=[],f=[],l=[],c=[],h=[],p=[],d=[];(function(){var e=[];for(var t=0;t<256;t++)t<128?e[t]=t<<1:e[t]=t<<1^283;var n=0,r=0;for(var t=0;t<256;t++){var i=r^r<<1^r<<2^r<<3^r<<4;i=i>>>8^i&255^99,s[n]=i,o[i]=n;var v=e[n],m=e[v],g=e[m],y=e[i]*257^i*16843008;u[n]=y<<24|y>>>8,a[n]=y<<16|y>>>16,f[n]=y<<8|y>>>24,l[n]=y;var y=g*16843009^m*65537^v*257^n*16843008;c[i]=y<<24|y>>>8,h[i]=y<<16|y>>>16,p[i]=y<<8|y>>>24,d[i]=y,n?(n=v^e[e[e[g^v]]],r^=e[e[r]]):n=r=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],m=i.AES=r.extend({_doReset:function(){var e=this._key,t=e.words,n=e.sigBytes/4,r=this._nRounds=n+6,i=(r+1)*4,o=this._keySchedule=[];for(var u=0;u<i;u++)if(u<n)o[u]=t[u];else{var a=o[u-1];u%n?n>6&&u%n==4&&(a=s[a>>>24]<<24|s[a>>>16&255]<<16|s[a>>>8&255]<<8|s[a&255]):(a=a<<8|a>>>24,a=s[a>>>24]<<24|s[a>>>16&255]<<16|s[a>>>8&255]<<8|s[a&255],a^=v[u/n|0]<<24),o[u]=o[u-n]^a}var f=this._invKeySchedule=[];for(var l=0;l<i;l++){var u=i-l;if(l%4)var a=o[u];else var a=o[u-4];l<4||u<=4?f[l]=a:f[l]=c[s[a>>>24]]^h[s[a>>>16&255]]^p[s[a>>>8&255]]^d[s[a&255]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,u,a,f,l,s)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,h,p,d,o);var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,u){var a=this._nRounds,f=e[t]^n[0],l=e[t+1]^n[1],c=e[t+2]^n[2],h=e[t+3]^n[3],p=4;for(var d=1;d<a;d++){var v=r[f>>>24]^i[l>>>16&255]^s[c>>>8&255]^o[h&255]^n[p++],m=r[l>>>24]^i[c>>>16&255]^s[h>>>8&255]^o[f&255]^n[p++],g=r[c>>>24]^i[h>>>16&255]^s[f>>>8&255]^o[l&255]^n[p++],y=r[h>>>24]^i[f>>>16&255]^s[l>>>8&255]^o[c&255]^n[p++];f=v,l=m,c=g,h=y}var v=(u[f>>>24]<<24|u[l>>>16&255]<<16|u[c>>>8&255]<<8|u[h&255])^n[p++],m=(u[l>>>24]<<24|u[c>>>16&255]<<16|u[h>>>8&255]<<8|u[f&255])^n[p++],g=(u[c>>>24]<<24|u[h>>>16&255]<<16|u[f>>>8&255]<<8|u[l&255])^n[p++],y=(u[h>>>24]<<24|u[f>>>16&255]<<16|u[l>>>8&255]<<8|u[c&255])^n[p++];e[t]=v,e[t+1]=m,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=r._createHelper(m)}(),function(){function h(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}var t=e,n=t.lib,r=n.WordArray,i=n.BlockCipher,s=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],a=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],c=s.DES=i.extend({_doReset:function(){var e=this._key,t=e.words,n=[];for(var r=0;r<56;r++){var i=o[r]-1;n[r]=t[i>>>5]>>>31-i%32&1}var s=this._subKeys=[];for(var f=0;f<16;f++){var l=s[f]=[],c=a[f];for(var r=0;r<24;r++)l[r/6|0]|=n[(u[r]-1+c)%28]<<31-r%6,l[4+(r/6|0)]|=n[28+(u[r+24]-1+c)%28]<<31-r%6;l[0]=l[0]<<1|l[0]>>>31;for(var r=1;r<7;r++)l[r]=l[r]>>>(r-1)*4+3;l[7]=l[7]<<5|l[7]>>>27}var h=this._invSubKeys=[];for(var r=0;r<16;r++)h[r]=s[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),h.call(this,1,1431655765);for(var r=0;r<16;r++){var i=n[r],s=this._lBlock,o=this._rBlock,u=0;for(var a=0;a<8;a++)u|=f[a][((o^i[a])&l[a])>>>0];this._lBlock=o,this._rBlock=s^u}var c=this._lBlock;this._lBlock=this._rBlock,this._rBlock=c,h.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});t.DES=i._createHelper(c);var d=s.TripleDES=i.extend({_doReset:function(){var e=this._key,t=e.words;this._des1=c.createEncryptor(r.create(t.slice(0,2))),this._des2=c.createEncryptor(r.create(t.slice(2,4))),this._des3=c.createEncryptor(r.create(t.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=i._createHelper(d)}(),function(){function o(){var e=this._S,t=this._i,n=this._j,r=0;for(var i=0;i<4;i++){t=(t+1)%256,n=(n+e[t])%256;var s=e[t];e[t]=e[n],e[n]=s,r|=e[(e[t]+e[n])%256]<<24-i*8}return this._i=t,this._j=n,r}var t=e,n=t.lib,r=n.StreamCipher,i=t.algo,s=i.RC4=r.extend({_doReset:function(){var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[];for(var i=0;i<256;i++)r[i]=i;for(var i=0,s=0;i<256;i++){var o=i%n,u=t[o>>>2]>>>24-o%4*8&255;s=(s+r[i]+u)%256;var a=r[i];r[i]=r[s],r[s]=a}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});t.RC4=r._createHelper(s);var u=i.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});t.RC4Drop=r._createHelper(u)}(),e.mode.CTRGladman=function(){function n(e){if((e>>24&255)===255){var t=e>>16&255,n=e>>8&255,r=e&255;t===255?(t=0,n===255?(n=0,r===255?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}function r(e){return(e[0]=n(e[0]))===0&&(e[1]=n(e[1])),e}var t=e.lib.BlockCipherMode.extend(),i=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,s=this._iv,o=this._counter;s&&(o=this._counter=s.slice(0),this._iv=undefined),r(o);var u=o.slice(0);n.encryptBlock(u,0);for(var a=0;a<i;a++)e[t+a]^=u[a]}});return t.Decryptor=i,t}(),function(){function f(){var e=this._X,t=this._C;for(var n=0;n<8;n++)o[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0;for(var n=0;n<8;n++){var r=e[n]+t[n],i=r&65535,s=r>>>16,a=((i*i>>>17)+i*s>>>15)+s*s,f=((r&4294901760)*r|0)+((r&65535)*r|0);u[n]=a^f}e[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,e[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,e[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,e[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,e[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,e[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,e[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,e[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}var t=e,n=t.lib,r=n.StreamCipher,i=t.algo,s=[],o=[],u=[],a=i.Rabbit=r.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv;for(var n=0;n<4;n++)e[n]=(e[n]<<8|e[n]>>>24)&16711935|(e[n]<<24|e[n]>>>8)&4278255360;var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535];this._b=0;for(var n=0;n<4;n++)f.call(this);for(var n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var s=t.words,o=s[0],u=s[1],a=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,l=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,c=a>>>16|l&4294901760,h=l<<16|a&65535;i[0]^=a,i[1]^=c,i[2]^=l,i[3]^=h,i[4]^=a,i[5]^=c,i[6]^=l,i[7]^=h;for(var n=0;n<4;n++)f.call(this)}},_doProcessBlock:function(e,t){var n=this._X;f.call(this),s[0]=n[0]^n[5]>>>16^n[3]<<16,s[1]=n[2]^n[7]>>>16^n[5]<<16,s[2]=n[4]^n[1]>>>16^n[7]<<16,s[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)s[r]=(s[r]<<8|s[r]>>>24)&16711935|(s[r]<<24|s[r]>>>8)&4278255360,e[t+r]^=s[r]},blockSize:4,ivSize:2});t.Rabbit=r._createHelper(a)}(),e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,s=this._counter;i&&(s=this._counter=i.slice(0),this._iv=undefined);var o=s.slice(0);n.encryptBlock(o,0),s[r-1]=s[r-1]+1|0;for(var u=0;u<r;u++)e[t+u]^=o[u]}});return t.Decryptor=n,t}(),function(){function f(){var e=this._X,t=this._C;for(var n=0;n<8;n++)o[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0;for(var n=0;n<8;n++){var r=e[n]+t[n],i=r&65535,s=r>>>16,a=((i*i>>>17)+i*s>>>15)+s*s,f=((r&4294901760)*r|0)+((r&65535)*r|0);u[n]=a^f}e[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,e[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,e[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,e[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,e[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,e[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,e[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,e[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}var t=e,n=t.lib,r=n.StreamCipher,i=t.algo,s=[],o=[],u=[],a=i.RabbitLegacy=r.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535];this._b=0;for(var i=0;i<4;i++)f.call(this);for(var i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var s=t.words,o=s[0],u=s[1],a=(o<<8|o>>>24)&16711935|(o<<24|o>>>8)&4278255360,l=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,c=a>>>16|l&4294901760,h=l<<16|a&65535;r[0]^=a,r[1]^=c,r[2]^=l,r[3]^=h,r[4]^=a,r[5]^=c,r[6]^=l,r[7]^=h;for(var i=0;i<4;i++)f.call(this)}},_doProcessBlock:function(e,t){var n=this._X;f.call(this),s[0]=n[0]^n[5]>>>16^n[3]<<16,s[1]=n[2]^n[7]>>>16^n[5]<<16,s[2]=n[4]^n[1]>>>16^n[7]<<16,s[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)s[r]=(s[r]<<8|s[r]>>>24)&16711935|(s[r]<<24|s[r]>>>8)&4278255360,e[t+r]^=s[r]},blockSize:4,ivSize:2});t.RabbitLegacy=r._createHelper(a)}(),e.pad.ZeroPadding={pad:function(e,t){var n=t*4;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;while(!(t[n>>>2]>>>24-n%4*8&255))n--;e.sigBytes=n+1}},e}),define("modules/usermanager",["jquery","underscore","validate","text!../../template/userManager.html","controls/Common","i18n/"+global.language,"controls/List","controls/Ajax","controls/Pager","controls/Dialog","controls/DeptUserBox","dropkick","zTree","CryptoJS"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){window.global=window.global||{user:{},corpList:{}};var d=s.userManager,v=s.setting,m=s.common,g={el:".rightContainer",ui:{companyName:"#company-name",btnAddUser:"#add-user",btnImportUser:"#import-user",btnEditDepartment:"#edit-department",btnDeleteDepartment:"#delete-department",btnOutUser:"#out-user",btnDeleteUser:"#delete-user",btnAddDept:"#btnAddDept",btnGroup1:".btn-group-1",btnGroup2:".btn-group-2",btnGroup3:".btn-group-3",userType:"#user-type",userList:"#user-list",btnAddUser2:"#add-user-2",userSearch:"#user-search",addUser:"#addUser",addDeptUser:"#addDeptUser"},model:{pageNo:1,pageSize:20,deptPageSize:100,corpId:function(){var e=i.parseURL(location.href).params.corpId;return window.global.user.corpId||e}(),corpData:function(){var e=window.global.user.corpId||i.parseURL(location.href).params.corpId;return t.find(window.global.corpList,function(t){return t.corpId==e})}(),deptId:0,deptIds:[0]},accountRule:null,init:function(){this.deptObj={},this.initList(),this.initEvents(),this.initTree(),this.isInitialized=!0,this.initData(),this.getAccountRule(),this.initStyle(),e(window).off("resize.userManager").on("resize.userManager",this.initStyle)},initEvents:function(){if(this.isInitialized)return;var n=this;e(this.ui.companyName).on("click",function(){n.initData()}),e(this.ui.btnAddUser).on("click",t.bind(n.addUser,this)),e(this.ui.btnAddUser2).on("click",function(){e(this).find(".popList").toggle()}),e(this.ui.addUser).on("click",function(t){return e(n.ui.btnAddUser2).find(".popList").hide(),n.addUser(),!1}),e(this.ui.addDeptUser).on("click",function(t){return e(n.ui.btnAddUser2).find(".popList").hide(),n.addDeptUser(),!1}),e(this.ui.btnImportUser).on("click",t.bind(n.importUser,this)),e(this.ui.btnEditDepartment).on("click",t.bind(n.editDepartment,this)),e(this.ui.btnDeleteDepartment).on("click",t.bind(n.deleteDepartment,this)),e(this.ui.btnOutUser).on("click",t.bind(n.outUsers,this)),e(this.ui.btnDeleteUser).on("click",t.bind(n.deleteUsers,this)),e(this.ui.btnAddDept).on("click",t.bind(n.addDept,this)),e(this.ui.userSearch).on("keyup",n.userSearch)},initList:function(){var n=this;this.list=this.list||new o({container:"#user-list",data:[],hasCheckBtn:!0,key:"uid",rowClass:function(e){return e.role=="admin"&&global.user.role!="root"?"row-admin":!1},columns:[{columnId:"userId",columnName:d.userName,titleStyle:"",titleAttr:'width="20%"',callback:function(e){return['<span class="tf">',e,"</span>"].join("")},action:"showDetail",onClick:e.proxy(n.showDetail,n)},{columnId:"depts",columnName:d.depart,titleStyle:"",titleAttr:"",callback:function(e){var r=t.map(e,function(e){return e.name}),i=r.join("，")||d.ungrouped;return n.deptModel&&(i=n.deptModel.name),['<span title="',t.escape(i),'">',t.escape(i),"</span>"].join("")}}],operate:{columnName:m.operate,titleStyle:"",titleAttr:"",list:[{name:m.out,action:"out",className:"btn28 btn_white1 mr_5 out",onClick:t.bind(n.outUser,n)},{name:m.setting,action:"edit",className:"btn28 btn_white1 mr_5 edit",onClick:t.bind(n.editUser,n)},{name:m.del,action:"delete",className:"btn28 btn_white1 mr_5 delete",onClick:t.bind(n.deleteUser,n)}]}})},initTree:function(n){function s(t,n){var r=15,i=e("#"+n.tId+"_switch"),s=e("#"+n.tId+"_ico");i.remove(),s.before(i);var o="<span style='display: inline-block;width:"+r*n.level+"px'></span>";i.before(o)}var r=this,i={view:{showLine:!1,showIcon:!1,selectedMulti:!1,dblClickExpand:!1,addDiyDom:s},data:{simpleData:{enable:!0,idKey:"deptId",pIdKey:"parentId",rootPid:0}},async:{type:"POST",enable:!0,url:r.dataAPI.getUrlByFnName("getDeptUsers")+"&type=subgrp",contentType:"text/plain; charset=UTF-8",deptParam:["corpId","deptId"],dataFilter:function(e,n,i){if(i&&i.code=="S_OK"&&i["var"]){t.map(i["var"].depts,function(e){return e.isParent=!e.leaf});var s=i["var"].depts;return r.deptObj[n.deptId]=s,s}}},callback:{onClick:function(e,t,n,i){var s=n.corpId,o=n.deptId;this.getZTreeObj(t).expandNode(n),r.deptModel=n,r.setBtnStatus("dept"),r.model.pageNo=1,r.getUser({corpId:s,deptIds:[o]})}}};t.map(n,function(e){return e.isParent=!e.leaf}),e.fn.zTree.init(e("#depart"),i,n)},initData:function(){var t=this;this.model.pageNo=1,this.model.deptId=0,this.model.deptIds=[0],this.getTopDpt(this.model.corpId),this.getTopUser(this.model.corpId),e("#company-name").text(t.model.corpData.name||"").attr("title",t.model.corpData.name||""),this.setBtnStatus("top")},initStyle:function(){var e=global.height-49-49-40,t=".tableBox{height:"+e+"px}";i.addStyle("setting",t)},getAccountRule:function(){var n=this,r={url:n.dataAPI.getUrlByFnName("getAccountRule"),data:{corpId:n.model.corpId},success:function(r){n.accountRule={},t.each(r,function(e){var t=e.ruleId;switch(t){case 1:n.accountRule.length=e;break;case 2:n.accountRule.spChar=e;break;case 3:n.accountRule.caps=e;break;case 4:n.accountRule.weak=e;break;case 5:n.accountRule.timeout=e;break;default:}}),e.validator.addMethod("spChar",function(e,t){var r=new RegExp(n.accountRule.spChar.ruleValue);return r.test(e)},d.spChar),e.validator.addMethod("caps",function(e,t){var r=new RegExp(n.accountRule.caps.ruleValue);return r.test(e)},d.caps),e.validator.addMethod("weak",function(e,t){var r=new RegExp(n.accountRule.weak.ruleValue);return!r.test(e)},d.weak)},fail:function(e){f.tips(v.getSafeInfoFail+" "+(e.code||""))}};u.request(r,undefined,!0)},refresh:function(){var e=this;this.getUser({corpId:e.model.corpId,deptIds:e.model.deptIds})},setBtnStatus:function(t){var n=e(this.ui.btnGroup1),r=e(this.ui.btnGroup2),i=e(this.ui.btnGroup3),s=e(this.ui.userType),o=e(this.ui.userList);switch(t){case"top":n.show(),r.hide(),i.hide(),s.text(d.allUser),o.addClass("list-top");break;case"dept":n.hide(),r.show(),i.show(),s.text(d.userList),o.removeClass("list-top");break;default:}},userSearch:function(t){var n=g;n.setBtnStatus("top");var r=e(this),i=r.val();t.keyCode==13?i==""?f.tips(v.typeKeyword):(n.model.pageNo=1,n.userSearchReq(i)):(t.ctrlKey&&t.keyCode==88||t.keyCode==8||t.keyCode==46)&&i==""&&(n.model.pageNo=1,n.getTopUser(n.model.corpId))},userSearchReq:function(t){e.fn.zTree.getZTreeObj("depart").cancelSelectedNode();var n=this,r={url:n.dataAPI.getUrlByFnName("searchUser")+"&page="+n.model.pageNo+"&pagesize="+n.model.pageSize+"&matchrule=like",data:{corpId:n.model.corpId,name:t},success:function(r){n.list.setData(r.users);if(!r.users.length){e(".pager").html("");return}n.pager=new a({el:".pager",pageNo:r.pageNo,total:r.total,pageSize:n.model.pageSize,onclick:function(e){n.model.pageNo=e,n.userSearchReq(t)}})},fail:function(e){f.tips(m.searchFail+" "+(e.code||""))}};u.request(r)},setListData:function(e){},getTopDpt:function(e){var t=this;t.deptModel=null;var n={url:t.dataAPI.getUrlByFnName("getDeptUsers")+"&page=1&pagesize="+t.model.deptPageSize+"&type=subgrp",data:{corpId:e,deptIds:["0"]},success:function(e){var n=e.depts;t.deptObj[0]=n,t.initTree(n)},fail:function(e){f.tips(d.getDeptFail+" "+(e.code||""))}};u.request(n,!1,!0)},getTopUser:function(e){var t=this;t.getUser({corpId:e,deptIds:["0"],alluser:!0})},getUser:function(t){var n=this;n.model.corpId=t.corpId,n.model.deptIds=t.deptIds;var r={url:n.dataAPI.getUrlByFnName("getDeptUsers")+"&page="+n.model.pageNo+"&pagesize="+n.model.pageSize+"&type="+(t.alluser?"alluser":"user"),data:t,success:function(t){n.list.setData(t.users);if(!t.users.length){e(".pager").html("");return}n.pager=new a({el:".pager",pageNo:t.pageNo,total:t.total,pageSize:n.model.pageSize,onclick:function(e){n.model.pageNo=e,n.refresh()}})},fail:function(e){f.tips(d.getUserInfoFail+" "+(e.code||""))}};u.request(r)},userValidate:function(){var t=this;e("#accountForm").validate({rules:{userId:{required:!0,account:!0},storageNum:{required:!0,number:!0},mobile:{mobilePhone:!0},name:{fullName:!0},email:{email:!0},password:{required:!0,spChar:!!t.accountRule.spChar.isCheck,caps:!!t.accountRule.caps.isCheck,weak:!!t.accountRule.weak.isCheck,minlength:parseInt(t.accountRule.length.ruleValue,10),maxlength:30},password2:{required:!0,spChar:!!t.accountRule.spChar.isCheck,caps:!!t.accountRule.caps.isCheck,weak:!!t.accountRule.weak.isCheck,minlength:parseInt(t.accountRule.length.ruleValue,10),maxlength:30,equalTo:"#password"}},messages:{userId:{required:d.typeUserName,account:"请输入正确的用户名"},storageNum:{required:v.typeSpace,number:v.typeNumber},email:{email:d.emailNotCorrect},name:{fullName:"请输入正确的姓名"},mobile:{mobilePhone:"请输入正确的手机号码"},password:{required:v.typePwd,minlength:v.minPsw,maxlength:"请输入小于{0}字符的密码"},password2:{minlength:v.minPsw,required:v.typePwd2,equalTo:v.pswNotEqual,maxlength:"请输入小于{0}字符的密码"}},wrapper:"div",errorPlacement:function(t,n){e(n).parent().append(t.prepend('<i class="i-warm ml_5"></i>'))}})},addUser:function(){var t=this,n,s=function(e){f.tips(d.addUserSuc),t.refresh()},o=function(e){f.tips(d.addUserFail+" "+(e.code||""))},a=i.getTemplate(r,"#creatAccount-tpl"),l=i.tpl2Html(a,{size:i.formatStorageUnit(t.model.corpData.storage)}),c=f.pop({title:d.addUser,content:l,okRemovePop:!1,ok:function(){if(!e("#accountForm").valid())return;var n=t.model.corpId,r=t.model.deptIds,a=e("#creatAccount"),f=i.convertToB(a.find(".storageNum").val(),t.addUserUnitSelect.value),l={corpId:n,deptIds:r,name:a.find(".name").val(),userId:a.find(".userId").val(),password:p.MD5(a.find(".password").val()).toString().toUpperCase(),email:a.find(".email").val(),mobile:a.find(".mobile").val(),role:"normal",storage:f,passFlag:a.find(".passFlag").prop("checked")?"1":"0",createUser:window.global.user.role||"admin"};u.request({url:t.dataAPI.getUrlByFnName("addUser"),data:l,success:s,fail:o}),c.removePop()},onPop:function(){t.addUserUnitSelect=new Dropkick(e("#creatAccount .storageUnit")[0]),t.userValidate(),i.checkPswdLv("#password",".pswd-lv")}})},addDeptUser:function(){var e=this,n={},r,i={};r=f.pop({title:d.addDeptUser,content:'<div id="box"></div>',ok:function(){var i=n.getSelected();if(!i.length){f.tips(d.selectUser);return}var s=[];t.each(i,function(e){s.push(e.uid)});var o=e.deptModel.parentId||0,a={url:e.dataAPI.getUrlByFnName("manageDeptMember"),data:{op:"add",corpId:e.model.corpId,deptId:e.model.deptIds[0],member:s},success:function(t){f.tips(d.addDeptUserSuc),e.refresh()},fail:function(e){f.tips(d.addDeptUserFail+" "+(e.code||""))}};u.request(a),r.removePop()},okRemovePop:!1,onPop:function(){n=new l({el:"#box",corpId:e.model.corpId})}})},editUserValidate:function(){var t=this;e("#accountSettingForm").validate({rules:{storageNum:{required:!0,number:!0},name:{fullName:!0},email:{email:!0},mobile:{mobilePhone:!0},password:{minlength:parseInt(t.accountRule.length.ruleValue,10),spChar:!!t.accountRule.spChar.isCheck,caps:!!t.accountRule.caps.isCheck,weak:!!t.accountRule.weak.isCheck,maxlength:30},password2:{minlength:parseInt(t.accountRule.length.ruleValue,10),spChar:!!t.accountRule.spChar.isCheck,caps:!!t.accountRule.caps.isCheck,weak:!!t.accountRule.weak.isCheck,equalTo:"#as-password",maxlength:30}},messages:{storageNum:{required:v.typeSpace,number:v.typeNumber},email:{email:d.emailNotCorrect},name:{fullName:"请输入正确的姓名"},mobile:{mobile:"请输入正确的手机号码"},password:{minlength:v.minPsw,maxlength:"请输入小于{0}字符的密码"},password2:{minlength:v.minPsw,equalTo:v.pswNotEqual,maxlength:"请输入小于{0}字符的密码"}},wrapper:"div",errorPlacement:function(t,n){e(n).parent().append(t.prepend('<i class="i-warm ml_5"></i>'))}})},editUser:function(n){var s=this,o,a=function(){if(!e("#accountSettingForm").valid())return;var n=e("#accountSetting"),r={name:n.find(".name").val(),email:n.find(".email").val(),mobile:n.find(".mobile").val(),passFlag:n.find(".passFlag").prop("checked")?"1":"0",storage:i.convertToB(n.find(".storageNum").val(),s.accountSettingUnitSelect.value)};n.find(".password").val()!=""&&n.find(".password").val()!=""&&(r.password=p.MD5(n.find(".password").val()).toString().toUpperCase());var a=t.omit(r,function(e,t,n){return s.userDetailModel[t]==e});o.removePop();if(t.isEmpty(a))return;a.uid=s.userDetailModel.uid,a.corpId=s.userDetailModel.corpId;var l={url:s.dataAPI.getUrlByFnName("updateUser"),data:a,success:function(e){f.tips(d.updateUserSuc),s.refresh()},fail:function(e){f.tips(d.updateUserFail+" "+(e.code||""))}};u.request(l)},l=function(t){s.userDetailModel=t;var n=i.getTemplate(r,"#accountSetting-tpl"),u=i.formatStorageUnit(t.storage),l=i.formatStorageUnit(t.storage,!0),c=i.formatStorageUnit(t.usedStorage);t.storageNum=l.num,t.storageObj=u,t.usedStorageObj=c,o=f.pop({title:d.userSetting,content:i.tpl2Html(n,t),okRemovePop:!1,width:460,ok:a,onPop:function(){s.accountSettingUnitSelect=new Dropkick("#unitSelect"),s.accountSettingUnitSelect.select(l.unit.toString()),e("#accountSetting .popUserSetL>ul>li").on("click.tab",function(){var t=e(this),n=e(this).index();t.addClass("act").siblings().removeClass("act");var r=t.parents(".popUserSetL").next().find(".popUserSetRCon>ul");r.hide().eq(n).show()}),s.editUserValidate(),i.checkPswdLv("#as-password",".pswd-lv")},closePop:function(){e("#accountSetting .popUserSetL>ul>li").off("click.tab")}})};this.getUserDetail({data:{uid:n.uid,corpId:n.corpId},success:l,fail:function(e){e.code=="UNACTIVED"?f.tips(d.unactived):f.tips(d.getUserInfoFail+" "+(e.code||""))}})},getUserDetail:function(e){var t=this;u.request({url:t.dataAPI.getUrlByFnName("getUser"),data:e.data,success:e.success,fail:e.fail})},showDetail:function(e){console.log(e)},deleteUser:function(e){var t=this;if(e.role=="admin"){f.alert(d.cantDelAdmin);return}var n={};f.confirm(m.tips,d.confirmDel,function(){u.request({url:t.dataAPI.getUrlByFnName("batchDelUser")+"&corpId="+e.corpId,data:[{uid:e.uid}],success:function(){f.tips(d.delUserSuc),t.refresh()},fail:function(e){f.tips(d.delUserFail+" "+(e.code||""))}})})},deleteUsers:function(){var e=this,n=this.list.getSelected();if(!n.length){f.tips(d.selectDelUser);return}var r=t.filter(n,function(e){return e.role!="admin"});r=t.map(r,function(e){return{uid:e.uid}});if(!r.length){f.alert(d.cantDelAdmin);return}var i={url:e.dataAPI.getUrlByFnName("batchDelUser")+"&corpId="+n[0].corpId,data:r,success:function(t){f.tips(d.delUserSuc),e.refresh()},fail:function(e){f.tips(d.delUserFail+" "+(e.code||""))}};f.confirm(m.tips,d.confirmDel,function(){u.request(i)})},outUser:function(e){var t=this,n={url:t.dataAPI.getUrlByFnName("manageDeptMember"),data:{op:"remove",corpId:t.model.corpId,deptId:t.model.deptIds[0],member:[e.uid]},success:function(e){f.tips(d.outUserSuc),t.refresh()},fail:function(e){f.tips(d.outUserFail+" "+(e.code||""))}};f.confirm(m.tips,d.outConfirm,function(){u.request(n)})},outUsers:function(){var e=this,n=this.list.getSelected();if(!n.length){f.tips(d.selectOutUser);return}var r=t.map(n,function(e){return e.uid}),i={url:e.dataAPI.getUrlByFnName("manageDeptMember"),data:{op:"remove",corpId:e.model.corpId,deptId:e.model.deptIds[0],member:r},success:function(t){f.tips(d.outUserSuc),e.refresh()},fail:function(e){f.tips(d.outUserFail+" "+(e.code||""))}};f.confirm(m.tips,d.outConfirms,function(){u.request(i)})},importUser:function(){var t=this,n=f.pop({title:d.importUser,content:i.tpl2Html(i.getTemplate(r,"#importLead-tpl")),ok:function(){var t=".xls,.xlsx",n=e("#file").val();if(n==""){f.alert(d.selectFile);return}if(t.indexOf(i.getFileExt(n))<=-1){var r=i.stringFormat(d.fileTips,t);f.alert(r);return}e.browser.msie?e("#file-form")[0].submit():e("#file-form").submit(),e(".upload-result").html(d.uploading)},okText:d.importBtn,okRemovePop:!1,onPop:function(){var r=t.dataAPI.getUrlByFnName("uploadTemplate")+"&corpId="+g.model.corpId;e("#file-form").attr("action",r),e("#file").on("change",function(){var t=e("#file").val(),n=t.substr(t.lastIndexOf("\\")+1);e(".file-result").text(n)}),e("#file-upload-iframe").on("load",function(){var t=e(this)[0],r;try{t.contentWindow?r=t.contentWindow.document.body?t.contentWindow.document.body.innerHTML:"{}":t.contentDocument&&(r=t.contentDocument.document.body?t.contentDocument.document.body.innerHTML:"{}");var i=new RegExp("<pre.*?>(.*?)</pre>","i"),s=i.exec(r);r=s?s[1]:"",r=(new Function("return "+r))(),r.code=="S_OK"?(n.removePop(),f.alert(d.uploadTips)):e(".upload-result").html('<em style="color:#f00">'+d.uploadFail+"</em>")}catch(o){e(".upload-result").html('<em style="color:#f00">所选文件不存在，请重新选择！</em>')}})}})},deptAccountValidate:function(){var t=this;e("#deptAccountForm").validate({rules:{name:{required:!0,deptName:!0,reDeptName:!0},storageNum:{required:!0,number:!0},userLimit:{required:!0,number:!0},remark:{remark:!0}},messages:{name:{required:d.typeDeptName,deptName:"请输入正确的部门名称",reDeptName:d.reDeptName},storageNum:{required:v.typeSpace,number:v.typeNumber},userLimit:{required:v.typeUserLimit,number:v.typeNumber},remark:{remark:v.remarkLength}},wrapper:"div",errorPlacement:function(t,n){e(n).parent().append(t.prepend('<i class="i-warm ml_5"></i>'))}})},addDept:function(){var t=this,n=i.getTemplate(r,"#creatDept-tpl"),s={name:"",parentId:"",remark:"",storage:"",userLimit:"",storageObj:{num:"",unit:"M"},size:i.formatStorageUnit(t.model.corpData.storage),type:"add"},o=f.pop({title:d.addDept,content:['<div id="addDept">',i.tpl2Html(n,s),"</div>"].join(""),okRemovePop:!1,ok:function(){if(!e("#deptAccountForm").valid(t.model.deptIds[0]))return;var n=e("#addDept"),r=i.convertToB(n.find(".storageNum").val(),t.addDeptUnitSelect.value),s={url:t.dataAPI.getUrlByFnName("addDept"),data:{name:e.trim(n.find(".name").val()),parentId:t.model.deptIds[0],remark:e.trim(n.find(".remark").val()),storage:r,userLimit:parseInt(n.find(".userLimit").val(),10),corpId:t.model.corpId},success:function(n){f.tips(d.addDeptSuc);var r=e.fn.zTree.getZTreeObj("depart"),i=r.getNodesByParam("deptId",t.model.deptIds[0],null);n.parentId==0?n.rootDeptId=n.deptId:n.rootDeptId=t.deptModel.rootDeptId,i.length?(n.isParent=!1,r.addNodes(i[0],n)):t.getTopDpt(t.model.corpId),u.request({url:"/drive/service/corplib/corplib?func=corplib:addCorpLib",data:{corpId:t.model.corpId,usn:window.global.user.usn,parentId:n.parentId,deptName:n.name,userId:window.global.user.userId,rootDeptId:n.rootDeptId,corpName:t.model.corpData.name,deptId:n.deptId},success:function(e){console&&console.log(e)},fail:function(){}},!1,!0)},fail:function(e){f.tips(d.addDeptFail+" "+(e.code||""))}};u.request(s),o.removePop()},onPop:function(){var n=e("#addDept");t.addDeptUnitSelect=new Dropkick(n.find(".storageUnit")[0]),t.deptAccountValidate()}})},getDeptDetail:function(e){var t=this;u.request({url:t.dataAPI.getUrlByFnName("getDeptDetail"),data:e.data,success:e.success,fail:e.fail})},editDepartment:function(){var n=this,s={data:{corpId:n.model.corpId,deptId:n.model.deptIds[0]},success:function(s){var o=i.getTemplate(r,"#creatDept-tpl");s.storageObj=i.formatStorageUnit(s.storage,!0),s.size=i.formatStorageUnit(n.model.corpData.storage),s.type="edit";var a,l=f.pop({title:d.editDept,content:['<div id="editDept">',i.tpl2Html(o,s),"</div>"].join(""),okRemovePop:!1,ok:function(){if(!e("#deptAccountForm").valid())return;var r=e("#editDept"),o=i.convertToB(r.find(".storageNum").val(),n.editDeptUnitSelect.value),c={name:r.find(".name").val(),storage:o,userLimit:r.find(".userLimit").val(),remark:r.find(".remark").val()},h=t.omit(c,function(e,t,n){return s[t]==e});if(t.isEmpty(h))return;a=h.name,h.deptId=s.deptId,h.corpId=n.model.corpId;var p={url:n.dataAPI.getUrlByFnName("updateDept"),data:h,success:function(){f.tips(d.editDeptSuc);if(a){var t=e.fn.zTree.getZTreeObj("depart"),n=t.getNodesByParam("deptId",h.deptId,null);n[0].name=a,t.updateNode(n[0])}},fail:function(e){f.tips(d.editDeptFail+" "+(e.code||""))}};u.request(p),l.removePop()},onPop:function(){var t=e("#editDept");n.editDeptUnitSelect=new Dropkick(t.find(".storageUnit")[0]),n.editDeptUnitSelect.select(s.storageObj.unit),n.deptAccountValidate()}})},fail:function(e){f.tips(d.getDeptInfoFail+" "+(e.code||""))}};this.getDeptDetail(s)},deleteDepartment:function(){var n=this;f.confirm(m.tips,d.delDeptConfirm,function(){var r={url:n.dataAPI.getUrlByFnName("delDept"),data:{corpId:n.model.corpId,deptIds:n.model.deptIds},success:function(r){f.tips(d.delDeptSuc);var i=e.fn.zTree.getZTreeObj("depart"),s=i.getNodesByParam("deptId",n.model.deptIds[0],null);i.removeNode(s[0]),u.request({url:"/drive/service/corplib/corplib?func=corplib:delCorpLib",data:{corpId:n.model.corpId,usn:window.global.user.usn,parentId:n.deptModel.parentId||0,deptName:n.deptModel.name,userId:window.global.user.userId,rootDeptId:n.deptModel.rootDeptId,corpName:n.model.corpData.name,deptId:n.deptModel.deptId},success:function(e){console&&console.log(e)},fail:function(){}},!1,!0),t.delay(function(){location.reload()},1e3)},fail:function(e){f.tips(d.delDeptFail+" "+(e.code||""))}};u.request(r)})},dataAPI:t.extend({},i.APIObj,{fnName:{addUser:"user:addUser",updateUser:"user:updateUser",delUser:"user:delUser",batchDelUser:"user:batchDelUser",getUser:"user:getUser",searchUser:"user:searchUser",getAccountRule:"account:getAccountRule",getDeptUsers:"user:getDeptUsers",removeUserDept:"user:removeUserDept",addDeptUser:"user:addDeptUser",manageDeptMember:"user:manageDeptMember",addDept:"dept:addDept",updateDept:"dept:updateDept",getDeptDetail:"dept:getDeptDetail",delDept:"dept:delDept",uploadTemplate:"upload:uploadTemplate"}})};return window.UserManage=g,{init:function(){g.init()}}});