/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! jQuery UI - v1.11.4 - 2016-03-31
* http://jqueryui.com
* Includes: core.js, datepicker.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery UI Core 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */

/*!
 * jQuery UI Datepicker 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */

global.language=global.language||"zh_CN",define("controls/Common",["jquery","underscore","i18n/"+global.language],function(e,t,n){return{Module:{nowModule:{},callModule:function(e){var n=Array.prototype.slice.call(arguments,0);n.shift();var r=this.nowModule.destroy,i=e.init;i&&t.isFunction(i)&&(r&&t.isFunction(r)&&r.apply(this.nowModule),this.nowModule=e,i.apply(e,n))}},APIObj:{url:"admin.do",fnName:{},getUrlByFnName:function(e){if(e&&this.fnName[e])return[this.url,"?func=",this.fnName[e]].join("");console.log(n.common.invalidFn)}},formatFloat:function(e,t){var n=e.toFixed(t);return parseInt(n,10)==n?parseInt(n,10):n},formatStorageUnit:function(e,t,n){var r=1024,i=1048576,s=1073741824,o=1099511627776,u,a;if(n){switch(n){case"B":u=this.formatFloat(e,1);break;case"K":case"KB":u=this.formatFloat(e/r,1);break;case"M":case"MB":u=this.formatFloat(e/i,1);break;case"G":case"GB":u=this.formatFloat(e/s,1);break;case"T":case"TB":u=this.formatFloat(e/o,1);break;default:}a=n}else e>=o?(u=this.formatFloat(e/o,1),a="TB"):e>=s?(u=this.formatFloat(e/s,1),a="GB"):e>=i?(u=this.formatFloat(e/i,1),a="MB"):e>=r?(u=this.formatFloat(e/r,1),a="KB"):(u=this.formatFloat(e,1),a="B");return t?{num:u,unit:a}:u==0?0:u+a},stringFormat:function(){if(arguments.length==0)return null;var e=arguments[0];for(var t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1)+"\\}","gm");e=e.replace(n,arguments[t])}return e},convertToB:function(e,t){var n;switch(t){case"K":case"KB":n=1024;break;case"M":case"MB":n=1048576;break;case"G":case"GB":n=1073741824;break;case"T":case"TB":n=1099511627776;break;default:n=1}return e*n},formatOutDate:function(e){var t,r;return e>=12?(t=parseInt(e/12,10),r=e%12,[t,n.setting.year,r?r+n.setting.month:""].join("")):e+n.setting.month},getOutDate:function(e){return e==-1?n.setting.forever:this.formatOutDate(e)},getStatus:function(e){var t="";switch(e){case 0:t=n.setting.normal;break;case 1:t=n.setting.locked;break;case 2:t=n.setting.canceled;break;default:t=n.setting.normal}return t},getTemplate:function(t,n){return e(t).find(n).html()},tpl2Html:function(e,r){var i=t.template(e);return i(t.extend({},{Lang:n},r||{}))},parseURL:function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){var e={},n=t.search.replace(/^\?/,"").split("&"),r=n.length,i=0,s;for(;i<r;i++){if(!n[i])continue;s=n[i].split("="),e[s[0]]=s[1]}return e}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},getRootUrl:function(){var e=this.parseURL(window.location.href);return[e.protocol,"://",e.host+"/"].join("")},getFileExt:function(e){if(e!=""){var t="."+e.replace(/.+\./,"");return t}},getLv:function(e){var t=1,r=n.common.weak,i=/[a-zA-z]/,s=/[0-9]/,o=/(?=[\x21-\x7e]+)[^A-Za-z0-9]/;if(i.test(e)&&s.test(e)&&o.test(e))t=3,r=n.common.strong;else if(i.test(e)&&s.test(e)||i.test(e)&&o.test(e)||s.test(e)&&o.test(e))t=2,r=n.common.normal;return{pswdLv:t,pswdLvText:r}},checkPswdLv:function(t,n){var r=this;e(t).off("keyup.lv").on("keyup.lv",function(){var t=e(this),i=t.val(),s=e(n);if(i==""){s.hide();return}s.show();var o=r.getLv(i);s.find("span").attr("class","passwrodLevel Plevel_"+o.pswdLv),s.find("em").text(o.pswdLvText)})},addStyle:function(t,n){var r="temp-style-"+t,i=e("#"+r);i.length&&i.remove();var s=['<style id="',r,'" type="text/css" rel="stylesheet">',n,"</style>"].join("");e(s).appendTo("head")}}}),function(e){var t=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){t.Backbone=e(t,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore"),r;try{r=require("jquery")}catch(i){}e(t,exports,n,r)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,n,r){var i=e.Backbone,s=Array.prototype.slice;t.VERSION="1.3.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,r){switch(e){case 1:return function(){return n[t](this[r])};case 2:return function(e){return n[t](this[r],e)};case 3:return function(e,i){return n[t](this[r],a(e,this),i)};case 4:return function(e,i,s){return n[t](this[r],a(e,this),i,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[r]),n[t].apply(n,e)}}},u=function(e,t,r){n.each(t,function(t,i){n[i]&&(e.prototype[i]=o(t,i,r))})},a=function(e,t){return n.isFunction(e)?e:n.isObject(e)&&!t._isModel(e)?f(e):n.isString(e)?function(t){return t.get(e)}:e},f=function(e){var t=n.matches(e);return function(e){return t(e.attributes)}},l=t.Events={},c=/\s+/,h=function(e,t,r,i,s){var o=0,u;if(r&&typeof r=="object"){i!==void 0&&"context"in s&&s.context===void 0&&(s.context=i);for(u=n.keys(r);o<u.length;o++)t=h(e,t,u[o],r[u[o]],s)}else if(r&&c.test(r))for(u=r.split(c);o<u.length;o++)t=e(t,u[o],i,s);else t=e(t,r,i,s);return t};l.on=function(e,t,n){return p(this,e,t,n)};var p=function(e,t,n,r,i){e._events=h(d,e._events||{},t,n,{context:r,ctx:e,listening:i});if(i){var s=e._listeners||(e._listeners={});s[i.id]=i}return e};l.listenTo=function(e,t,r){if(!e)return this;var i=e._listenId||(e._listenId=n.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),o=s[i];if(!o){var u=this._listenId||(this._listenId=n.uniqueId("l"));o=s[i]={obj:e,objId:i,id:u,listeningTo:s,count:0}}return p(e,t,r,this,o),this};var d=function(e,t,n,r){if(n){var i=e[t]||(e[t]=[]),s=r.context,o=r.ctx,u=r.listening;u&&u.count++,i.push({callback:n,context:s,ctx:s||o,listening:u})}return e};l.off=function(e,t,n){return this._events?(this._events=h(v,this._events,e,t,{context:n,listeners:this._listeners}),this):this},l.stopListening=function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=e?[e._listenId]:n.keys(i);for(var o=0;o<s.length;o++){var u=i[s[o]];if(!u)break;u.obj.off(t,r,this)}return this};var v=function(e,t,r,i){if(!e)return;var s=0,o,u=i.context,a=i.listeners;if(!t&&!r&&!u){var f=n.keys(a);for(;s<f.length;s++)o=a[f[s]],delete a[o.id],delete o.listeningTo[o.objId];return}var l=t?[t]:n.keys(e);for(;s<l.length;s++){t=l[s];var c=e[t];if(!c)break;var h=[];for(var p=0;p<c.length;p++){var d=c[p];r&&r!==d.callback&&r!==d.callback._callback||u&&u!==d.context?h.push(d):(o=d.listening,o&&--o.count===0&&(delete a[o.id],delete o.listeningTo[o.objId]))}h.length?e[t]=h:delete e[t]}return e};l.once=function(e,t,r){var i=h(m,{},e,t,n.bind(this.off,this));return this.on(i,t,r)},l.listenToOnce=function(e,t,r){var i=h(m,{},t,r,n.bind(this.stopListening,this,e));return this.listenTo(e,i)};var m=function(e,t,r,i){if(r){var s=e[t]=n.once(function(){i(t,s),r.apply(this,arguments)});s._callback=r}return e};l.trigger=function(e){if(!this._events)return this;var t=Math.max(0,arguments.length-1),n=Array(t);for(var r=0;r<t;r++)n[r]=arguments[r+1];return h(g,this._events,e,void 0,n),this};var g=function(e,t,n,r){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&y(i,r),s&&y(s,[t].concat(r))}return e},y=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}};l.bind=l.on,l.unbind=l.off,n.extend(t,l);var b=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,l,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},matches:function(e){return!!n.iteratee(e,this)(this.attributes)},set:function(e,t,r){if(e==null)return this;var i;typeof e=="object"?(i=e,r=t):(i={})[e]=t,r||(r={});if(!this._validate(i,r))return!1;var s=r.unset,o=r.silent,u=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=n.clone(this.attributes),this.changed={});var f=this.attributes,l=this.changed,c=this._previousAttributes;for(var h in i)t=i[h],n.isEqual(f[h],t)||u.push(h),n.isEqual(c[h],t)?delete l[h]:l[h]=t,s?delete f[h]:f[h]=t;this.idAttribute in i&&(this.id=this.get(this.idAttribute));if(!o){u.length&&(this._pending=r);for(var p=0;p<u.length;p++)this.trigger("change:"+u[p],this,f[u[p]],r)}if(a)return this;if(!o)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,r={};for(var i in e){var s=e[i];if(n.isEqual(t[i],s))continue;r[i]=s}return n.size(r)?r:!1},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=n.extend({parse:!0},e);var t=this,r=e.success;return e.success=function(n){var i=e.parse?t.parse(n,e):n;if(!t.set(i,e))return!1;r&&r.call(e.context,t,n,e),t.trigger("sync",t,n,e)},R(this,e),this.sync("read",this,e)},save:function(e,t,r){var i;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0,parse:!0},r);var s=r.wait;if(i&&!s){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var o=this,u=r.success,a=this.attributes;r.success=function(e){o.attributes=a;var t=r.parse?o.parse(e,r):e;s&&(t=n.extend({},i,t));if(t&&!o.set(t,r))return!1;u&&u.call(r.context,o,e,r),o.trigger("sync",o,e,r)},R(this,r),i&&s&&(this.attributes=n.extend({},a,i));var f=this.isNew()?"create":r.patch?"patch":"update";f==="patch"&&!r.attrs&&(r.attrs=i);var l=this.sync(f,this,r);return this.attributes=a,l},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){i&&s(),r&&r.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};var o=!1;return this.isNew()?n.defer(e.success):(R(this,e),o=this.sync("delete",this,e)),i||s(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||q();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var w={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};u(b,w,"attributes");var E=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},x={add:!0,remove:!1},T=function(e,t,n){n=Math.min(Math.max(n,0),e.length);var r=Array(e.length-n),i=t.length,s;for(s=0;s<r.length;s++)r[s]=e[s+n];for(s=0;s<i;s++)e[s+n]=t[s];for(s=0;s<r.length;s++)e[s+i+n]=r[s]};n.extend(E.prototype,l,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,x))},remove:function(e,t){t=n.extend({},t);var r=!n.isArray(e);e=r?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),r?i[0]:i},set:function(e,t){if(e==null)return;t=n.extend({},S,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var r=!n.isArray(e);e=r?[e]:e.slice();var i=t.at;i!=null&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var s=[],o=[],u=[],a=[],f={},l=t.add,c=t.merge,h=t.remove,p=!1,d=this.comparator&&i==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m,g;for(g=0;g<e.length;g++){m=e[g];var y=this.get(m);if(y){if(c&&m!==y){var b=this._isModel(m)?m.attributes:m;t.parse&&(b=y.parse(b,t)),y.set(b,t),u.push(y),d&&!p&&(p=y.hasChanged(v))}f[y.cid]||(f[y.cid]=!0,s.push(y)),e[g]=y}else l&&(m=e[g]=this._prepareModel(m,t),m&&(o.push(m),this._addReference(m,t),f[m.cid]=!0,s.push(m)))}if(h){for(g=0;g<this.length;g++)m=this.models[g],f[m.cid]||a.push(m);a.length&&this._removeModels(a,t)}var w=!1,E=!d&&l&&h;s.length&&E?(w=this.length!==s.length||n.some(this.models,function(e,t){return e!==s[t]}),this.models.length=0,T(this.models,s,0),this.length=this.models.length):o.length&&(d&&(p=!0),T(this.models,o,i==null?this.length:i),this.length=this.models.length),p&&this.sort({silent:!0});if(!t.silent){for(g=0;g<o.length;g++)i!=null&&(t.index=i+g),m=o[g],m.trigger("add",m,this,t);(p||w)&&this.trigger("sort",this,t);if(o.length||a.length||u.length)t.changes={added:o,removed:a,merged:u},this.trigger("update",this,t)}return r?e[0]:e},reset:function(e,t){t=t?n.clone(t):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return this.get(e)!=null},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var r=t.length;return n.isFunction(t)&&(t=n.bind(t,this)),r===1||n.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=n.extend({parse:!0},e);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t.call(e.context,r,n,e),r.trigger("sync",r,n,e)},R(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};var r=t.wait;e=this._prepareModel(e,t);if(!e)return!1;r||this.add(e,t);var i=this,s=t.success;return t.success=function(e,t,n){r&&i.add(e,n),s&&s.call(n.context,e,t,n)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_removeModels:function(e,t){var n=[];for(var r=0;r<e.length;r++){var i=this.get(e[r]);if(!i)continue;var s=this.indexOf(i);this.models.splice(s,1),this.length--,delete this._byId[i.cid];var o=this.modelId(i.attributes);o!=null&&delete this._byId[o],t.silent||(t.index=s,i.trigger("remove",i,this,t)),n.push(i),this._removeReference(i,t)}return n},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var n=this.modelId(e.attributes);n!=null&&(this._byId[n]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var n=this.modelId(e.attributes);n!=null&&delete this._byId[n],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if(t){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r);if(e==="change"){var i=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);i!==s&&(i!=null&&delete this._byId[i],s!=null&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}});var N={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};u(E,N,"models");var C=t.View=function(e){this.cid=n.uniqueId("view"),n.extend(this,n.pick(e,L)),this._ensureElement(),this.initialize.apply(this,arguments)},k=/^(\S+)\s*(.*)$/,L=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){e||(e=n.result(this,"events"));if(!e)return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[r]);if(!r)continue;var i=t.match(k);this.delegate(i[1],i[2],n.bind(r,this))}return this},delegate:function(e,t,n){return this.$el.on(e+".delegateEvents"+this.cid,t,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,n){return this.$el.off(e+".delegateEvents"+this.cid,t,n),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(e)}else this.setElement(n.result(this,"el"))},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,r,i){var s=A[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||q()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1);var a=i.error;i.error=function(e,t,n){i.textStatus=t,i.errorThrown=n,a&&a.call(i.context,e,t,n)};var f=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,f,i),f};var A={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var O=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,D=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(O.prototype,l,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o,r)!==!1&&(s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o))}),this},execute:function(e,t,n){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(M,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/?]+)"}).replace(D,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var H=t.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},B=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,F=/#.*$/;H.started=!1,n.extend(H.prototype,l,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return e.charAt(0)==="/"?e.slice(1):e},getFragment:function(e){return e==null&&(this._usePushState||!this._wantsHashChange?e=this.getPath():e=this.getHash()),e.replace(B,"")},start:function(e){if(H.started)throw new Error("Backbone.history has already been started");H.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!this.history&&!!this.history.pushState,this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(j,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var s=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};this._usePushState?s("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?s("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));if(!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),H.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),n.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})):!1},navigate:function(e,t){if(!H.started)return!1;if(!t||t===!0)t={trigger:!!t};e=this.getFragment(e||"");var n=this.root;if(e===""||e.charAt(0)==="?")n=n.slice(0,-1)||"/";var r=n+e;e=this.decodeFragment(e.replace(F,""));if(this.fragment===e)return;this.fragment=e;if(this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new H;var I=function(e,t){var r=this,i;return e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t),i.prototype=n.create(r.prototype,e),i.prototype.constructor=i,i.__super__=r.prototype,i};b.extend=E.extend=O.extend=C.extend=H.extend=I;var q=function(){throw new Error('A "url" property or function must be specified')},R=function(e,t){var n=t.error;t.error=function(r){n&&n.call(t.context,e,r,t),e.trigger("error",e,r,t)}};return t}),function(e,t){e.sobox={maskIndex:0,showMask:function(n){var r=this;if(n){var i=e(".so-openmask");i.length?r.maskIndex++:(i=e('<div class="so-openmask"></div>'),e("body").append(i),r.maskIndex=1);var s=typeof t.body.style.maxHeight=="undefined"?t:window,o=e(s).height()-18;i.height(n?o+20:0),e(window).resize(function(){var t=e(s).height()-18;i.height(n?t+20:0)}),i.css("z-index",1e3+r.maskIndex*10)}else i=null;return i},show:function(t,n,r){var i=this,s=e(t.obj),o=i.showMask(n);return i.setPos(t),t.onlyOne&&e("body").data("soonlyone",!0),s.css("z-index",1002+i.maskIndex*10).fadeIn(),s.find(".s-close").bind("click",function(){i.hide(s)}),r&&r(),o},hide:function(t,n,r){var i=this,s=e(".so-openmask");e(t).fadeOut("fast",function(){r&&r()}),n&&(i.maskIndex--,s.css("z-index",1e3+i.maskIndex*10),i.maskIndex==0&&s.remove()),e(t).find(".s-close").unbind("click")},drag:function(n,r){function o(e){e==null&&(e=window.event),i.css({left:e.clientX-posX+"px",top:e.clientY-posY+"px"})}var i=e(n),s=e(r);s.mousedown(function(n){n||(n=window.event),posX=n.clientX-parseInt(i.css("left")),posY=n.clientY-parseInt(i.css("top")),e(t).bind("mousemove.drag",function(e){o(e)})}),e(t).mouseup(function(n){n.target==s.get(0)&&e(t).unbind("mousemove.drag")})},setPos:function(n){var r=this,n=e.extend({mode:"center",obj:null,pos:[0,0],offset:[0,0]},n),i=e(n.obj),s=Math.floor(i.height()/2),o=Math.floor(i.width()/2),u=e(window).scrollTop(),a=e(window).height(),f=n.pos[0],l=n.pos[1],c=n.offset[0],h=n.offset[1];i.css({position:"fixed"});if(typeof t.body.style.maxHeight=="undefined"){var p=i.find("select");e("select").not(p).hide()}switch(n.mode){case"win":i.css({left:f+c,top:l+h}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+l+h});break;case"doc":i.css({position:"absolute",left:f+c,top:l+h});break;case"tc":i.css({left:"50%",top:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h});break;case"bc":i.css({left:"50%",bottom:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h+a});break;default:i.css({top:"50%",left:"50%",marginTop:-s-10+h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+a/2})}},pop:function(t){function f(a){t=e.extend(t,a||{}),t.showTitle&&i.append(s),t.outCloseBtn&&o.addClass("s-sopop-out-close"),i.append(o).append(u),t.height&&t.type!="iframe"&&i.css("height",t.height+"px"),i.css({visibility:t.visibility?"visible":"hidden"}),t.type=="content"&&u.html(t.content);if(t.type=="target"){var f=e(t.target).show();u.append(f)}if(t.type=="iframe"){var c=e('<iframe id="'+t.iframeID+'" name="'+t.iframeID+'" src="'+t.iframe+'" width="100%" height="'+t.height+'" frameborder="0" scrolling="auto"></iframe>');u.html(c)}t.type=="ajax"&&u.load(t.ajax.url,t.ajax.data,function(){n.setPos({mode:t.posType,obj:i,pos:t.pos,offset:t.offset}),t.ajax.callback&&t.ajax.callback()});if(t.btn.length>0){var h=e('<p class="p-so-popBtn"></p>');e.each(t.btn,function(){var t=e.extend({cls:null,text:"确定",link:"#",removePop:!0,callback:function(e){}},this),n=e('<a class="a-sopop-btn" href="'+t.link+'"><span class="s-sopop-btn">'+t.text+"</span></a>");t.cls!==null&&n.addClass(t.cls),n.bind("click",function(){return t.callback&&t.callback(l)&&l(),t.removePop&&l(),t.link==="#"?!1:!0}),h.append(n)}),i.append(h)}e("body").append(i),t.showTitle&&t.drag&&(s.addClass("h2-sopop-move"),n.drag(i,s)),t.beforePop(i,s,o,u),r=n.show({mode:t.posType,obj:i,pos:t.pos,offset:t.offset,onlyOne:t.onlyOne},t.showMask,t.onPop(i)),o.bind("click",function(){l()}),r&&t.maskClick&&r.bind("click",function(){l()})}function l(r){t=e.extend(t,r||{}),n.hide(i,t.showMask),e("body").removeData("soonlyone"),t.target!=null&&e(t.target).appendTo("body").hide(),i.remove(),t.closePop()}var n=this,t=e.extend({type:"content",target:null,content:null,iframe:null,iframeID:"sopop-iframe",ajax:{url:null,data:null,callback:function(){}},posType:"center",pos:[0,0],offset:[0,0],cls:null,width:400,height:null,defaultShow:!0,visibility:!0,title:"提示",showTitle:!0,outCloseBtn:!1,showMask:!0,onlyOne:!1,drag:!0,maskClick:!0,btn:[],beforePop:function(){},onPop:function(){},closePop:function(){}},t||{}),r,i=e('<div class="so-popbox '+(t.cls?t.cls:"")+'" style="width:'+t.width+'px;display:none;"></div>'),s=e('<h2 class="h2-sopop"><span class="s-sopop-title">'+t.title+"</span></h2>"),o=e('<span class="s-sopop-close">[关闭]</span>'),u=e('<div class="so-popbox-cont"></div>'),a=e("body").data("soonlyone");return t.defaultShow&&!a&&f(),{wrap:i,mask:r,opt:t,removePop:l,showPop:f}},alert:function(e,t,n){var r=this;r.pop({cls:"so-popAlert",title:e,width:360,content:t,btn:[{text:"确定"}],closePop:n})},confirm:function(e,t,n,r){var i=this;i.pop({cls:"so-popConfirm",title:e,width:360,content:t,btn:[{text:"确定",callback:function(){n&&n()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){r&&r()}}]})},tip:function(t){var n=this,r=null,t=e.extend({cls:"so-popTip",showTitle:!1,posType:"tc",showMask:!1,width:250,stayTime:5e3,offset:[0,5],closePop:function(){r&&clearTimeout(r)}},t||{}),i=n.pop(t);return t.stayTime>0&&(r=setTimeout(function(){i.removePop()},t.stayTime)),i},loading:function(t){var n=this,t=e.extend({type:"content",cls:"so-loading",showTitle:!1,maskClick:!1,width:100,height:36,content:"",stayTime:0,showMask:!1},t||{}),r=n.pop(t);return t.stayTime>0&&setTimeout(function(){r.removePop()},t.stayTime),{open:r.showPop,close:r.removePop}}},e.fn.extend({soIframePop:function(t){var n=e.extend({type:"iframe",targetTag:"href",splitString:"#soIframe?",width:800,height:480,showTitle:!1},t||{}),r=[];return this.each(function(){var t=e(this),i=t.attr(n.targetTag).split(n.splitString),s=i[0];par=i[1]?i[1].split("&"):"";var u={};e.each(par,function(){var e=this.split("=");u[e[0]]=e[1]}),n=e.extend(n,u||{}),n.showTitle=n.showTitle=="true"?1:+n.showTitle,n.iframe=s,n.defaultShow=!1;var a=e.sobox.pop(n);r.push(a),t.click(function(){return a.showPop(),e(this).data("iframePop",a),!1})}),r},soSidePop:function(t){var n=e(this),r=t.event||"click",i=null;return n.bind(r,function(n){var r=e(this).offset(),s=t.por=="mouse"?[n.pageX,n.pageY]:[r.left,r.top],o=e.extend({showMask:!1,posType:"doc",por:"mouse",pos:s,offset:[10,10],onlyOne:!0,returnFalse:!0},t||{});i=e.sobox.pop(o);if(o.returnFalse)return!1}),t.leaveHide==1&&n.bind("mouseout",function(e){i&&i.removePop()}),n},soOverTip:function(t){var n=e(this),r=e.extend({cls:"so-overTip",showMask:!1,posType:"doc",offset:[10,10],showTitle:!1,onlyOne:!0},t||{}),i=null;return n.mouseenter(function(t){r.pos=[t.pageX,t.pageY],i=e.sobox.pop(r)}).mouseleave(function(){i.removePop()}),n},clickPop:function(t){var t=e.extend({optAll:null},t||{}),n=e(this);n.click(function(){var n=e(this).attr("rel"),r=this,s=e(this).attr("popType")||"target";if(n){var u=t.optAll,a=n.split("."),f=a.length;for(i=0;i<f;i++)u=u[a[i]];var l=n.replace(".","_");optT=e.extend({title:e(this).text(),type:s,target:e("#"+l),iframe:e(this).attr("href")},u),optT.beforePop=function(e,t,n,i){u.beforePop&&u.beforePop.call(r,e,t,n,i)},t.optAll.$pop=e.sobox.pop(optT)}})}})}(jQuery,document),define("sobox",["jquery"],function(){}),define("controls/Dialog",["jquery","underscore","sobox"],function(e,t,n){return{pop:function(n){return n=t.extend({},{width:"auto",btn:[{text:n.okText||"确定",removePop:n.okRemovePop==undefined?!0:n.okRemovePop,callback:n.ok},{text:n.cancelText||"取消",cls:"a-sopop-cancel",removePop:!0,callback:n.cancel}]},n),e.sobox.pop(n)},alert:function(){var t,n,r=function(){};if(arguments.length)switch(arguments.length){case 1:t="提示",n=arguments[0];break;case 2:t=arguments[0],n=arguments[1];break;case 3:t=arguments[0],n=arguments[1],r=arguments[2];break;default:}return e.sobox.alert(t,n,r)},confirm:function(t,n,r,i){var s=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips_qa"></i></td>','<td><em class="tipsTxt">',n,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.pop({title:t,content:s,btn:[{text:"确定",callback:function(){r&&r()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){i&&i()}}]})},tips:function(t,n){return e.sobox.tip({cls:"so-popTip",posType:"ct",content:t,width:"auto",height:38,offset:[0,-75],stayTime:n*1e3||4e3})},warn:function(t,n,r){var i=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips"></i></td>','<td><em class="tipsTxt">',t,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.alert("提示",i,r)},loading:function(t){return e.sobox.loading({cls:"so-loading",stayTime:t*1e3||0,width:100,height:100})}}}),typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;typeof JSON.stringify!="function"&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),define("controls/Ajax",["jquery","underscore","controls/Dialog","json2"],function(e,t,n,r){var i={requestId:0,loadingObj:{},defaultOpts:{type:"POST",data:{},dataType:"json",success:function(){},error:function(){i.loadingObj.close&&i.loadingObj.close(),n.tips("Error Request !")},contentType:"text/plain; charset=UTF-8"},request:function(r,i,s){this.requestId++;var o=this;if(!r.url)return;this.url=r.url,s||(o.loadingObj.close&&o.loadingObj.close(),o.loadingObj=n.loading()),r.data&&r.data.parse&&delete r.data.parse,r.data&&r.data.success&&delete r.data.success,r.data&&r.data.error&&delete r.data.error,r.fail=r.fail||function(e){n.tips("Error:"+e.code)},e.ajax(t.extend({},this.defaultOpts,r,{data:JSON.stringify(r.data),success:function(e){s||o.loadingObj.close();if(!e)return;i?r.success(e):e&&e.code&&e.code=="S_OK"&&e.hasOwnProperty("var")?r.success(e["var"]):r.fail({code:e.code,errorCode:e.errorCode,summary:e.summary})},error:function(e){s||o.loadingObj.close();if(e.status==200||e.status==0){window.location.reload();return}r.fail(e)}}))}};return i}),define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.14",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.lastIndexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i[0]==="﻿"&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!modules/../../template/pager.html",[],function(){return'<span class="dik fr">显示从<%=total?(pageSize*(pageIndex-1)+1):0%>到<%=pageSize*pageIndex>total?total:pageSize*pageIndex%>，共<%=total%>条。每页显示：<%=pageSize%></span>\r\n<div class="fl dik">\r\n    <select class="pageSize">\r\n        <option value="10" <%=pageSize==10?"selected":""%>>10</option>\r\n        <option value="20" <%=pageSize==20?"selected":""%>>20</option>\r\n        <option value="40" <%=pageSize==40?"selected":""%>>40</option>\r\n    </select>\r\n    <div class="pageOpera dik">\r\n        <a href="javascript:;"><i class="i-page-first"></i></a> <a href="javascript:;"><i class="i-page-prev"></i></a>\r\n        <span><input type="text" class="pageInput" value="<%=pageIndex%>"> <em>/ <%=pageCount%></em></span>\r\n        <a href="javascript:;"><i class="i-page-next"></i></a> <a href="javascript:;"><i class="i-page-last"></i></a>\r\n        <a href="javascript:;"><i class="i-page-reload"></i></a>\r\n    </div>\r\n</div>\r\n\r\n\r\n'}),define("text!modules/../../template/log.html",[],function(){return'<div>\r\n\r\n    <script type="text/x-handlebars-template" id="log">\r\n\r\n        <div class="log-head">\r\n\r\n            <table width="100%">\r\n                <tr>\r\n                    <td class="td-label"><label>时间：</label></td>\r\n                    <td>\r\n                        <div class="control-timeSet" style="margin-left:0">\r\n                            <input type="text" class="timeSetInput sTime" value=""><em>-</em><input type="text" class="timeSetInput eTime" value="">\r\n                        </div>\r\n                    </td>\r\n                    <td class="td-label"><label for="opUser">操作者：</label></td>\r\n                    <td><input class="inputAdd" type="text" value="" id="opUser"></td>\r\n                    <td class="td-label"><label for="group">所属群组：</label></td>\r\n                    <td><input class="inputAdd" type="text" value="" id="group"></td>\r\n                    <td rowspan="3" valign="bottom"><a href="javascript:;" class="btn_blue2 btn28 btn-ok">确定</a></td>\r\n                </tr>\r\n\r\n                <tr>\r\n                    <td height="10"></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n                    <td></td>\r\n\r\n                </tr>\r\n                <tr>\r\n                    <td class="td-label"><label for="opType">操作类型：</label></td>\r\n                    <td><select class="real-select" id="opType">\r\n                        <option value="0">全部</option>\r\n                        <option value="data">数据</option>\r\n                        <option value="user">用户</option>\r\n                        <option value="team">团队</option>\r\n                        <option value="grant">授权</option>\r\n                    </select></td>\r\n                    <td class="td-label"><label for="action">动作：</label></td>\r\n                    <td><select class="real-select" id="action">\r\n                        <option value="0">全部</option>\r\n                    </select></td>\r\n                    <td class="td-label"><label for="type">渠道：</label></td>\r\n                    <td><select class="real-select" id="type">\r\n                        <option value="0">全部</option>\r\n                        <option value="1">WEB</option>\r\n                        <option value="2">PC客户端</option>\r\n                        <option value="3">手机客户端</option>\r\n                    </select></td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div id="logList">\r\n            <div class="tableBox">\r\n                <table width="100%" class="tableList">\r\n                    <thead></thead>\r\n                    <tbody></tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n        <div class="pageBox clearfix"></div>\r\n\r\n    </script>\r\n\r\n    <script type="text/x-handlebars-template" id="log-title">\r\n        <tr>\r\n            <th width="25" scope="col">&nbsp;</th>\r\n            <th width="18%" scope="col">时间</th>\r\n            <th width="45%" scope="col">动作</th>\r\n            <th width="15%" scope="col">操作者</th>\r\n            <th scope="col">IP</th>\r\n        </tr>\r\n    </script>\r\n\r\n    <script type="text/x-handlebars-template" id="log-row">\r\n        <tr>\r\n            <td>&nbsp;</td>\r\n            <td><span class="tf"><%=createDate%></span></td>\r\n            <td><span class="tf" title="<%=operate%>"><%=operate%></span></td>\r\n            <td><span class="tf"><%=userName%></span></td>\r\n            <td><%=ip%></td>\r\n        </tr>\r\n    </script>\r\n\r\n</div>'}),define("controls/List",["jquery","underscore"],function(e,t){var n=function(e){this.option=e,this.data=this.option.data,this.option.operate&&(this.operateList=this.option.operate.list),this.Fn={};var n=this;return this.operateList&&this.operateList.length&&t.each(this.operateList,function(e){n.Fn[e.action]=e.onClick}),t.each(this.option.columns,function(e){e.action&&(n.Fn[e.action]=e.onClick)}),this.init(),this.html=[],this};return n.prototype={init:function(){this.render(),this.initEvents(),this.option.hasCheckBtn&&this.initCheck()},getTitleHtml:function(){var e=this,n=["<tr>"];return this.option.hasCheckBtn&&n.push(['<th width="25" style="padding-left:20px;"><input class="checkAll" type="checkbox"></th>'].join("")),t.each(this.option.columns,function(e){n.push(['<th scope="col"',e.titleStyle?' style="'+e.titleStyle+'"':"",e.titleAttr,">",e.columnName,"</th>"].join(""))}),e.option.operate&&e.option.operate.list&&e.option.operate.list.length&&n.push(['<th scope="col"',e.option.operate.titleStyle?' style="'+e.option.operate.titleStyle+'"':"",e.option.operate.titleAttr,">",e.option.operate.columnName,"</th>"].join("")),n.push("</tr>"),n.join("")},getListHtml:function(){var e=this,n=[];if(!e.data.length){var r=e.option.columns.length+(e.option.hasCheckBtn?1:0)+(e.option.operate?1:0);return'<tr class="no-data"><td colspan="'+r+'" align="center"><div class="tipsNoDate"><h5><i class="i-noDate"></i></h5><h4>暂无数据</h4></div></td></tr>'}return t.each(e.data,function(r){var i;e.option.rowClass&&typeof e.option.rowClass=="function"&&(i=e.option.rowClass(r));var s=["<tr",i?' class="'+i+'"':"",' data-key="',r[e.option.key],'">'];e.option.hasCheckBtn&&s.push(['<td style="padding-left:20px;"><input type="checkbox" class="list-checkbox" value="',r[e.option.key],'"></td>'].join("")),t.each(e.option.columns,function(e){var t=r[e.columnId],n=e.callback(t)||t||"";s.push(['<td data-columnId="',e.columnId,'">',n,"</td>"].join(""))}),e.option.operate&&e.option.operate.list&&e.option.operate.list.length&&(s.push("<td>"),t.each(e.option.operate.list,function(e){s.push(['<a href="javascript:;" class="',e.className,'" data-action="',e.action,'">',e.name,"</a>"].join(""))}),s.push("</td>")),s.push("</tr>"),n.push(s.join(""))}),n.join("")},render:function(){var t=this.getTitleHtml(),n=this.getListHtml(),r=['<div class="tableBox"><table width="100%" class="tableList"><tbody>',t,n,"</tbody></table></div>"];e(this.option.container).html(r.join(""))},initEvents:function(){var n=this;e(this.option.container).off("click.list").on("click.list",function(r){var i=e(r.target),s=i.parents("td").length?i.parents("td"):i,o=i.parents("tr"),u=o.data("key"),a=i.data("action");if(a){var f=t.find(n.data,function(e){return e[n.option.key]==u});n.Fn[a]&&typeof n.Fn[a]=="function"&&n.Fn[a](f,s,o)}})},getSelected:function(){var n=this,r=[];return e(this.option.container).find(".list-checkbox:checked").each(function(){var i=e(this).val(),s=t.find(n.data,function(e){return e[n.option.key]==i});r.push(s)}),r},initCheck:function(){var t=this;this.$container=e(this.option.container),this.$listCheckbox=this.$container.find(".list-checkbox"),this.$checkAll=e(this.option.container).find(".checkAll"),this.$checkAll.off("change.list").on("change.list",function(){var n=e(this).prop("checked");t.$listCheckbox.prop("checked",n)}),this.$listCheckbox.off("change.list").on("change.list",function(){var e=t.$container.find(".list-checkbox:checked").length;t.$checkAll.prop("checked",t.data.length==e)})},destroyEvents:function(){this.$checkAll&&this.$checkAll.off("change.list"),this.$listCheckbox&&this.$listCheckbox.off("change.list")},setData:function(e){this.destroyEvents(),this.data=e,this.init()}},n}),function(e){typeof define=="function"&&define.amd?define("jqueryUI",["jquery"],e):e(jQuery)}(function(e){function t(t,r){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,!t.href||!s||i.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap='#"+s+"']")[0],!!o&&n(o))):(/^(input|select|textarea|button|object)$/.test(u)?!t.disabled:"a"===u?t.href||r:r)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}function i(e){var t,n;while(e.length&&e[0]!==document){t=e.css("position");if(t==="absolute"||t==="relative"||t==="fixed"){n=parseInt(e.css("zIndex"),10);if(!isNaN(n)&&n!==0)return n}e=e.parent()}return 0}function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=o(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function o(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",u)}function u(){e.datepicker._isDisabledDatepicker(r.inline?r.dpDiv.parent()[0]:r.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&e(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&e(this).addClass("ui-datepicker-next-hover"))}function a(t,n){e.extend(t,n);for(var r in n)n[r]==null&&(t[r]=n[r]);return t}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var n=this.css("position"),r=n==="absolute",i=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=e(this);return r&&t.css("position")==="static"?!1:i.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return n==="fixed"||!s.length?e(this[0].ownerDocument||document):s},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var r=e.attr(n,"tabindex"),i=isNaN(r);return(i||r>=0)&&t(n,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function o(t,n,i,s){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r=n==="Width"?["Left","Right"]:["Top","Bottom"],i=n.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return t===undefined?s["inner"+n].call(this):this.each(function(){e(this).css(i,o(this,t)+"px")})},e.fn["outer"+n]=function(t,r){return typeof t!="number"?s["outer"+n].call(this,t):this.each(function(){e(this).css(i,o(this,t,!0,r)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,r){return typeof n=="number"?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(t!==undefined)return this.css("zIndex",t);if(this.length){var n=e(this[0]),r,i;while(n.length&&n[0]!==document){r=n.css("position");if(r==="absolute"||r==="relative"||r==="fixed"){i=parseInt(n.css("zIndex"),10);if(!isNaN(i)&&i!==0)return i}n=n.parent()}}return 0}}),e.ui.plugin={add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n,r){var i,s=e.plugins[t];if(!s)return;if(!r&&(!e.element[0].parentNode||e.element[0].parentNode.nodeType===11))return;for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}},e.extend(e.ui,{datepicker:{version:"1.11.4"}});var r;e.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return a(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i=r==="div"||r==="span",t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),r==="input"?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?o(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]);if(r.hasClass(this.markerClassName))return;this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,"datepicker",n),n.settings.disabled&&this._disableDatepicker(t)},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),(r==="focus"||r==="both")&&t.focus(this._showDatepicker);if(r==="button"||r==="both")i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){n=0,r=0;for(i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);if(r.hasClass(this.markerClassName))return;r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,"datepicker",n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block")},_dialogDatepicker:function(t,n,r,i,s){var o,u,f,l,c,h=this._dialogInst;return h||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),h=this._dialogInst=this._newInst(this._dialogInput,!1),h.settings={},e.data(this._dialogInput[0],"datepicker",h)),a(h.settings,i||{}),n=n&&n.constructor===Date?this._formatDate(h,n):n,this._dialogInput.val(n),this._pos=s?s.length?s:[s.pageX,s.pageY]:null,this._pos||(u=document.documentElement.clientWidth,f=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[u/2-100+l,f/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),h.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",h),this},_destroyDatepicker:function(t){var n,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),n==="input"?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(n==="div"||n==="span")&&i.removeClass(this.markerClassName).empty(),r===s&&(r=null)},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e})},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,"datepicker");if(!i.hasClass(this.markerClassName))return;n=t.nodeName.toLowerCase();if(n==="input")t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(n==="div"||n==="span")r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0);this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,n,r){var i,s,o,u,f=this._getInst(t);if(arguments.length===2&&typeof n=="string")return n==="defaults"?e.extend({},e.datepicker._defaults):f?n==="all"?e.extend({},f.settings):this._get(f,n):null;i=n||{},typeof n=="string"&&(i={},i[n]=r),f&&(this._curInst===f&&this._hideDatepicker(),s=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(f,"min"),u=this._getMinMaxDate(f,"max"),a(f.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(f.settings.minDate=this._formatDate(f,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(f.settings.maxDate=this._formatDate(f,u)),"disabled"in i&&(i.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),f),this._autoSize(f),this._setDate(f,s),this._updateAlternate(f),this._updateDatepicker(f))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");s._keyEvent=!0;if(e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else t.keyCode===36&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);if(e.datepicker._get(i,"constrainInput"))return n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!n||n.indexOf(r)>-1},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=e("input",t.parentNode)[0]);if(e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)return;var n,r,s,o,u,f,l;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),s=r?r.apply(t,[t,n]):{};if(s===!1)return;a(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|=e(this).css("position")==="fixed",!o}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(f=e.datepicker._get(n,"showAnim"),l=e.datepicker._get(n,"duration"),n.dpDiv.css("z-index",i(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[f]?n.dpDiv.show(f,e.datepicker._get(n,"showOptions"),l):n.dpDiv[f||"show"](f?l:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,r=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var n,i=this._getNumberOfMonths(t),s=i[1],o=17,a=t.dpDiv.find("."+this._dayOverClass+" a");a.length>0&&u.apply(a.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),t.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){var n,r=this._getInst(t),i=this._get(r,"isRTL");while(t&&(t.type==="hidden"||t.nodeType!==1||e.expr.filters.hidden(t)))t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,o=this._curInst;if(!o||t&&o!==e.data(t,"datepicker"))return;this._datepickerShowing&&(n=this._get(o,"showAnim"),r=this._get(o,"duration"),i=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[n]||e.effects[n])?o.dpDiv.hide(n,e.datepicker._get(o,"showOptions"),r,i):o.dpDiv[n==="slideDown"?"slideUp":n==="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(o,"onClose"),s&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(!e.datepicker._curInst)return;var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&n.parents("#"+e.datepicker._mainDivId).length===0&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);if(this._isDisabledDatepicker(i[0]))return;this._adjustInstDate(s,n+(r==="M"?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s)},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+(r==="M"?"Month":"Year")]=s["draw"+(r==="M"?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);if(e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0]))return;s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=n!=null?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],typeof s.input[0]!="object"&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(t==null||n==null)throw"Invalid arguments";n=typeof n=="object"?n.toString():n+"";if(n==="")return null;var i,s,o,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=typeof a!="string"?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,b,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r=e==="@"?14:e==="!"?20:e==="y"&&t?4:e==="o"?3:2,i=e==="y"?r:1,s=new RegExp("^\\d{"+i+","+r+"}"),o=n.substring(u).match(s);if(!o)throw"Missing number at position "+u;return u+=o[0].length,parseInt(o[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});e.each(o,function(e,t){var r=t[1];if(n.substr(u,r.length).toLowerCase()===r.toLowerCase())return s=t[0],u+=r.length,!1});if(s!==-1)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)t.charAt(i)==="'"&&!w("'")?y=!1:x();else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length){o=n.substr(u);if(!/^\s+/.test(o))throw"Extra/unparsed characters found in date: "+o}d===-1?d=(new Date).getFullYear():d<100&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d<=f?0:-100));if(g>-1){v=1,m=g;do{s=this._getDaysInMonth(d,v-1);if(m<=s)break;v++,m-=s}while(!0)}b=this._daylightSavingAdjust(new Date(d,v-1,m));if(b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))while(r.length<n)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)e.charAt(r)==="'"&&!a("'")?h=!1:c+=e.charAt(r);else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)e.charAt(t)==="'"&&!i("'")?r=!1:n+=e.charAt(t);else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()===e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);while(f){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=parseInt(f[1],10)*7;break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=n==null||n===""?r:typeof n=="string"?s(n):typeof n=="number"?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&o.toString()==="Invalid Date"?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()===""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=V[0]!==1||V[1]!==1,Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;Z<0&&(Z+=12,et--);if(Y){t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&t<G?G:t;while(this._daylightSavingAdjust(new Date(et,Z,1))>t)Z--,Z<0&&(Z=11,et--)}e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E;for(S=0;S<V[0];S++){x="",this.maxRows=4;for(T=0;T<V[1];T++){N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="";if(K){k+="<div class='ui-datepicker-group";if(V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&S===0?U?s:r:"")+(/all|right/.test(C)&&S===0?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"";for(E=0;E<7;E++)A=(E+l)%7,L+="<th scope='col'"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M));for(H=0;H<D;H++){k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"";for(E=0;E<7;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&P<G||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+((!F||g)&&j[2]?" title='"+j[2].replace(/'/g,"&#39;")+"'":"")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(l=0;l<12;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}y||(b+=w+(s||!m||!g?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;d<=v;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}}return b+=this._get(e,"yearSuffix"),y&&(b+=(s||!m||!g?"&#xa0;":"")+w),b+="</div>",b},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n==="Y"?t:0),i=e.drawMonth+(n==="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n==="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n==="M"||n==="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),e("#"+e.datepicker._mainDivId).length===0&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return typeof t!="string"||t!=="isDisabled"&&t!=="getDate"&&t!=="widget"?t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){typeof t=="string"?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new s,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4";var f=e.datepicker}),!function(){if(!window.CustomEvent&&document.createEventObject)return void (window.CustomEvent=function(e,t){if(!arguments.length)throw new Error("Not enough arguments");var n={type:e,bubbles:!1,cancelable:!1,detail:null},r=document.createEventObject();for(var i in n)r[i]=n[i];for(var i in t)r[i]=t[i];return r});try{new CustomEvent("test")}catch(e){var t=function(e,t){if(!arguments.length)throw new Error("Not enough arguments");var n={bubbles:!1,cancelable:!1,detail:null};for(var r in t)n[r]=t[r];var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),i};t.prototype=(window.CustomEvent||window.Event).prototype,window.CustomEvent=t}}(),function(){if(!document.addEventListener&&window.Element&&window.Event){var e="__events",t="__immediateStopped";Event.prototype.NONE=Event.NONE=0,Event.prototype.CAPTURING_PHASE=Event.CAPTURING_PHASE=1,Event.prototype.AT_TARGET=Event.AT_TARGET=2,Event.prototype.BUBBLING_PHASE=Event.BUBBLING_PHASE=3,Event.prototype.preventDefault=function(){this.cancelable!==!1&&(this.returnValue=!1)},Event.prototype.stopPropagation=function(){this.cancelBubble=!0},Event.prototype.stopImmediatePropagation=function(){this[t]=this.cancelBubble=!0};for(var n=function(e,t){return e.timeStamp=+(new Date),e.target||(e.target=e.srcElement||t),e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop,e.relatedTarget="mouseover"==e.type?e.fromElement:"mouseout"==e.type?e.toElement:null,e},r=function(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(i.useCapture==n&&i.listener==t)return r}return-1},i=function(e,t,n){e.currentTarget=n,"function"==typeof t?t.call(n,e):t.handleEvent(e)},s=function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t},o=function(n,r,s){n.eventPhase=s;for(var o=0;o<r.length;o++){for(var u=r[o],a=[],f=(u[e]||{})[n.type]||[],l=0;l<f.length;l++){var c=f[l];c.useCapture&&s==Event.BUBBLING_PHASE||(c.useCapture||s!=Event.CAPTURING_PHASE)&&a.push(c.listener)}for(l=0;l<a.length;)try{for(;l<a.length;){var h=a[l++];if(i(n,h,u),n[t])return!0}}catch(p){setTimeout(function(){throw p},0)}if(n.cancelBubble)return!0}return!1},u=function(e){n(e,this);var t=s(e.target);return t.length&&o(e,t,Event.CAPTURING_PHASE)?e.returnValue:o(e,[e.target],Event.AT_TARGET)?e.returnValue:t.length&&e.bubbles!==!1&&(t.reverse(),o(e,t,Event.BUBBLING_PHASE))?e.returnValue:(e.stopPropagation(),e.returnValue)},a={addEventListener:function(t,n,i){var s=this,o=(this[e]||{})[t]||[],a=o.length;if(!(r(o,n,i)>-1)){if(e in this)var f=this[e];else{var f={_handler:function(){u.apply(s,arguments)}};this[e]=f}t in f||(f[t]=[]),f[t].push({listener:n,useCapture:i}),a||this.attachEvent("on"+t,f._handler)}},removeEventListener:function(t,n,i){var s=(this[e]||{})[t]||[],o=r(s,n,i);-1!=o&&(s.splice(o,1),s.length||this.detachEvent("on"+t,this[e]._handler))},dispatchEvent:function(e){return e.returnValue=!0,u.call(this,e)}},f=[Element,window.constructor,document.constructor];f.length;){var l=f.pop();for(var c in a)l.prototype[c]=a[c]}}}(),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,r;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),s=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=0;s>r;){var o;r in i&&(o=i[r],e.call(n,o,r,i)),r++}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return-1;var s=+t||0;if(Math.abs(s)===1/0&&(s=0),s>=i)return-1;for(n=Math.max(s>=0?s:i-Math.abs(s),0);i>n;){if(n in r&&r[n]===e)return n;n++}return-1}),function(e){var t;if("object"==typeof exports){try{t=require("jquery")}catch(n){}module.exports=e(window,document,t)}else window.Dropkick=e(window,document,window.jQuery)}(function(e,t,n,r){var i,s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),o=e.parent!==e.self&&location.host===parent.location.host,u=-1!==navigator.appVersion.indexOf("MSIE"),a=function(n,r){var i,s;if(this===e)return new a(n,r);for("string"==typeof n&&"#"===n[0]&&(n=t.getElementById(n.substr(1))),i=0;i<a.uid;i++)if(s=a.cache[i],s instanceof a&&s.data.select===n)return c.extend(s.data.settings,r),s;return n?"SELECT"===n.nodeName?this.init(n,r):void 0:(console.error("You must pass a select to DropKick"),!1)},f=function(){},l={initialize:f,change:f,open:f,close:f,search:"strict",bubble:!0},c={hasClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return e&&n.test(e.className)},addClass:function(e,t){e&&!c.hasClass(e,t)&&(e.className+=" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e&&(e.className=e.className.replace(n," "))},toggleClass:function(e,t){var n=c.hasClass(e,t)?"remove":"add";c[n+"Class"](e,t)},extend:function(e){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)e[n]=t[n]}),e},offset:function(n){var r=n.getBoundingClientRect()||{top:0,left:0},i=t.documentElement,s=u?i.scrollTop:e.pageYOffset,o=u?i.scrollLeft:e.pageXOffset;return{top:r.top+s-i.clientTop,left:r.left+o-i.clientLeft}},position:function(e,t){for(var n={top:0,left:0};e&&e!==t;)n.top+=e.offsetTop,n.left+=e.offsetLeft,e=e.parentNode;return n},closest:function(e,t){for(;e;){if(e===t)return e;e=e.parentNode}return!1},create:function(e,n){var r,i=t.createElement(e);n||(n={});for(r in n)n.hasOwnProperty(r)&&("innerHTML"===r?i.innerHTML=n[r]:i.setAttribute(r,n[r]));return i},deferred:function(t){return function(){var n=arguments,r=this;e.setTimeout(function(){t.apply(r,n)},1)}}};return a.cache={},a.uid=0,a.prototype={add:function(e,n){var r,i,s;"string"==typeof e&&(r=e,e=t.createElement("option"),e.text=r),"OPTION"===e.nodeName&&(i=c.create("li",{"class":"dk-option","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:"dk"+this.data.cacheID+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(i,e.className),this.length+=1,e.disabled&&(c.addClass(i,"dk-option-disabled"),i.setAttribute("aria-disabled","true")),this.data.select.add(e,n),"number"==typeof n&&(n=this.item(n)),this.options.indexOf(n)>-1?n.parentNode.insertBefore(i,n):this.data.elem.lastChild.appendChild(i),i.addEventListener("mouseover",this),s=this.options.indexOf(n),this.options.splice(s,0,i),e.selected&&this.select(s))},item:function(e){return e=0>e?this.options.length+e:e,this.options[e]||null},remove:function(e){var t=this.item(e);t.parentNode.removeChild(t),this.options.splice(e,1),this.data.select.remove(e),this.select(this.data.select.selectedIndex),this.length-=1},init:function(e,n){var r,u=a.build(e,"dk"+a.uid);if(this.data={},this.data.select=e,this.data.elem=u.elem,this.data.settings=c.extend({},l,n),this.disabled=e.disabled,this.form=e.form,this.length=e.length,this.multiple=e.multiple,this.options=u.options.slice(0),this.selectedIndex=e.selectedIndex,this.selectedOptions=u.selected.slice(0),this.value=e.value,this.data.cacheID=a.uid,a.cache[this.data.cacheID]=this,this.data.settings.initialize.call(this),a.uid+=1,this._changeListener||(e.addEventListener("change",this),this._changeListener=!0),!s||this.data.settings.mobile){if(e.parentNode.insertBefore(this.data.elem,e),e.setAttribute("data-dkCacheId",this.data.cacheID),this.data.elem.addEventListener("click",this),this.data.elem.addEventListener("keydown",this),this.data.elem.addEventListener("keypress",this),this.form&&this.form.addEventListener("reset",this),!this.multiple)for(r=0;r<this.options.length;r++)this.options[r].addEventListener("mouseover",this);i||(t.addEventListener("click",a.onDocClick),o&&parent.document.addEventListener("click",a.onDocClick),i=!0)}return this},close:function(){var e,t=this.data.elem;if(!this.isOpen||this.multiple)return!1;for(e=0;e<this.options.length;e++)c.removeClass(this.options[e],"dk-option-highlight");t.lastChild.setAttribute("aria-expanded","false"),c.removeClass(t.lastChild,"dk-select-options-highlight"),c.removeClass(t,"dk-select-open-(up|down)"),this.isOpen=!1,this.data.settings.close.call(this)},open:c.deferred(function(){var n,r,i,s,o,a,f=this.data.elem,l=f.lastChild;return o=u?c.offset(f).top-t.documentElement.scrollTop:c.offset(f).top-e.scrollY,a=e.innerHeight-(o+f.offsetHeight),this.isOpen||this.multiple?!1:(l.style.display="block",n=l.offsetHeight,l.style.display="",r=o>n,i=a>n,s=r&&!i?"-up":"-down",this.isOpen=!0,c.addClass(f,"dk-select-open"+s),l.setAttribute("aria-expanded","true"),this._scrollTo(this.options.length-1),this._scrollTo(this.selectedIndex),void this.data.settings.open.call(this))}),disable:function(e,t){var n="dk-option-disabled";(0===arguments.length||"boolean"==typeof e)&&(t=e===r?!0:!1,e=this.data.elem,n="dk-select-disabled",this.disabled=t),t===r&&(t=!0),"number"==typeof e&&(e=this.item(e)),c[t?"addClass":"removeClass"](e,n)},select:function(e,t){var n,r,i,s,o=this.data.select;if("number"==typeof e&&(e=this.item(e)),"string"==typeof e)for(n=0;n<this.length;n++)this.options[n].getAttribute("data-value")===e&&(e=this.options[n]);return!e||"string"==typeof e||!t&&c.hasClass(e,"dk-option-disabled")?!1:c.hasClass(e,"dk-option")?(r=this.options.indexOf(e),i=o.options[r],this.multiple?(c.toggleClass(e,"dk-option-selected"),i.selected=!i.selected,c.hasClass(e,"dk-option-selected")?(e.setAttribute("aria-selected","true"),this.selectedOptions.push(e)):(e.setAttribute("aria-selected","false"),r=this.selectedOptions.indexOf(e),this.selectedOptions.splice(r,1))):(s=this.data.elem.firstChild,this.selectedOptions.length&&(c.removeClass(this.selectedOptions[0],"dk-option-selected"),this.selectedOptions[0].setAttribute("aria-selected","false")),c.addClass(e,"dk-option-selected"),e.setAttribute("aria-selected","true"),s.setAttribute("aria-activedescendant",e.id),s.className="dk-selected "+i.className,s.innerHTML=i.text,this.selectedOptions[0]=e,i.selected=!0),this.selectedIndex=o.selectedIndex,this.value=o.value,t||this.data.select.dispatchEvent(new CustomEvent("change",{bubbles:this.data.settings.bubble})),e):void 0},selectOne:function(e,t){return this.reset(!0),this._scrollTo(e),this.select(e,t)},search:function(e,t){var n,r,i,s,o,u,a,f,l=this.data.select.options,c=[];if(!e)return this.options;for(t=t?t.toLowerCase():"strict",t="fuzzy"===t?2:"partial"===t?1:0,f=new RegExp((t?"":"^")+e,"i"),n=0;n<l.length;n++)if(i=l[n].text.toLowerCase(),2==t){for(r=e.toLowerCase().split(""),s=o=u=a=0;o<i.length;)i[o]===r[s]?(u+=1+u,s++):u=0,a+=u,o++;s===r.length&&c.push({e:this.options[n],s:a,i:n})}else f.test(i)&&c.push(this.options[n]);return 2===t&&(c=c.sort(function(e,t){return t.s-e.s||e.i-t.i}).reduce(function(e,t){return e[e.length]=t.e,e},[])),c},focus:function(){this.disabled||(this.multiple?this.data.elem:this.data.elem.children[0]).focus()},reset:function(e){var t,n=this.data.select;for(this.selectedOptions.length=0,t=0;t<n.options.length;t++)n.options[t].selected=!1,c.removeClass(this.options[t],"dk-option-selected"),this.options[t].setAttribute("aria-selected","false"),!e&&n.options[t].defaultSelected&&this.select(t,!0);this.selectedOptions.length||this.multiple||this.select(0,!0)},refresh:function(){this.dispose().init(this.data.select,this.data.settings)},dispose:function(){return delete a.cache[this.data.cacheID],this.data.elem.parentNode.removeChild(this.data.elem),this.data.select.removeAttribute("data-dkCacheId"),this},handleEvent:function(e){if(!this.disabled)switch(e.type){case"click":this._delegate(e);break;case"keydown":this._keyHandler(e);break;case"keypress":this._searchOptions(e);break;case"mouseover":this._highlight(e);break;case"reset":this.reset();break;case"change":this.data.settings.change.call(this)}},_delegate:function(t){var n,r,i,s,o=t.target;if(c.hasClass(o,"dk-option-disabled"))return!1;if(this.multiple){if(c.hasClass(o,"dk-option"))if(n=e.getSelection(),"Range"===n.type&&n.collapseToStart(),t.shiftKey)if(i=this.options.indexOf(this.selectedOptions[0]),s=this.options.indexOf(this.selectedOptions[this.selectedOptions.length-1]),r=this.options.indexOf(o),r>i&&s>r&&(r=i),r>s&&s>i&&(s=i),this.reset(!0),s>r)for(;s+1>r;)this.select(r++);else for(;r>s-1;)this.select(r--);else t.ctrlKey||t.metaKey?this.select(o):(this.reset(!0),this.select(o))}else this[this.isOpen?"close":"open"](),c.hasClass(o,"dk-option")&&this.select(o)},_highlight:function(e){var t,n=e.target;if(!this.multiple){for(t=0;t<this.options.length;t++)c.removeClass(this.options[t],"dk-option-highlight");c.addClass(this.data.elem.lastChild,"dk-select-options-highlight"),c.addClass(n,"dk-option-highlight")}},_keyHandler:function(e){var t,n,r=this.selectedOptions,i=this.options,s=1,o={tab:9,enter:13,esc:27,space:32,up:38,down:40};switch(e.keyCode){case o.up:s=-1;case o.down:if(e.preventDefault(),t=r[r.length-1],c.hasClass(this.data.elem.lastChild,"dk-select-options-highlight"))for(c.removeClass(this.data.elem.lastChild,"dk-select-options-highlight"),n=0;n<i.length;n++)c.hasClass(i[n],"dk-option-highlight")&&(c.removeClass(i[n],"dk-option-highlight"),t=i[n]);s=i.indexOf(t)+s,s>i.length-1?s=i.length-1:0>s&&(s=0),this.data.select.options[s].disabled||(this.reset(!0),this.select(s),this._scrollTo(s));break;case o.space:if(!this.isOpen){e.preventDefault(),this.open();break};case o.tab:case o.enter:for(s=0;s<i.length;s++)c.hasClass(i[s],"dk-option-highlight")&&this.select(s);case o.esc:this.isOpen&&(e.preventDefault(),this.close())}},_searchOptions:function(e){var t,n=this,i=String.fromCharCode(e.keyCode||e.which),s=function(){n.data.searchTimeout&&clearTimeout(n.data.searchTimeout),n.data.searchTimeout=setTimeout(function(){n.data.searchString=""},1e3)};this.data.searchString===r&&(this.data.searchString=""),s(),this.data.searchString+=i,t=this.search(this.data.searchString,this.data.settings.search),t.length&&(c.hasClass(t[0],"dk-option-disabled")||this.selectOne(t[0]))},_scrollTo:function(e){var t,n,r,i=this.data.elem.lastChild;return-1===e||"number"!=typeof e&&!e||!this.isOpen&&!this.multiple?!1:("number"==typeof e&&(e=this.item(e)),t=c.position(e,i).top,n=t-i.scrollTop,r=n+e.offsetHeight,void (r>i.offsetHeight?(t+=e.offsetHeight,i.scrollTop=t-i.offsetHeight):0>n&&(i.scrollTop=t)))}},a.build=function(e,t){var n,r,i,s=[],o={elem:null,options:[],selected:[]},u=function(e){var n,r,i,s,a=[];switch(e.nodeName){case"OPTION":n=c.create("li",{"class":"dk-option ","data-value":e.value,innerHTML:e.text,role:"option","aria-selected":"false",id:t+"-"+(e.id||e.value.replace(" ","-"))}),c.addClass(n,e.className),e.disabled&&(c.addClass(n,"dk-option-disabled"),n.setAttribute("aria-disabled","true")),e.selected&&(c.addClass(n,"dk-option-selected"),n.setAttribute("aria-selected","true"),o.selected.push(n)),o.options.push(this.appendChild(n));break;case"OPTGROUP":for(r=c.create("li",{"class":"dk-optgroup"}),e.label&&r.appendChild(c.create("div",{"class":"dk-optgroup-label",innerHTML:e.label})),i=c.create("ul",{"class":"dk-optgroup-options"}),s=e.children.length;s--;a.unshift(e.children[s]));a.forEach(u,i),this.appendChild(r).appendChild(i)}};for(o.elem=c.create("div",{"class":"dk-select"+(e.multiple?"-multi":"")}),r=c.create("ul",{"class":"dk-select-options",id:t+"-listbox",role:"listbox"}),e.disabled&&c.addClass(o.elem,"dk-select-disabled"),o.elem.id=t+(e.id?"-"+e.id:""),c.addClass(o.elem,e.className),e.multiple?(o.elem.setAttribute("tabindex",e.getAttribute("tabindex")||"0"),r.setAttribute("aria-multiselectable","true")):(n=e.options[e.selectedIndex],o.elem.appendChild(c.create("div",{"class":"dk-selected "+n.className,tabindex:e.tabindex||0,innerHTML:n?n.text:"&nbsp;",id:t+"-combobox","aria-live":"assertive","aria-owns":r.id,role:"combobox"})),r.setAttribute("aria-expanded","false")),i=e.children.length;i--;s.unshift(e.children[i]));return s.forEach(u,o.elem.appendChild(r)),o},a.onDocClick=function(e){var t,n;if(1!==e.target.nodeType)return!1;null!==(t=e.target.getAttribute("data-dkcacheid"))&&a.cache[t].focus();for(n in a.cache)c.closest(e.target,a.cache[n].data.elem)||n===t||a.cache[n].disabled||a.cache[n].close()},n!==r&&(n.fn.dropkick=function(){var e=Array.prototype.slice.call(arguments);return n(this).each(function(){e[0]&&"object"!=typeof e[0]?"string"==typeof e[0]&&a.prototype[e[0]].apply(new a(this),e.slice(1)):new a(this,e[0]||{})})}),a}),define("dropkick",["jquery"],function(){}),define("text!controls/../../template/pager.html",[],function(){return'<span class="dik fr">显示从<%=total?(pageSize*(pageIndex-1)+1):0%>到<%=pageSize*pageIndex>total?total:pageSize*pageIndex%>，共<%=total%>条。每页显示：<%=pageSize%></span>\r\n<div class="fl dik">\r\n    <select class="pageSize">\r\n        <option value="10" <%=pageSize==10?"selected":""%>>10</option>\r\n        <option value="20" <%=pageSize==20?"selected":""%>>20</option>\r\n        <option value="40" <%=pageSize==40?"selected":""%>>40</option>\r\n    </select>\r\n    <div class="pageOpera dik">\r\n        <a href="javascript:;"><i class="i-page-first"></i></a> <a href="javascript:;"><i class="i-page-prev"></i></a>\r\n        <span><input type="text" class="pageInput" value="<%=pageIndex%>"> <em>/ <%=pageCount%></em></span>\r\n        <a href="javascript:;"><i class="i-page-next"></i></a> <a href="javascript:;"><i class="i-page-last"></i></a>\r\n        <a href="javascript:;"><i class="i-page-reload"></i></a>\r\n    </div>\r\n</div>\r\n\r\n\r\n'}),define("controls/PagerView",["jquery","underscore","backbone","controls/Common","text!../../template/pager.html"],function(e,t,n,r,i){return n.View.extend({initialize:function(e){this.dataModel=e.dataModel,this.listenTo(this.dataModel,"change",this.render),this.render()},render:function(){var e=this.model.toJSON(),n=this.dataModel.toJSON(),s=t.extend({total:0,pageIndex:1,pageSize:10,pageCount:Math.ceil(n.total/n.pageSize)},e,n),o=r.tpl2Html(i,s);this.$el.html(o)},events:{"change .pageSize":"changePageSize","click .i-page-first":"firstPage","click .i-page-prev":"prevPage","keyup .pageInput":"goPage","click .i-page-next":"nextPage","click .i-page-last":"lastPage","click .i-page-reload":"reload"},changePageSize:function(t){var n=e(t.currentTarget).val();this.model.set({pageIndex:1,pageSize:~~n})},firstPage:function(){this.model.set({pageIndex:1})},lastPage:function(){var e=this.dataModel.attributes,t=Math.ceil(e.total/e.pageSize);if(t==0)return;this.model.set({pageIndex:t})},prevPage:function(){var e=this.model.attributes.pageIndex,t=e-1;this.model.set({pageIndex:t>1?t:1})},nextPage:function(){var e=this.model.attributes.pageIndex,t=this.dataModel.attributes,n=Math.ceil(t.total/t.pageSize),r=e+1>n?n:e+1;if(n==0||r==0)return;this.model.set({pageIndex:r})},goPage:function(t){if(t.keyCode!=13)return;var n=e(t.currentTarget).val(),r=this.dataModel.attributes,i=Math.ceil(r.total/r.pageSize);if(n<1||n>i)return;this.model.set({pageIndex:~~n})},reload:function(){this.getData()},getData:function(){this.model.trigger("change")},destroy:function(){this.undelegateEvents(),this.stopListening()}})}),define("modules/log",["jquery","underscore","controls/Common","backbone","controls/Ajax","controls/Dialog","text!../../template/pager.html","text!../../template/log.html","controls/List","i18n/"+global.language,"jqueryUI","dropkick","controls/PagerView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=r,d=p.Model,v=p.View,m=window.typeAndAction||{data:[{text:"全部",value:0},{text:"上传文件",value:"upload"},{text:"下载文件",value:"download"},{text:"复制文件（夹）",value:"copy"},{text:"移动文件（夹）",value:"move"},{text:"重命名文件（夹）",value:"rename"},{text:"删除文件（夹）",value:"delete"},{text:"创件文件夹",value:"create_folder"}],user:[{text:"全部",value:0},{text:"创建用户",value:"add_user"},{text:"更新用户",value:"update_user"},{text:"删除用户",value:"del_user"}],team:[{text:"全部",value:0},{text:"创建团队",value:"add_group"},{text:"删除团队",value:"delete_group"}],grant:[{text:"全部",value:0},{text:"创建权限",value:"empower"},{text:"删除权限",value:"revoke"}]},g={model:{corpId:function(){var e=n.parseURL(location.href).params.corpId;return global.user.corpId||e||global.corpList[0].corpId}(),corpData:function(){var e=global.user.corpId||n.parseURL(location.href).params.corpId;return t.find(window.global.corpList,function(t){return t.corpId==e})}()},dataAPI:t.extend({},n.APIObj,{fnName:{searchLog:"log:searchLog"}})},y={LogModel:d.extend({sync:function(e,t,n){var r={url:g.dataAPI.getUrlByFnName("searchLog"),data:n,success:function(e){t.clear({silent:!0}),t.set(e)},fail:function(e){s.tips("数据拉取失败！"+(e.code||"")),console&&console.log("error",e)}};i.request(r)}})},b={};return b.LogView=v.extend({el:".mainContent",template:n.getTemplate(u,"#log"),logModel:new y.LogModel,reqModel:new d({corpId:g.model.corpId,beginDate:e.datepicker.formatDate("yy-mm-dd",new Date),endDate:e.datepicker.formatDate("yy-mm-dd",new Date),pageIndex:1,pageSize:10,userName:"",operType:"",operAction:"",groupName:"",come_from:""}),pagerModel:new d({total:0,pageIndex:1,pageSize:10}),initialize:function(){this.listenTo(this.reqModel,"change",this.getData),this.listenTo(this.logModel,"change",this.renderDataGrid),this.render(),this.initSelect(),this.initDatepicker(),this.getData(),this.renderHead(),this.renderPager(),this.initStyle(),e(window).off("resize.log").on("resize.log",this.initStyle)},render:function(){var e=n.tpl2Html(this.template,{});this.$el.html(e).addClass("log")},events:{"change #opType":"setSelect","click .btn-ok":"okFn","keyup #opUser,#group":"keyupFn"},initSelect:function(){this.opTypeSelect=new Dropkick(e("#opType")[0]),this.actionSelect=new Dropkick(e("#action")[0]),this.typeSelect=new Dropkick(e("#type")[0])},setSelect:function(){var n=e("#opType"),r=e("#action"),i=n.val(),s=m[i]||[{text:"全部",value:0}];s=t.map(s,function(e){return['<option value="',e.value,'">',e.text,"</option>"].join("")}),r.html(s.join("")),this.actionSelect.refresh()},initDatepicker:function(){e.datepicker.regional.zh_CN={closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy/mm/dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.datepicker.setDefaults(e.datepicker.regional.zh_CN);var t=e(".sTime"),n=e(".eTime");t.datepicker({dateFormat:"yy-mm-dd",constrainInput:!0,defaultDate:new Date,maxDate:new Date,onClose:function(e){n.datepicker("option","minDate",e)}}),t.datepicker("setDate",new Date),n.datepicker({dateFormat:"yy-mm-dd",constrainInput:!0,defaultDate:new Date,maxDate:new Date,onClose:function(e){t.datepicker("option","maxDate",e)}}),n.datepicker("setDate",new Date)},keyupFn:function(e){e.keyCode==13&&this.okFn()},okFn:function(){var t=e("#opUser"),n=e("#opType"),r=e("#action"),i=e("#group"),s=e("#type"),o=e(".sTime").datepicker("getDate",{dateFormat:"yy-mm-dd"}),u=e(".eTime").datepicker("getDate",{dateFormat:"yy-mm-dd"}),a=t.val(),f=n.val()?n.val():"",l=r.val()?r.val():"",c=i.val(),h=s.val()?s.val():"";o=e.datepicker.formatDate("yy-mm-dd",o),u=e.datepicker.formatDate("yy-mm-dd",u),this.reqModel.set({beginDate:o,endDate:u,userName:a,operType:f==0?"":f,operAction:l==0?"":l,groupName:c,come_from:h==0?"":h,pageIndex:1},{silent:!0}),this.reqModel.trigger("change")},getData:function(){this.logModel.fetch(this.reqModel.attributes)},renderDataGrid:function(){this.renderList()},renderHead:function(){var t=n.getTemplate(u,"#log-title");e(".tableList thead").html(n.tpl2Html(t))},renderList:function(){var r=this.logModel.toJSON().logList,i=n.getTemplate(u,"#log-row");r=t.map(r,function(e){return n.tpl2Html(i,e)});var s=r.join("");if(!r||r&&r.length==0)s='<tr class="no-data"><td align="center" colspan="5"><div class="tipsNoDate"><h5><i class="i-noDate"></i></h5><h4>暂无数据</h4></div></td></tr>';e(".tableList tbody").html(s)},renderPager:function(){this.pagerView&&this.pagerView.destroy(),this.pagerView=new h({el:".pageBox",model:this.reqModel,dataModel:this.logModel})},initStyle:function(){var t=e(".log-head").height(),r=global.height-t-50-25,i=".tableBox{height:"+r+"px}";n.addStyle("log",i)}}),{init:function(){new b.LogView}}});