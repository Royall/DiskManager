define("controls/DataAPI",[],function(){return{url:"admin.do",fnName:{addCorp:"corp:addCorp",updateCorp:"corp:updateCorp",getCorpDetail:"corp:getCorpDetail",listCorp:"corp:listCorp",updateCorpStatus:"corp:updateCorpStatus",updateAccountRule:"account:updateAccountRule",getAccountRule:"account:getAccountRule",getCorpService:"corp:getCorpService",updateCorpService:"corp:updateCorpService",searchUser:"user:searchUser",addUser:"user:addUser",updateUser:"user:updateUser",delUser:"user:delUser",batchDelUser:"user:batchDelUser",getUser:"user:getUser",getDeptUsers:"user:getDeptUsers",removeUserDept:"user:removeUserDept",addDeptUser:"user:addDeptUser",manageDeptMember:"user:manageDeptMember",addDept:"dept:addDept",updateDept:"dept:updateDept",getDeptDetail:"dept:getDeptDetail",delDept:"dept:delDept",uploadTemplate:"upload:uploadTemplate",getBatchImpDetail:"user:getBatchImpDetail",getDeptUnUsed:"dept:getDeptUnUsed",getCorpMsgSet:"corp:getCorpMsgSet",updateCorpMsgSet:"corp:updateCorpMsgSet",searchLog:"log:searchLog",getFileCount:"count:getFileCount",getFileOperate:"count:getFileOperate",getUseStorage:"count:getUseStorage",getUseStorageDetail:"count:getUseStorageDetail",getPersonStorage:"user:getPersonStorage",getTeamStorage:"count:getTeamStorage",getGroupStorage:"count:getGroupStorage",uploadLogo:"upload:uploadLogo",getCorpLogo:"corp:getCorpLogo"}}}),global.language=global.language||"zh_CN",define("controls/Common",["jquery","underscore","controls/DataAPI","i18n/"+global.language],function(e,t,n,r){return{getUrlByName:function(e){if(e&&n.fnName[e])return[n.url,"?func=",n.fnName[e]].join("");console.log(r.common.invalidFn)},formatFloat:function(e,t){var n=e.toFixed(t);return parseInt(n,10)==n?parseInt(n,10):n},formatStorageUnit:function(e,t,n){var r=1024,i=1048576,s=1073741824,o=1099511627776,u,a,f=Math.abs(e);if(n){switch(n){case"B":u=this.formatFloat(f,1);break;case"K":case"KB":u=this.formatFloat(f/r,1);break;case"M":case"MB":u=this.formatFloat(f/i,1);break;case"G":case"GB":u=this.formatFloat(f/s,1);break;case"T":case"TB":u=this.formatFloat(f/o,1);break;default:}a=n}else f>=o?(u=this.formatFloat(f/o,1),a="TB"):f>=s?(u=this.formatFloat(f/s,1),a="GB"):f>=i?(u=this.formatFloat(f/i,1),a="MB"):f>=r?(u=this.formatFloat(f/r,1),a="KB"):(u=this.formatFloat(f,1),a="B");return e!==f&&(u=-u),t?{num:u,unit:a}:u==0?0:u+a},stringFormat:function(){if(arguments.length==0)return null;var e=arguments[0];for(var t=1;t<arguments.length;t++){var n=new RegExp("\\{"+(t-1)+"\\}","gm");e=e.replace(n,arguments[t])}return e},convertToB:function(e,t){var n;switch(t){case"K":case"KB":n=1024;break;case"M":case"MB":n=1048576;break;case"G":case"GB":n=1073741824;break;case"T":case"TB":n=1099511627776;break;default:n=1}return e*n},formatOutDate:function(e){var t,n;return e>=12?(t=parseInt(e/12,10),n=e%12,[t,r.setting.year,n?n+r.setting.month:""].join("")):e+r.setting.month},getOutDate:function(e){return e==-1?r.setting.forever:this.formatOutDate(e)},getStatus:function(e){var t="";switch(e){case 0:t=r.setting.normal;break;case 1:t=r.setting.locked;break;case 2:t=r.setting.canceled;break;default:t=r.setting.normal}return t},getTemplate:function(t,n){return e("<div/>").html(t).find(n).html()},tpl2Html:function(e,n){var i=t.template(e);return i(t.extend({},{Lang:r},n||{}))},parseURL:function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){var e={},n=t.search.replace(/^\?/,"").split("&"),r=n.length,i=0,s;for(;i<r;i++){if(!n[i])continue;s=n[i].split("="),e[s[0]]=s[1]}return e}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},getRootUrl:function(){var e=this.parseURL(window.location.href);return[e.protocol,"://",e.host+"/"].join("")},getFileExt:function(e){if(e!=""){var t="."+e.replace(/.+\./,"");return t}},getLv:function(e){var t=1,n=r.common.weak,i=/[a-zA-z]/,s=/[0-9]/,o=/(?=[\x21-\x7e]+)[^A-Za-z0-9]/;if(i.test(e)&&s.test(e)&&o.test(e))t=3,n=r.common.strong;else if(i.test(e)&&s.test(e)||i.test(e)&&o.test(e)||s.test(e)&&o.test(e))t=2,n=r.common.normal;return{pswdLv:t,pswdLvText:n}},checkPswdLv:function(t,n){var r=this;e(t).off("keyup.lv").on("keyup.lv",function(){var t=e(this),i=t.val(),s=e(n);if(i==""){s.hide();return}s.show();var o=r.getLv(i);s.find("span").attr("class","passwrodLevel Plevel_"+o.pswdLv),s.find("em").text(o.pswdLvText)})},addStyle:function(t,n){var r="temp-style-"+t,i=e("#"+r);i.length&&i.remove();var s=['<style id="',r,'" type="text/css" rel="stylesheet">',n,"</style>"].join("");e(s).appendTo("head")},formatMobile:function(e,t){if(!e)return"";e+="";var n="+86";if(t){if(e.indexOf("86")<=-1||e.indexOf("86")>1)e=n+e}else{var r=e.indexOf("+86");r==0&&(e=e.substr(3))}return e},mergeErrMsg:function(e,t){var n,r=t.summary||t.code||"",i=/[，。,\.!！]/;return i.test(e)?n=e+" "+r:n=e+(r?"："+r:"")+" ！",n},getCorpId:function(){var e=~~this.parseURL(location.href).params.corpId;return global.user.corpId||e||global.corpList[0].corpId},getCorpData:function(){var e=this.getCorpId();return t.find(window.global.corpList,function(t){return t.corpId==e})}}}),define("text",["module"],function(e){"use strict";var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.14",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.lastIndexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i[0]==="﻿"&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!modules/../../template/head.html",[],function(){return'<script type="text/x-handlebars-template" id="head-tpl">\r\n    <div class="userOpera">\r\n        <% if(global.user.role!=\'root\'){ %><a href="/drive"><%=Lang.head.backToUser%></a>|<%}%><a href="javascript:;" id="userInfo"><%=obj.name||obj.userId %></a>|<a href="<%=logoutUrl%>"><i class="i-quit mr_5"></i><%=Lang.head.exit%></a>\r\n    </div>\r\n    <div class="logo">\r\n        <div class="i-logo">\r\n            <div class="i-logoImg">\r\n                <img src="<%-logoUrl%>" alt=""> <span class="logoTxt"><b><%=Lang.head.companyDisk%></b>|<em><%=Lang.head.managerCenter%></em></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="company-select" class="fake_slt areaChange" <%= obj.corpList.length<=1 ? \' style="display:none"\' : \'\' %> >\r\n    <div>\r\n        <span class="fake_slt_txt" style="height: 26px; width: 160px;" title="<%=obj.name%>"><%=obj.corpName%></span><a href="javascript:;" class="fake_slt_a"><i class="i-bdown"></i></a>\r\n    </div>\r\n    <ul style="max-height:120px;width:99%" class="fake_slt_menu popList" id="company-ul">\r\n\r\n        <% for (var i = 0; i < obj.corpList.length; i++) { %>\r\n        <li>\r\n            <a title="<%=obj.corpList[i].name%>" href="javascript:;" data-corpid="<%=obj.corpList[i].corpId%>"><%=obj.corpList[i].name%></a>\r\n        </li>\r\n        <% } %>\r\n\r\n    </ul>\r\n    </div>\r\n</script>\r\n\r\n\r\n<script type="text/x-handlebars-template" id="userInfo-tpl">\r\n    <div class="detailCon detailCon2">\r\n\r\n        <h3 class="detTit">用户信息</h3>\r\n        <ul class="userInfo">\r\n            <li>\r\n                <div class="subTitle"><%=Lang.userManager.userName%>：</div>\r\n                <div class="subCon"><%-userData.userId%></div>\r\n            </li>\r\n            <%if(userData.name){%>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.userManager.name%>：</div>\r\n                <div class="subCon"><%-userData.name%></div>\r\n            </li>\r\n            <%}%>\r\n            <%if(userData.email){%>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.userManager.email%>：</div>\r\n                <div class="subCon"><%-userData.email%></div>\r\n            </li>\r\n            <%}%>\r\n            <%if(userData.mobile){%>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.userManager.mobile%>：</div>\r\n                <div class="subCon"><%-userData.mobile%></div>\r\n            </li>\r\n            <%}%>\r\n        </ul>\r\n        <h3 class="detTit">企业信息</h3>\r\n        <ul>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.companyName%>：</div>\r\n                <div class="subCon"><%=corpData.name%></div>\r\n            </li>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.domain%>：</div>\r\n                <div class="subCon"><%=corpData.domain%></div>\r\n            </li>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.timeout%>：</div>\r\n                <div class="subCon"><%=corpData.outDate%></div>\r\n            </li>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.space%>：</div>\r\n                <div class="subCon"><%=corpData.storage%></div>\r\n            </li>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.userLimit%>：</div>\r\n                <div class="subCon"><%=corpData.userLimit%></div>\r\n            </li>\r\n            <li>\r\n                <div class="subTitle"><%=Lang.setting.status%>：</div>\r\n                <div class="subCon"><%=corpData.status%></div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</script>'}),define("text!modules/../../template/sidemenu.html",[],function(){return'<div class="sideMenu">\r\n    <ul>\r\n        <li class="<%=(moduleName==\'setting\'?\'act\':\'\')%>">\r\n            <a id="setting-link" href="./setting.do"><i class="i-sbico1"></i><span><%=Lang.sideBar.diskSetting%></span></a>\r\n        </li>\r\n        <li class="<%=(moduleName==\'usermanager\'?\'act\':\'\')%>">\r\n            <a id="user-manager-link" href="./usermanager.do"><i class="i-sbico2"></i><span><%=Lang.sideBar.userManager%></span></a>\r\n        </li>\r\n        <li class="<%=(moduleName==\'log\'?\'act\':\'\')%>">\r\n            <a id="log-link" href="./log.do"><i class="i-sbico3"></i><span><%=Lang.sideBar.logManager%></span></a>\r\n        </li>\r\n        <li class="<%=(moduleName==\'statistic\'?\'act\':\'\')%>">\r\n            <a id="statistic-link" href="./statistic.do"><i class="i-sbico4"></i><span><%=Lang.sideBar.statisticManager%></span></a>\r\n        </li>\r\n    </ul>\r\n</div>'}),function(e,t){e.sobox={maskIndex:0,showMask:function(n){var r=this;if(n){var i=e(".so-openmask");i.length?r.maskIndex++:(i=e('<div class="so-openmask"></div>'),e("body").append(i),r.maskIndex=1);var s=typeof t.body.style.maxHeight=="undefined"?t:window,o=e(s).height()-18;i.height(n?o+20:0),e(window).resize(function(){var t=e(s).height()-18;i.height(n?t+20:0)}),i.css("z-index",1e3+r.maskIndex*10)}else i=null;return i},show:function(t,n,r){var i=this,s=e(t.obj),o=i.showMask(n);return i.setPos(t),t.onlyOne&&e("body").data("soonlyone",!0),s.css("z-index",1002+i.maskIndex*10).fadeIn(),s.find(".s-close").bind("click",function(){i.hide(s)}),r&&r(),o},hide:function(t,n,r){var i=this,s=e(".so-openmask");e(t).fadeOut("fast",function(){r&&r()}),n&&(i.maskIndex--,s.css("z-index",1e3+i.maskIndex*10),i.maskIndex==0&&s.remove()),e(t).find(".s-close").unbind("click")},drag:function(n,r){function o(e){e==null&&(e=window.event),i.css({left:e.clientX-posX+"px",top:e.clientY-posY+"px"})}var i=e(n),s=e(r);s.mousedown(function(n){n||(n=window.event),posX=n.clientX-parseInt(i.css("left")),posY=n.clientY-parseInt(i.css("top")),e(t).bind("mousemove.drag",function(e){o(e)})}),e(t).mouseup(function(n){n.target==s.get(0)&&e(t).unbind("mousemove.drag")})},setPos:function(n){var r=this,n=e.extend({mode:"center",obj:null,pos:[0,0],offset:[0,0]},n),i=e(n.obj),s=Math.floor(i.height()/2),o=Math.floor(i.width()/2),u=e(window).scrollTop(),a=e(window).height(),f=n.pos[0],l=n.pos[1],c=n.offset[0],h=n.offset[1];i.css({position:"fixed"});if(typeof t.body.style.maxHeight=="undefined"){var p=i.find("select");e("select").not(p).hide()}switch(n.mode){case"win":i.css({left:f+c,top:l+h}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+l+h});break;case"doc":i.css({position:"absolute",left:f+c,top:l+h});break;case"tc":i.css({left:"50%",top:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h});break;case"bc":i.css({left:"50%",bottom:h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+h+a});break;default:i.css({top:"50%",left:"50%",marginTop:-s-10+h,marginLeft:-o+c}),typeof t.body.style.maxHeight=="undefined"&&i.css({position:"absolute",top:u+a/2})}},pop:function(t){function f(a){a&&a.disableEvents&&e("body").addClass("disableEvents"),t=e.extend(t,a||{}),t.showTitle&&i.append(s),t.outCloseBtn&&o.addClass("s-sopop-out-close"),i.append(o).append(u),t.height&&t.type!="iframe"&&i.css("height",t.height+"px"),i.css({visibility:t.visibility?"visible":"hidden"}),t.type=="content"&&u.html(t.content);if(t.type=="target"){var f=e(t.target).show();u.append(f)}if(t.type=="iframe"){var c=e('<iframe id="'+t.iframeID+'" name="'+t.iframeID+'" src="'+t.iframe+'" width="100%" height="'+t.height+'" frameborder="0" scrolling="auto"></iframe>');u.html(c)}t.type=="ajax"&&u.load(t.ajax.url,t.ajax.data,function(){n.setPos({mode:t.posType,obj:i,pos:t.pos,offset:t.offset}),t.ajax.callback&&t.ajax.callback()});if(t.btn.length>0){var h=e('<p class="p-so-popBtn"></p>');e.each(t.btn,function(){var t=e.extend({cls:null,text:"确定",link:"#",removePop:!0,callback:function(e){}},this),n=e('<a class="a-sopop-btn" href="'+t.link+'"><span class="s-sopop-btn">'+t.text+"</span></a>");t.cls!==null&&n.addClass(t.cls),n.bind("click",function(){return t.callback&&t.callback(l)&&l(),t.removePop&&l(),t.link==="#"?!1:!0}),h.append(n)}),i.append(h)}e("body").append(i),t.showTitle&&t.drag&&(s.addClass("h2-sopop-move"),n.drag(i,s)),t.beforePop(i,s,o,u),r=n.show({mode:t.posType,obj:i,pos:t.pos,offset:t.offset,onlyOne:t.onlyOne},t.showMask,t.onPop(i)),o.bind("click",function(){l()}),r&&t.maskClick&&r.bind("click",function(){l()})}function l(r){t=e.extend(t,r||{}),n.hide(i,t.showMask),e("body").removeData("soonlyone"),t.target!=null&&e(t.target).appendTo("body").hide(),i.remove(),t.closePop(),e("body").removeClass("disableEvents")}var n=this,t=e.extend({type:"content",target:null,content:null,iframe:null,iframeID:"sopop-iframe",ajax:{url:null,data:null,callback:function(){}},posType:"center",pos:[0,0],offset:[0,0],cls:null,width:400,height:null,defaultShow:!0,visibility:!0,title:"提示",showTitle:!0,outCloseBtn:!1,showMask:!0,onlyOne:!1,drag:!0,maskClick:!1,btn:[],disableEvents:!1,beforePop:function(){},onPop:function(){},closePop:function(){}},t||{}),r,i=e('<div class="so-popbox '+(t.cls?t.cls:"")+'" style="width:'+t.width+'px;display:none;"></div>'),s=e('<h2 class="h2-sopop"><span class="s-sopop-title">'+t.title+"</span></h2>"),o=e('<span class="s-sopop-close">[关闭]</span>'),u=e('<div class="so-popbox-cont"></div>'),a=e("body").data("soonlyone");return t.defaultShow&&!a&&f(t),{wrap:i,mask:r,opt:t,removePop:l,showPop:f}},alert:function(e,t,n){var r=this;r.pop({cls:"so-popAlert",title:e,width:360,content:t,btn:[{text:"确定"}],closePop:n})},confirm:function(e,t,n,r){var i=this;i.pop({cls:"so-popConfirm",title:e,width:360,content:t,btn:[{text:"确定",callback:function(){n&&n()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){r&&r()}}]})},tip:function(t){var n=this,r=null,t=e.extend({cls:"so-popTip",showTitle:!1,posType:"tc",showMask:!1,width:250,stayTime:5e3,offset:[0,5],closePop:function(){r&&clearTimeout(r)}},t||{}),i=n.pop(t);return t.stayTime>0&&(r=setTimeout(function(){i.removePop()},t.stayTime)),i},loading:function(t){var n=this,t=e.extend({type:"content",cls:"so-loading",showTitle:!1,maskClick:!1,width:100,height:36,content:"",stayTime:0,showMask:!1,disableEvents:!0},t||{}),r=n.pop(t);return t.stayTime>0&&setTimeout(function(){r.removePop()},t.stayTime),{open:r.showPop,close:r.removePop}}},e.fn.extend({soIframePop:function(t){var n=e.extend({type:"iframe",targetTag:"href",splitString:"#soIframe?",width:800,height:480,showTitle:!1},t||{}),r=[];return this.each(function(){var t=e(this),i=t.attr(n.targetTag).split(n.splitString),s=i[0];par=i[1]?i[1].split("&"):"";var u={};e.each(par,function(){var e=this.split("=");u[e[0]]=e[1]}),n=e.extend(n,u||{}),n.showTitle=n.showTitle=="true"?1:+n.showTitle,n.iframe=s,n.defaultShow=!1;var a=e.sobox.pop(n);r.push(a),t.click(function(){return a.showPop(),e(this).data("iframePop",a),!1})}),r},soSidePop:function(t){var n=e(this),r=t.event||"click",i=null;return n.bind(r,function(n){var r=e(this).offset(),s=t.por=="mouse"?[n.pageX,n.pageY]:[r.left,r.top],o=e.extend({showMask:!1,posType:"doc",por:"mouse",pos:s,offset:[10,10],onlyOne:!0,returnFalse:!0},t||{});i=e.sobox.pop(o);if(o.returnFalse)return!1}),t.leaveHide==1&&n.bind("mouseout",function(e){i&&i.removePop()}),n},soOverTip:function(t){var n=e(this),r=e.extend({cls:"so-overTip",showMask:!1,posType:"doc",offset:[10,10],showTitle:!1,onlyOne:!0},t||{}),i=null;return n.mouseenter(function(t){r.pos=[t.pageX,t.pageY],i=e.sobox.pop(r)}).mouseleave(function(){i.removePop()}),n},clickPop:function(t){var t=e.extend({optAll:null},t||{}),n=e(this);n.click(function(){var n=e(this).attr("rel"),r=this,s=e(this).attr("popType")||"target";if(n){var u=t.optAll,a=n.split("."),f=a.length;for(i=0;i<f;i++)u=u[a[i]];var l=n.replace(".","_");optT=e.extend({title:e(this).text(),type:s,target:e("#"+l),iframe:e(this).attr("href")},u),optT.beforePop=function(e,t,n,i){u.beforePop&&u.beforePop.call(r,e,t,n,i)},t.optAll.$pop=e.sobox.pop(optT)}})}})}(jQuery,document),define("sobox",["jquery"],function(){}),define("controls/Dialog",["jquery","underscore","sobox"],function(e,t,n){var r=function(t){e("body").hasClass("disableEvents")&&(t.preventDefault(),t.stopPropagation())},i=document.getElementsByTagName("body")[0];return window.addEventListener&&(i.removeEventListener("click",r),i.addEventListener("click",r,!0)),{pop:function(n){return n=t.extend({},{width:"auto",btn:[{text:n.okText||"确定",removePop:n.okRemovePop==undefined?!0:n.okRemovePop,callback:n.ok},{text:n.cancelText||"取消",cls:"a-sopop-cancel",removePop:!0,callback:n.cancel}]},n),e.sobox.pop(n)},alert:function(){var t,n,r=function(){};if(arguments.length)switch(arguments.length){case 1:t="提示",n=arguments[0];break;case 2:t=arguments[0],n=arguments[1];break;case 3:t=arguments[0],n=arguments[1],r=arguments[2];break;default:}return e.sobox.alert(t,n,r)},confirm:function(t,n,r,i){var s=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips_qa"></i></td>','<td><em class="tipsTxt">',n,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.pop({title:t,content:s,btn:[{text:"确定",callback:function(){r&&r()}},{text:"取消",cls:"a-sopop-cancel",callback:function(){i&&i()}}]})},tips:function(t,n){return e.sobox.tip({cls:"so-popTip",posType:"ct",content:t,width:"auto",height:38,offset:[0,-75],stayTime:n*1e3||4e3})},warn:function(t,n,r){var i=['<table width="100%" class="mt_20 mb_20 tipsTable">',"<tbody>","<tr>",'<td align="right" width="60"><i class="i-tips"></i></td>','<td><em class="tipsTxt">',t,"</em></td>","</tr>","</tbody>","</table>"].join("");return e.sobox.alert("提示",i,r)},loading:function(t){return e.sobox.loading({cls:"so-loading",stayTime:t*1e3||0,width:100,height:100})}}}),define("modules/frame",["jquery","underscore","controls/Common","text!../../template/head.html","text!../../template/sidemenu.html","controls/Dialog","i18n/"+global.language],function(e,t,n,r,i,s,o){if(!window.global)return{init:function(){}};if(!window.global.corpList||window.global.corpList&&!window.global.corpList.length)window.global.corpList=[{corpId:0,domain:"",name:"",outDate:0,pageIndex:0,pageSize:0,status:0,storage:0,userLimit:0}];return{init:function(){this.renderSidebar(),this.renderHead(),this.initEvents(),this.initStyle()},ui:{companyUl:"#company-ul",companySelect:"#company-select",userInfo:"#userInfo"},initEvents:function(){var t=this;e(t.ui.companyUl).find("li a").on("click",function(){var r=e(this).data("corpid");if(r==t.model.corpId)return;var i=n.parseURL(location.href);return location.href=i.file+"?corpId="+r,!1}),e(t.ui.companySelect).on("click",function(){e(t.ui.companyUl).toggle()}),e(t.ui.userInfo).on("click",function(){t.showInfo()}),e(window).off("resize.frame").on("resize.frame",this.initStyle)},model:{corpId:function(){if(!window.global)return 0;var e=n.parseURL(location.href).params.corpId;return window.global.user.corpId||e}(),corpList:window.global.corpList},renderHead:function(){var i=this,u=n.getCorpData();try{var a=t.extend({logoUrl:[n.getUrlByName("getCorpLogo"),"&corpId=",n.getCorpId()].join("")},window.global.user,{corpName:u.name,corpList:i.model.corpList,logoutUrl:window.global.logoutUrl||"javascript:;"}),f=n.getTemplate(r,"#head-tpl"),l=n.tpl2Html(f,a);e(".topHead").html(l),e(i.ui.companySelect).find(".fake_slt_txt").text(u.name)}catch(c){s.alert(o.common.sysTips,o.common.getComInfoFail,function(){location.href=global.logoutUrl})}},showInfo:function(){var e=t.extend({},n.getCorpData());e.outDate=n.getOutDate(e.outDate),e.storage=n.formatStorageUnit(e.storage),e.userLimit=e.userLimit+o.setting.userUnit,e.status=n.getStatus(e.status);var i=t.extend({name:"",email:"",mobile:""},global.user),u={userData:i,corpData:e},a=n.getTemplate(r,"#userInfo-tpl"),f=n.tpl2Html(a,u);s.pop({title:o.head.uncInfo,content:f,width:400})},renderSidebar:function(){var t=n.tpl2Html(i,moduleName);e(".sidebar").html(t);var r=this.model.corpId||this.model.corpList[0].corpId;this.setUrl(r)},setUrl:function(t){e("#setting-link").attr("href",window.modules.setting+".do?corpId="+t),e("#user-manager-link").attr("href",window.modules.userManager+".do?corpId="+t),e("#log-link").attr("href",window.modules.log+".do?corpId="+t),e("#statistic-link").attr("href",window.modules.statistic+".do?corpId="+t)},initStyle:function(){var t=e(".topHead").height(),r=e(window).height(),i=r-t,s=360;i<s&&(i=s),global.height=i;var o=i-120-55,u=parseInt(o/10,10),a=[".wrapper,.sidebar,.subSiderBar,.rightContainer{height:",i,"px}"];n.addStyle("frame",a.join(""))}}});