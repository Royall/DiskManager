define(["jquery","underscore","controls/Dialog","json2","i18n/"+global.language],function(e,t,n,r,i){var s={requestId:0,loadingObj:{},defaultOpts:{type:"POST",data:{},dataType:"json",success:function(){},error:function(){s.loadingObj.close&&s.loadingObj.close(),n.tips("Error Request !")},contentType:"text/plain; charset=UTF-8"},request:function(r,s,o,u){this.requestId++;var a=this;if(!r.url)return;this.url=r.url,o||(a.loadingObj.close&&a.loadingObj.close(),a.loadingObj=n.loading()),r.data&&r.data.parse&&delete r.data.parse,r.data&&r.data.success&&delete r.data.success,r.data&&r.data.error&&delete r.data.error,r.fail=r.fail||function(e){n.tips("Error:"+e.code)},e.ajax(t.extend({},this.defaultOpts,r,{data:JSON.stringify(r.data),success:function(e){o||a.loadingObj.close();if(!e)return;s?r.success(e):e&&e.code&&e.code=="S_OK"&&e.hasOwnProperty("var")?r.success(e["var"]):r.fail(e)},error:function(e){o||a.loadingObj.close();if(!u)if(e.status==200||e.status==0){n.alert(i.common.sysTips,i.common.loginTimeout,function(){location.href=global.logoutUrl});return}r.fail(e)}}))}};return s});